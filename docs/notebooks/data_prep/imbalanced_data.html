<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>imbalanced_data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-79108a0fc1995748cbd19a5b0e3e3e7c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="../../site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="../../site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="../../site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="../../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="../../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="../../site_libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="../../site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="../../site_libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


<link rel="stylesheet" href="../../styles/ec_html_template.css">
</head>

<body class="fullcontent nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text"><img src="https://raw.githubusercontent.com/EcoCommons-Australia-2024-2026/ec-notebook_site_materials/main/images/EcoCommons%20Logo%20White.png" alt="EcoCommons Logo" style="height:40px; vertical-align: middle; margin-right: 5px;"> <span style="font-size: 25px; position: relative; top: 7px;">EcoNotebooks</span></span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-modelling-steps" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Modelling Steps</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-modelling-steps">    
        <li>
    <a class="dropdown-item" href="../../notebooks/dataprep.html">
 <span class="dropdown-text">Data Preparation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notebooks/modelling.qmd">
 <span class="dropdown-text">Modelling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notebooks/predicting.qmd">
 <span class="dropdown-text">Prediction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notebooks/evaluation.qmd">
 <span class="dropdown-text">Evaluation</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-sdms" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">SDMs</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-sdms">    
        <li>
    <a class="dropdown-item" href="../../notebooks/EC_GLM/EC_GLM.html">
 <span class="dropdown-text">GLM</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-visualisation" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Visualisation</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-visualisation">    
        <li>
    <a class="dropdown-item" href="../../notebooks/visual1.qmd">
 <span class="dropdown-text">Visualisation 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../notebooks/visual2.qmd">
 <span class="dropdown-text">Visualisation 2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-spatial-prioritization" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Spatial Prioritization</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-spatial-prioritization">    
        <li>
    <a class="dropdown-item" href="../../notebooks/sp/ecocommons-marxan-integration-poc.html">
 <span class="dropdown-text">Connecting Marxan</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#imbalanced-species-data-background-points-and-weighting-methods" id="toc-imbalanced-species-data-background-points-and-weighting-methods" class="nav-link active" data-scroll-target="#imbalanced-species-data-background-points-and-weighting-methods">Imbalanced species data, background points, and weighting methods</a></li>
  <li><a href="#script-and-data-info" id="toc-script-and-data-info" class="nav-link" data-scroll-target="#script-and-data-info">Script and data info:</a></li>
  <li><a href="#abstract" id="toc-abstract" class="nav-link" data-scroll-target="#abstract">Abstract</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">Objectives</a></li>
  <li><a href="#workflow-overview" id="toc-workflow-overview" class="nav-link" data-scroll-target="#workflow-overview"><strong>Workflow Overview</strong>:</a></li>
  <li><a href="#set-up-r-environment-and-packages" id="toc-set-up-r-environment-and-packages" class="nav-link" data-scroll-target="#set-up-r-environment-and-packages">Set-up: R Environment and Packages</a>
  <ul class="collapse">
  <li><a href="#s.1-set-the-working-directory-and-create-a-folder-for-data." id="toc-s.1-set-the-working-directory-and-create-a-folder-for-data." class="nav-link" data-scroll-target="#s.1-set-the-working-directory-and-create-a-folder-for-data.">S.1 Set the working directory and create a folder for data.</a></li>
  <li><a href="#s.2-install-and-load-essential-libraries." id="toc-s.2-install-and-load-essential-libraries." class="nav-link" data-scroll-target="#s.2-install-and-load-essential-libraries.">S.2 Install and load essential libraries.</a></li>
  <li><a href="#s.3-download-case-study-datasets" id="toc-s.3-download-case-study-datasets" class="nav-link" data-scroll-target="#s.3-download-case-study-datasets">S.3 Download case study datasets</a></li>
  </ul></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">1. Introduction</a>
  <ul class="collapse">
  <li><a href="#imbalanced-binary-species-dataset" id="toc-imbalanced-binary-species-dataset" class="nav-link" data-scroll-target="#imbalanced-binary-species-dataset">1.1 Imbalanced binary species dataset</a></li>
  <li><a href="#weighting-methods" id="toc-weighting-methods" class="nav-link" data-scroll-target="#weighting-methods">1.2 Weighting methods</a></li>
  <li><a href="#background-points-and-pseudo-absence-points" id="toc-background-points-and-pseudo-absence-points" class="nav-link" data-scroll-target="#background-points-and-pseudo-absence-points">1.3 Background points and Pseudo-absence points</a></li>
  <li><a href="#evaluation-metric" id="toc-evaluation-metric" class="nav-link" data-scroll-target="#evaluation-metric">1.4 Evaluation metric</a></li>
  </ul></li>
  <li><a href="#overview-and-conceptualisation" id="toc-overview-and-conceptualisation" class="nav-link" data-scroll-target="#overview-and-conceptualisation">2 Overview and Conceptualisation</a>
  <ul class="collapse">
  <li><a href="#model-objective" id="toc-model-objective" class="nav-link" data-scroll-target="#model-objective">2.1 Model objective</a></li>
  <li><a href="#taxon-location-data-scale-and-model-algorithm" id="toc-taxon-location-data-scale-and-model-algorithm" class="nav-link" data-scroll-target="#taxon-location-data-scale-and-model-algorithm">2.2 Taxon, location, data, scale, and model algorithm</a></li>
  <li><a href="#imbalanced-biodiversity-data" id="toc-imbalanced-biodiversity-data" class="nav-link" data-scroll-target="#imbalanced-biodiversity-data">2.3 Imbalanced biodiversity data</a></li>
  <li><a href="#environmental-variables" id="toc-environmental-variables" class="nav-link" data-scroll-target="#environmental-variables">2.4 Environmental variables</a></li>
  </ul></li>
  <li><a href="#when-we-have-true-absence-data" id="toc-when-we-have-true-absence-data" class="nav-link" data-scroll-target="#when-we-have-true-absence-data">3. When we have true-absence data</a>
  <ul class="collapse">
  <li><a href="#including-true-absence-in-the-training-dataset" id="toc-including-true-absence-in-the-training-dataset" class="nav-link" data-scroll-target="#including-true-absence-in-the-training-dataset">3.1 Including true absence in the training dataset</a></li>
  <li><a href="#un-weighted-models" id="toc-un-weighted-models" class="nav-link" data-scroll-target="#un-weighted-models">3.2 Un-weighted models</a>
  <ul class="collapse">
  <li><a href="#which-model-is-better" id="toc-which-model-is-better" class="nav-link" data-scroll-target="#which-model-is-better">3.2.1 Which model is better?</a></li>
  <li><a href="#is-more-always-better" id="toc-is-more-always-better" class="nav-link" data-scroll-target="#is-more-always-better">3.2.2 Is more always better?</a></li>
  <li><a href="#how-much-true-absence-data-is-enough" id="toc-how-much-true-absence-data-is-enough" class="nav-link" data-scroll-target="#how-much-true-absence-data-is-enough">3.2.3 How much true-absence data is enough?</a></li>
  </ul></li>
  <li><a href="#weighted-models" id="toc-weighted-models" class="nav-link" data-scroll-target="#weighted-models">3.3 Weighted models</a>
  <ul class="collapse">
  <li><a href="#general-trends-across-weighted-models" id="toc-general-trends-across-weighted-models" class="nav-link" data-scroll-target="#general-trends-across-weighted-models">3.3.1 General Trends Across Weighted Models</a></li>
  </ul></li>
  <li><a href="#comparing-un-weighted-and-weighted-methods." id="toc-comparing-un-weighted-and-weighted-methods." class="nav-link" data-scroll-target="#comparing-un-weighted-and-weighted-methods.">3.4 Comparing un-weighted and weighted methods.</a>
  <ul class="collapse">
  <li><a href="#results-of-comparison" id="toc-results-of-comparison" class="nav-link" data-scroll-target="#results-of-comparison">3.4.1 Results of comparison</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">3.4.2 Summary</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#background-point-and-pseudo-absence-points" id="toc-background-point-and-pseudo-absence-points" class="nav-link" data-scroll-target="#background-point-and-pseudo-absence-points">4. Background point and pseudo-absence points</a>
  <ul class="collapse">
  <li><a href="#random-background-points" id="toc-random-background-points" class="nav-link" data-scroll-target="#random-background-points">4.1 Random background points</a>
  <ul class="collapse">
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">4.1.1 Results</a></li>
  <li><a href="#summary-1" id="toc-summary-1" class="nav-link" data-scroll-target="#summary-1">4.1.2 Summary</a></li>
  </ul></li>
  <li><a href="#the-disk-approach" id="toc-the-disk-approach" class="nav-link" data-scroll-target="#the-disk-approach">4.2 The ‘disk’ approach</a>
  <ul class="collapse">
  <li><a href="#results-1" id="toc-results-1" class="nav-link" data-scroll-target="#results-1">4.2.1 Results</a></li>
  <li><a href="#summary-2" id="toc-summary-2" class="nav-link" data-scroll-target="#summary-2">4.2.3 Summary</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">5. Conclusion</a>
  <ul class="collapse">
  <li><a href="#comparison-across-all-models" id="toc-comparison-across-all-models" class="nav-link" data-scroll-target="#comparison-across-all-models">5.1 Comparison across all models</a></li>
  <li><a href="#summary-3" id="toc-summary-3" class="nav-link" data-scroll-target="#summary-3">5.2 Summary</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<p><img src="https://raw.githubusercontent.com/EcoCommons-Australia-2024-2026/ec-notebook_site/main/images/notebooks_banner_withframe.png" class="img-fluid"></p>
<section id="imbalanced-species-data-background-points-and-weighting-methods" class="level1">
<h1>Imbalanced species data, background points, and weighting methods</h1>
<p>Author details: Xiang Zhao</p>
<p>Editor details: Dr Sebastian Lopez Marcano</p>
<p>Contact details: support@ecocommons.org.au</p>
<p>Copyright statement: This script is the product of the EcoCommons platform. Please refer to the EcoCommons website for more details: <a href="https://www.ecocommons.org.au/" class="uri">https://www.ecocommons.org.au/</a></p>
<p>Date: February 2025</p>
</section>
<section id="script-and-data-info" class="level1">
<h1>Script and data info:</h1>
<p>This notebook, developed by the EcoCommons team, showcases how to deal with imbalanced species datasets (presence and absence data) with serveral methods.</p>
</section>
<section id="abstract" class="level1">
<h1>Abstract</h1>
<p>When building species distribution models, it is common to encounter imbalanced datasets. This may involve a large number of presence records and relatively few absence records, or, in the case of rare species, a substantial number of absence records but only a limited number of presence records.</p>
<p>Using imbalanced datasets making models and predictions can result in many unintended issues, such as bias towards the majority class, misleading performance metrics, poor sensitivity for the minority class, etc. Because the model has more information from the prevalent class than the rare events <span class="citation" data-cites="menardi2014training">(<a href="#ref-menardi2014training" role="doc-biblioref">Menardi &amp; Torelli, 2014</a>)</span>. Thus, we need to deal with imbalanced datasets.</p>
<p>This notebook explores strategies to address the challenges posed by imbalanced species data in ecological modeling, particularly in Species Distribution Models (SDMs). It focuses on the use of background points and weighting methods to improve model performance when presence and absence data are disproportionate. The study examines the effectiveness of different pseudo-absence generation techniques, including random and buffered-random background point sampling, and applies weighting schemes to mitigate class imbalance. Using the Gang-gang Cockatoo as a case study, the analysis demonstrates the impact of these methods on model evaluation metrics such as AUROC, AUPR, F1-score, and TSS. This guide aims to equip ecologists and data scientists with practical approaches for handling imbalanced datasets, ensuring more accurate and reliable SDMs within the EcoCommons platform.</p>
</section>
<section id="objectives" class="level1">
<h1>Objectives</h1>
<ol type="1">
<li>Understand what are imbalanced datasets and the influence of it on the performance of models.</li>
<li>Understand using weigthing methods to improve the issue of imbalanced datasets.</li>
<li>Know how to generate background points with two methods: completely random and buffered-random.</li>
<li>Learn how to compare the performance of models using difference methods of producing background points and pseudo absence data.</li>
</ol>
</section>
<section id="workflow-overview" class="level1">
<h1><strong>Workflow Overview</strong>:</h1>
<ul>
<li><p>Set the working directory and load the necessary R packages. Create directories to store raw data files.</p></li>
<li><p>Data Download: Download prepared imbalanced dataset from our Google Drive.</p></li>
<li><p>Data preparation and split.</p></li>
<li><p>Model evaluation and comparison.</p></li>
</ul>
<p>In the near future, this material may form part of comprehensive support materials available to EcoCommons users. If you have any corrections or suggestions to improve the effeciengy, please <a href="mailto:support@ecocommons.org.au">contact the EcoCommons</a> team.</p>
<p><img src="https://raw.githubusercontent.com/EcoCommons-Australia-2024-2026/ec-notebook_site/main/images/EC_section_break.png" class="img-fluid"></p>
</section>
<section id="set-up-r-environment-and-packages" class="level1">
<h1>Set-up: R Environment and Packages</h1>
<p>Some housekeeping before we start. This process might take some time as many packages needed to be installed.</p>
<section id="s.1-set-the-working-directory-and-create-a-folder-for-data." class="level2">
<h2 class="anchored" data-anchor-id="s.1-set-the-working-directory-and-create-a-folder-for-data.">S.1 Set the working directory and create a folder for data.</h2>
<p>Save the Quarto Markdown file (.QMD) to a folder of your choice, and then set the path to your folder as your working directory.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the workspace to the current working directory</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>workspace <span class="ot">&lt;-</span> <span class="fu">getwd</span>()  <span class="co"># Get the current working directory and store it in 'workspace'</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Increase the plot size by adjusting the options for plot dimensions in the notebook output</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.plot.width =</span> <span class="dv">16</span>, <span class="at">repr.plot.height =</span> <span class="dv">8</span>)  <span class="co"># Sets width to 16 and height to 8 for larger plots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ideally, you would use the <strong><code>renv</code></strong> package to create an isolated environment for installing all the required R packages used in this notebook. However, since installing <strong><code>renv</code></strong> and its dependencies can be time-consuming, we recommend trying this after the workshop.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # Ensure "renv" package is installed</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># if (!requireNamespace("renv", quietly = TRUE)) {</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   install.packages("renv")</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # Check if renv has been initialised in the project</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># if (!file.exists("renv/activate.R")) {</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   message("renv has not been initiated in this project. Initializing now...")</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   renv::init()  # Initialise renv if not already set up</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># } else {</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   source("renv/activate.R")  # Activate the renv environment</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   message("renv is activated.")</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># # Check for the existence of renv.lock and restore the environment</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># if (file.exists("renv.lock")) {</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   message("Restoring renv environment from renv.lock...")</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   renv::restore()</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># } else {</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   message("No renv.lock file found in the current directory. Skipping restore.")</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="s.2-install-and-load-essential-libraries." class="level2">
<h2 class="anchored" data-anchor-id="s.2-install-and-load-essential-libraries.">S.2 Install and load essential libraries.</h2>
<p>Install and load R packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set CRAN mirror</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repos =</span> <span class="fu">c</span>(<span class="at">CRAN =</span> <span class="st">"https://cran.rstudio.com/"</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># List of packages to check, install if needed, and load</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"dplyr"</span>, <span class="st">"reshape2"</span>, <span class="st">"terra"</span>, <span class="st">"sf"</span>, <span class="st">"googledrive"</span>, <span class="st">"ggplot2"</span>, <span class="st">"corrplot"</span>, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">"pROC"</span>, <span class="st">"dismo"</span>, <span class="st">"spatstat.geom"</span>, <span class="st">"patchwork"</span>, <span class="st">"biomod2"</span>, <span class="st">"PRROC"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">"leaflet"</span>, <span class="st">"car"</span>, <span class="st">"gridExtra"</span>, <span class="st">"htmltools"</span>, <span class="st">"RColorBrewer"</span>, <span class="st">"kableExtra"</span>, <span class="st">"tibble"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to display a cat message</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>cat_message <span class="ot">&lt;-</span> <span class="cf">function</span>(pkg, message_type) {</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (message_type <span class="sc">==</span> <span class="st">"installed"</span>) {</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste0</span>(pkg, <span class="st">" has been installed successfully!</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (message_type <span class="sc">==</span> <span class="st">"loading"</span>) {</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste0</span>(pkg, <span class="st">" is already installed and has been loaded!</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Install missing packages and load them</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (pkg <span class="cf">in</span> packages) {</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(pkg, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(pkg)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat_message</span>(pkg, <span class="st">"installed"</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat_message</span>(pkg, <span class="st">"loading"</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(pkg, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dplyr is already installed and has been loaded!</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>reshape2 is already installed and has been loaded!
terra is already installed and has been loaded!</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>sf is already installed and has been loaded!</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>googledrive is already installed and has been loaded!
ggplot2 is already installed and has been loaded!
corrplot is already installed and has been loaded!</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>pROC is already installed and has been loaded!</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>dismo is already installed and has been loaded!</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>spatstat.geom is already installed and has been loaded!</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>patchwork is already installed and has been loaded!</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>biomod2 is already installed and has been loaded!</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>PRROC is already installed and has been loaded!
leaflet is already installed and has been loaded!
car is already installed and has been loaded!</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>gridExtra is already installed and has been loaded!</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>htmltools is already installed and has been loaded!
RColorBrewer is already installed and has been loaded!
kableExtra is already installed and has been loaded!</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble is already installed and has been loaded!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If you are using renv, you can snapshot the renv after loading all the packages.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#renv::snapshot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="s.3-download-case-study-datasets" class="level2">
<h2 class="anchored" data-anchor-id="s.3-download-case-study-datasets">S.3 Download case study datasets</h2>
<p>We have prepared the following data and uploaded them to our Google Drive for your use:</p>
<ul>
<li><p><strong>Species occurrence data:</strong> Shapefile format (.shp)</p></li>
<li><p><strong>Environmental variables:</strong> Stacked Raster format (.tif)</p></li>
<li><p><strong>Study area boundary:</strong> Shapefile format (.shp)</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># De-authenticate Google Drive to access public files</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">drive_deauth</span>()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Google Drive file ID and the path for downloading</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>zip_file_id <span class="ot">&lt;-</span> <span class="st">"1GXOA330Ow2F7NqxdhuBfbz0a-CMT8DTb"</span> <span class="co"># Replace with the actual file ID of the zipped file</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>datafolder_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(workspace)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a local path for the zipped file</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>zip_file_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(datafolder_path, <span class="st">"imbalanced_data.zip"</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to download a file with progress messages</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>download_zip_file <span class="ot">&lt;-</span> <span class="cf">function</span>(file_id, file_path) {</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Downloading zipped file...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drive_download</span>(<span class="fu">as_id</span>(file_id), <span class="at">path =</span> file_path, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Downloaded zipped file to:"</span>, file_path, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create local directory if it doesn't exist</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(datafolder_path)) {</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(datafolder_path, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the zipped file</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Starting to download the zipped file...</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Starting to download the zipped file...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">download_zip_file</span>(zip_file_id, zip_file_path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Downloading zipped file...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Downloaded zipped file to: /Users/xiangzhaoqcif/Documents/Documents - QCIF’s MacBook Pro (2)/github/notebook-blog/notebooks/data_prep/imbalanced_data.zip </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Unzip the downloaded file</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Unzipping the file...</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unzipping the file...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span>(zip_file_path, <span class="at">exdir =</span> datafolder_path)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Unzipped files to folder:"</span>, datafolder_path, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unzipped files to folder: /Users/xiangzhaoqcif/Documents/Documents - QCIF’s MacBook Pro (2)/github/notebook-blog/notebooks/data_prep </code></pre>
</div>
</div>
</section>
</section>
<section id="introduction" class="level1">
<h1>1. Introduction</h1>
<section id="imbalanced-binary-species-dataset" class="level2">
<h2 class="anchored" data-anchor-id="imbalanced-binary-species-dataset">1.1 Imbalanced binary species dataset</h2>
<p>Imbalanced datasets are not unusual. Shown as the figure below, a dataset is imbalanced if the classifications are not equally represented <span class="citation" data-cites="chawla2002smote">(<a href="#ref-chawla2002smote" role="doc-biblioref">Chawla et al., 2002</a>)</span>.</p>
<p><img src="https://raw.githubusercontent.com/EcoCommons-Australia-2024-2026/ec-notebook_site/main/images/imbalanceddataillustration.png" class="img-fluid"></p>
<p>In the case of binary species records, presence and absence of a species, there is a common scenario of imbalanced datasets: <strong>too many presences</strong>. The phenomenon of <strong>too many presences</strong> in a species record dataset is quite dominant. In many open access biodiversity data portals, like the Global Biodiversity Information Facility (GBIF, <a href="https://www.gbif.org/" class="uri">https://www.gbif.org/</a>) and Atlas of Living Australia (ALA, <a href="https://www.ala.org.au/" class="uri">https://www.ala.org.au/</a>), most of species only have present records.</p>
<p>Undesired outcomes of using imbalanced dataset for modelling and prediction. For example, because presences dominate the training set, the model may be inclined to predict presence more often to minimize overall errors. You may see high <strong>sensitivity</strong> (true positive rate, correctly identifying most presences) but low <strong>specificity</strong> (true negative rate) <span class="citation" data-cites="johnson2012species">(<a href="#ref-johnson2012species" role="doc-biblioref">Johnson et al., 2012</a>)</span>. Thus, dealing with imbalanced data before fitting SDMs is a necessary step.</p>
</section>
<section id="weighting-methods" class="level2">
<h2 class="anchored" data-anchor-id="weighting-methods">1.2 Weighting methods</h2>
<p>Many studies show that weighting methods can improve SDM performance <span class="citation" data-cites="zhang2020does benkendorf2023correcting chen2004using">(<a href="#ref-benkendorf2023correcting" role="doc-biblioref">Benkendorf et al., 2023</a>; <a href="#ref-chen2004using" role="doc-biblioref">Chen et al., 2004</a>; <a href="#ref-zhang2020does" role="doc-biblioref">Zhang et al., 2020</a>)</span>. Applying class weights to SDM algorithm so the cost of misclassifying the minority class can be elevated relative to the cost of misclassifying the majority class <span class="citation" data-cites="benkendorf2023correcting">(<a href="#ref-benkendorf2023correcting" role="doc-biblioref">Benkendorf et al., 2023</a>)</span>.</p>
<p>For example, if a dataset contains 900 presences and 100 absences, the ratio of classes is 9:1. To compensate for this imbalance, class weights can be assigned inversely proportional to class frequencies. In this case, a weight of 1 would be assigned to the majority class (presences) and a weight of 9 to the minority class (absences). This means the model incurs a 9× cost for misclassifying an absence relative to a presence. Such reweighting has been shown to improve the tradeoff between model sensitivity and specificity. Specifically, although increases in sensitivity are often accompanied by decreases in specificity and overall accuracy, applying these class weights can help achieve a better balance.</p>
<p>In this notebook, we use a very simple weighting methods used by Elith et al. <span class="citation" data-cites="elith2006novel">(<a href="#ref-elith2006novel" role="doc-biblioref">Elith* et al., 2006</a>)</span> and Valavi et al. <span class="citation" data-cites="valavi2022predictive">(<a href="#ref-valavi2022predictive" role="doc-biblioref">Valavi et al., 2022</a>)</span>. The weights are generated by giving a weight of 1 to every presence location and give the weights to the background in a way that the sum of the weights for the presence and background samples are equal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1️⃣ Create a toy dataset</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Example data frame with presence (1) and background/absence (0)</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">occrrnS =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">7</span>), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>))  <span class="co"># 7 presence points, 3 background points</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 2️⃣ Calculate weights</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of presence and background points</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>prNum <span class="ot">&lt;-</span> <span class="fu">sum</span>(train_data<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>bgNum <span class="ot">&lt;-</span> <span class="fu">sum</span>(train_data<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply weights: presence = 1, background = prNum / bgNum</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>wt <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(train_data<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, prNum <span class="sc">/</span> bgNum)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Add weights to the data frame</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> train_data <span class="sc">%&gt;%</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight =</span> wt)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 3️⃣ Display the final dataset with weights</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(train_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   id occrrnS   weight
1   1       1 1.000000
2   2       1 1.000000
3   3       1 1.000000
4   4       1 1.000000
5   5       1 1.000000
6   6       1 1.000000
7   7       1 1.000000
8   8       0 2.333333
9   9       0 2.333333
10 10       0 2.333333</code></pre>
</div>
</div>
<p>The sum of the weights for 1 (Present) is 7 × 1 = 7, which is equal to the sum of the weights for 0 (Absent), 2.33 × 3 = 7. <strong>This weighting method will be used to address the imbalanced dataset issue in this notebook</strong>.</p>
</section>
<section id="background-points-and-pseudo-absence-points" class="level2">
<h2 class="anchored" data-anchor-id="background-points-and-pseudo-absence-points">1.3 Background points and Pseudo-absence points</h2>
<p>When working with presence-only records for your study species, a common approach is to sample a relatively large number of random samples from the study area. These random samples area referred to <strong>background</strong> or <strong>pseudo-absence points <span class="citation" data-cites="valavi2022predictive">(<a href="#ref-valavi2022predictive" role="doc-biblioref">Valavi et al., 2022</a>)</span>.</strong></p>
<p>There are two common approaches of generating background points. The first involves <strong>randomly selecting background points</strong> from the entire extent of the study area, allowing observations to be compared against the full range of environmental conditions within that area <span class="citation" data-cites="elith2006novel phillips2006maximum">(<a href="#ref-elith2006novel" role="doc-biblioref">Elith* et al., 2006</a>; <a href="#ref-phillips2006maximum" role="doc-biblioref">Phillips et al., 2006</a>)</span>. The second approach generates background points within a specified minimum-maximum radius around presence points-a method referred to as the <strong>“disk” approach</strong> in EcoCommons Platform.</p>
<p>For more information about background points, pseudo-absence data, please check out our support article <a href="https://support.ecocommons.org.au/support/solutions/articles/6000255789-absence-data"><strong>Absence Data</strong></a><strong>.</strong></p>
</section>
<section id="evaluation-metric" class="level2">
<h2 class="anchored" data-anchor-id="evaluation-metric">1.4 Evaluation metric</h2>
<p>Several studies suggest how to evaluate the model performance of imbalanced dataset <span class="citation" data-cites="johnson2012species zhang2020does gaul2022modelling barbet2012selecting">(<a href="#ref-barbet2012selecting" role="doc-biblioref">Barbet-Massin et al., 2012</a>; <a href="#ref-gaul2022modelling" role="doc-biblioref">Gaul et al., 2022</a>; <a href="#ref-johnson2012species" role="doc-biblioref">Johnson et al., 2012</a>; <a href="#ref-zhang2020does" role="doc-biblioref">Zhang et al., 2020</a>)</span>. We select these to use in this notebook:</p>
<table class="caption-top table">
<caption>We also provide some information on model evaluation on our platform’s <a href="https://support.ecocommons.org.au/support/solutions/articles/6000163162-model-evaluation">educational material page</a>.</caption>
<thead>
<tr class="header">
<th>Metric</th>
<th>What it Tells You</th>
<th>Optimized When</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>AUROC</strong> (Area Under ROC Curve)</td>
<td>Ability of the model to distinguish between classes</td>
<td>When overall discriminative power is important</td>
</tr>
<tr class="even">
<td><strong>CORR</strong> (Correlation between the observation in the occurrence dataset and the prediction)</td>
<td>Degree of correlation between predicted and observed values</td>
<td>When assessing the strength and direction of relationships</td>
</tr>
<tr class="odd">
<td><strong>Precision</strong></td>
<td>Proportion of positive predictions that are correct</td>
<td>False positives need to be minimized</td>
</tr>
<tr class="even">
<td><strong>Recall</strong></td>
<td>Ability to capture actual positives</td>
<td>Missing positives has severe consequences</td>
</tr>
<tr class="odd">
<td><strong>Specificity</strong></td>
<td>Ability to correctly identify negatives</td>
<td>False positives need to be minimized</td>
</tr>
<tr class="even">
<td><strong>F1-Score</strong></td>
<td>Balance between Precision and Recall</td>
<td>Both false positives and false negatives are costly</td>
</tr>
<tr class="odd">
<td><strong>AUPR</strong> (Area Under Precision-Recall Curve)</td>
<td>Performance on imbalanced datasets focusing on positive class</td>
<td>When positive class is rare and critical</td>
</tr>
<tr class="even">
<td><strong>TSS</strong> (True Skill Statistic)</td>
<td>Skill of the model beyond random chance</td>
<td>When evaluating presence/absence models in ecological studies</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="overview-and-conceptualisation" class="level1">
<h1>2 Overview and Conceptualisation</h1>
<section id="model-objective" class="level2">
<h2 class="anchored" data-anchor-id="model-objective">2.1 Model objective</h2>
<p>This notebook focuses not on creating a perfect Species Distribution Model (SDM) for the Gang-gang Cockatoo, but on comparing different methods for addressing class imbalance in binary species datasets and evaluating their effectiveness in improving SDM performance.</p>
</section>
<section id="taxon-location-data-scale-and-model-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="taxon-location-data-scale-and-model-algorithm">2.2 Taxon, location, data, scale, and model algorithm</h2>
<p><strong>Taxon:</strong> Gang-gang Cockatoo (<em>Callocephalon fimbriatum</em>)</p>
<p><img src="https://github.com/EcoCommons-Australia-2024-2026/ec-notebook_site_materials/raw/main/images/gang-gang_ala.jpeg" class="img-fluid" alt="Gang-gang"></p>
<p>Photographer: <a href="https://images.ala.org.au/image/details?imageId=2433eacc-ab65-483b-af69-1207eeb41463">Kym Nicolson, ALA</a></p>
<p><strong>The Gang-gang Cockatoo (<em>Callocephalon fimbriatum</em>)</strong> is endemic to southeastern Australia, with its distribution primarily spanning higher elevations and southern latitudes, including regions in New South Wales, Victoria, and the Australian Capital Territory. It inhabits temperate eucalypt forests and woodlands, favoring wet sclerophyll forests with dense acacia and banksia understories during the summer months, while moving to drier, open woodlands at lower altitudes in winter. The species is well-adapted to cooler climates and often forages in parks and suburban gardens.</p>
<p>However, Gang-gang Cockatoos face significant threats, including habitat loss due to land clearing, wildfire damage, and competition for nesting hollows with other species. Climate change, particularly increased fire frequency and altered rainfall patterns, poses additional risks to their survival. The species suffered a drastic population decline, exacerbated by the 2019/2020 bushfires, which burned approximately 28–36% of its habitat, leading to a projected long-term decline in population size.</p>
<p><strong>Location:</strong> Australian Capital Territory (ACT, study area)</p>
<p><strong>Spatial and temporal scales:</strong> small (spatial) and static (temporal)</p>
<p><strong>model algorithm:</strong> Generalised linear model (GLM)</p>
</section>
<section id="imbalanced-biodiversity-data" class="level2">
<h2 class="anchored" data-anchor-id="imbalanced-biodiversity-data">2.3 Imbalanced biodiversity data</h2>
<p>Understanding your species is essential. This includes knowing their common names (which may include multiple names) and scientific name to ensure you collect the most comprehensive records available in open-access biodiversity data portals, such as the Atlas of Living Australia (ALA) or the Global Biodiversity Information Facility (GBIF).</p>
<p>For this exercise, we have prepared a species occurrence data file in CSV format, which was downloaded from ALA. To make it accessible, we have stored this file in the EcoCommons Public Google Drive for you to download and use conveniently.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the shapefile for Gang-gang Cockatoo occurrence point dataset</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>gang_gang_act <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"imbalanced_data/gang_gang_ACT.shp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `gang_gang_ACT' from data source 
  `/Users/xiangzhaoqcif/Documents/Documents - QCIF’s MacBook Pro (2)/github/notebook-blog/notebooks/data_prep/imbalanced_data/gang_gang_ACT.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 918 features and 1 field
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 148.77 ymin: -35.9 xmax: 149.39 ymax: -35.13
Geodetic CRS:  GDA94</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the shapefile for ACT dataset</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>ACT <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"imbalanced_data/ACT_4283.shp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `ACT_4283' from data source 
  `/Users/xiangzhaoqcif/Documents/Documents - QCIF’s MacBook Pro (2)/github/notebook-blog/notebooks/data_prep/imbalanced_data/ACT_4283.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 1 feature and 0 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 148.7628 ymin: -35.92053 xmax: 149.3993 ymax: -35.12442
Geodetic CRS:  GDA94</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create leaflet map</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(providers<span class="sc">$</span>Esri.WorldImagery) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the ACT layer with a distinct color</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>(</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ACT,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"lightblue"</span>,         <span class="co"># Border color of ACT polygon</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight =</span> <span class="dv">1</span>,                  <span class="co"># Border width</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillColor =</span> <span class="st">"lightblue"</span>,      <span class="co"># Fill color of ACT</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillOpacity =</span> <span class="fl">0.3</span>,           <span class="co"># Transparency for fill</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="st">"ACT"</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add Gang-gang Cockatoo presence/absence points from the same shapefile</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> gang_gang_act,</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span><span class="fu">ifelse</span>(occrrnS <span class="sc">==</span> <span class="st">"PRESENT"</span>, <span class="st">"#11aa96"</span>, <span class="st">"#f6aa70"</span>),  <span class="co"># Dynamically set color based on occrrnS</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">radius =</span> <span class="dv">1</span>,</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight =</span> <span class="fl">0.5</span>,</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">opacity =</span> <span class="dv">1</span>,</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillOpacity =</span> <span class="dv">1</span>,</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="st">"Gang-gang Cockatoo Records"</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setView</span>(<span class="at">lng =</span> <span class="dv">149</span>, <span class="at">lat =</span> <span class="sc">-</span><span class="fl">35.5</span>, <span class="at">zoom =</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="co"># Set the view to desired location</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add layer controls for toggling</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLayersControl</span>(</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">overlayGroups =</span> <span class="fu">c</span>(<span class="st">"ACT"</span>, <span class="st">"Gang-gang Cockatoo Records"</span>),</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">options =</span> <span class="fu">layersControlOptions</span>(<span class="at">collapsed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a legend for the layers</span></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addControl</span>(</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">html =</span> <span class="st">"</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;div style='background-color: white; padding: 10px; border-radius: 5px;'&gt;</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;strong&gt;Legend&lt;/strong&gt;&lt;br&gt;</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;i style='background: lightblue; width: 18px; height: 18px; display: inline-block; margin-right: 8px; opacity: 0.7;'&gt;&lt;/i&gt;</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a><span class="st">      ACT Boundary&lt;br&gt;</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;i style='background: #11aa96; width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 8px;'&gt;&lt;/i&gt;</span></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a><span class="st">      Gang-gang Cockatoo Presence&lt;br&gt;</span></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a><span class="st">      &lt;i style='background: #f6aa70; width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 8px;'&gt;&lt;/i&gt;</span></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a><span class="st">      Gang-gang Cockatoo Absence</span></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span>,</span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"bottomright"</span></span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-9eceb20dc2a931752ae4" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9eceb20dc2a931752ae4">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["Esri.WorldImagery",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addPolygons","args":[[[[{"lng":[149.2978631639976,149.2961664989974,149.2959148779972,149.2956395019974,149.2956268919972,149.2936624629975,149.2936247079976,149.2954126899977,149.2954187069977,149.2944873469979,149.2942647749973,149.2941983089978,149.2940461319974,149.2938322929977,149.2936187589972,149.293410079997,149.2930393849971,149.2929335979972,149.2927268549977,149.2925222389971,149.2921976069971,149.292098524997,149.2916999569972,149.2904007969971,149.2901487869979,149.2901678319979,149.289663550997,149.2889906449973,149.2883272829979,149.2863743839972,149.2862618229979,149.2847694909976,149.2845992759979,149.2840712789977,149.2830107839975,149.2825796579979,149.281719610997,149.2808082299975,149.2803387579979,149.277275203997,149.2772538839973,149.2772324289975,149.2772108399978,149.277189119998,149.2771672699973,149.2771452929975,149.2771231909977,149.277100964998,149.2770786179973,149.2770561519976,149.2770335689978,149.2770108699971,149.2769880589974,149.2769651379976,149.276942106998,149.2769189699972,149.2768957289975,149.2768723859979,149.2768489419972,149.2768254009975,149.2768017639979,149.2767780339972,149.2767542119975,149.2767303019979,149.2767063039973,149.2766822219977,149.2766580509971,149.2766337999975,149.276609470998,149.2765850659974,149.2765605879979,149.2765360379973,149.2765114199978,149.2764867359973,149.2764619869978,149.2764371759973,149.2764123059979,149.2763873779975,149.276362395997,149.2763373599976,149.2763122749972,149.2762871409978,149.2762619619975,149.2762367389971,149.2762114759978,149.2761861739975,149.2761608349973,149.276135462998,149.2761100589978,149.2760846259976,149.2760591659974,149.2760336819972,149.2760083939971,149.275983086998,149.2759577639979,149.2759324249979,149.2759070739979,149.2758817129979,149.2758563439979,149.275830968998,149.275805590997,149.2757802119971,149.2757548349973,149.2757294619974,149.2757040939976,149.2756787349978,149.275653386997,149.2756280519973,149.2756027319976,149.2755774289979,149.2755521469973,149.2755268869976,149.2755016509981,149.2754764429975,149.2754512629979,149.2754261149974,149.2754010009979,149.2753759229975,149.2753508829971,149.2753258839977,149.2745131679971,149.2739098579979,149.2732411029978,149.2724014379973,149.2714788659977,149.2706735189975,149.2700978609979,149.2696076749977,149.2688031719974,149.2683732169974,149.2679123089977,149.2671752219971,149.2665718189979,149.2663452289974,149.2656472719976,149.2649365179971,149.2640514589978,149.2631871419974,149.2631670479976,149.2631468019979,149.2631264049971,149.2631058609974,149.2630851709976,149.2630643359979,149.2630433589971,149.2630222409974,149.2630009859976,149.2629795929978,149.2629580669971,149.2629364069973,149.2629146179976,149.2628926999978,149.2628706559971,149.2628484869973,149.2628261959976,149.2628037849979,149.2627812559971,149.2627586099974,149.2627358509977,149.2627129799979,149.2626899999972,149.2626669119975,149.2626437179979,149.2626204209971,149.2625970199975,149.2625735189978,149.2625499209971,149.2625262289975,149.2625024449978,149.2624785699972,149.2624546079976,149.262430559998,149.2624064279973,149.2623822149978,149.2623579229972,149.2623335549976,149.2623091119971,149.2622845969975,149.262260011997,149.2622353599975,149.262210641998,149.2621858609975,149.2621610189971,149.2621361189976,149.2621111629972,149.2620861539978,149.2620610919974,149.262035981998,149.2620108249976,149.2619856239973,149.261960379998,149.2619350969977,149.2619096119972,149.2618840779978,149.2618584959973,149.2618328679979,149.2618071979975,149.2617814869971,149.2617557379978,149.2617299539975,149.2617041359971,149.2616782889979,149.2616524129976,149.2616265109974,149.2616005869972,149.261574641998,149.2615486789978,149.2615226999977,149.2614967079975,149.2614707059975,149.2614446959974,149.2614186789973,149.2613926599973,149.2613666409973,149.2613406229974,149.2613146089974,149.2612886029975,149.2612626049976,149.2612366199977,149.261210648998,149.2611846949972,149.2611587609974,149.2611328479977,149.2611069589979,149.2610810979973,149.2610552659976,149.261029464997,149.2610036989974,149.2609779699979,149.2609522789974,149.2609266309979,149.2609010269974,149.260875468997,149.2608499599976,149.2608245029973,149.260799099998,149.2607737529977,149.2607484649974,149.2607232389972,149.2606980759971,149.2606729789979,149.2606479509978,149.2606229939977,149.2605981099977,149.2605733009977,149.2605485709978,149.2605239209979,149.2604993539979,149.2604748729971,149.2604504789973,149.2604261739976,149.2604019619978,149.2603778449972,149.2603538239975,149.2596054319977,149.2585759779972,149.2581115819979,149.2575535449971,149.2565677969973,149.256023886997,149.2560072029976,149.2559903509971,149.2559733329977,149.2559561519971,149.2559388079977,149.2559213029971,149.2559036379976,149.2558858149971,149.2558678359977,149.2558497019971,149.2558314139976,149.2558129739971,149.2557943839975,149.2557756459979,149.2557567599974,149.2557377289978,149.2557185549973,149.2556992379977,149.2556798989972,149.2556604219976,149.2556408079971,149.2556210579975,149.2556011749979,149.2555811589974,149.2555610129978,149.2555407379972,149.2555203369977,149.2554998099971,149.2554791599976,149.255458387997,149.2554374959975,149.2554164859979,149.2553953589973,149.2553741179978,149.2553527649972,149.2553312999977,149.2553097269972,149.2550515389979,149.2547441779976,149.2543456679978,149.2534458449972,149.2530855339977,149.252989162998,149.251676752997,149.2504125429972,149.2499702899978,149.2497497269973,149.2495289419975,149.2493074909978,149.2492065909979,149.2489904919973,149.2487778219971,149.2485661409974,149.2483932939977,149.2483555219972,149.2481508459975,149.247928830997,149.2477376779974,149.2475458959978,149.2473711619972,149.2471814429973,149.2470072619977,149.2468414569976,149.2466819779973,149.246546873998,149.2463978809976,149.2462590849974,149.246119358998,149.2459972379975,149.2458955069975,149.2457963719971,149.2456975599976,149.2450651159976,149.2450463459971,149.2450273469974,149.2450081179977,149.2449886609979,149.2449689759971,149.2449490639972,149.2449289249973,149.2449085599974,149.2448879699974,149.2448671549973,149.2448461169973,149.2448248549971,149.2448033699979,149.2447816639977,149.2447597359974,149.2447375879971,149.2447152199977,149.2446926319973,149.2446698269978,149.2446468029973,149.2446235629978,149.2446001059972,149.2445764339975,149.2445525469978,149.2445284459971,149.2445041319973,149.2444796049974,149.2444548669975,149.2444299179976,149.2444047589976,149.2443793909976,149.2443538139975,149.2443280289974,149.2443020379972,149.244275839998,149.2442494379978,149.2442228309974,149.2441960199971,149.2441690069977,149.2441417919972,149.2441143759977,149.2440867609972,149.2440588859975,149.2440308179978,149.244002557997,149.2439741049972,149.2439454629974,149.2439166299975,149.2438876079976,149.2438583989976,149.2438290019976,149.2437994189975,149.2437696509974,149.2437396979972,149.243709561998,149.2436792439977,149.2436487439974,149.2436180629971,149.2435872029977,149.2435561639972,149.2435249479977,149.2434935539972,149.2434619849976,149.243430241997,149.2433983239974,149.2433662339976,149.2433339719979,149.2433015389971,149.2432689369972,149.2432361649973,149.2432032259974,149.2431701209974,149.2431368499974,149.2431034139973,149.2430698139972,149.243036051997,149.2430021289978,149.2429680449976,149.2429338019973,149.2428994009979,149.2428648419976,149.2428301279971,149.2427952579976,149.2427602339971,149.2427250579976,149.2426897299979,149.2413853359973,149.239449923997,149.2311110759975,149.2309035069975,149.230731176998,149.2305292269975,149.2303988589977,149.2301627389975,149.2298613929972,149.2295644739978,149.2294377199975,149.2287143279973,149.2265396729978,149.2261432229979,149.225318045998,149.2248506269978,149.2243666029976,149.223924890998,149.2215714909979,149.220801767997,149.2205846129971,149.2203656329971,149.2200936029974,149.2198724569978,149.2196512259972,149.2194298879978,149.2191942779973,149.218974276998,149.2187559619977,149.2185414869974,149.2183291669972,149.2181192869974,149.2179122009971,149.2178779079972,149.2132981809974,149.2080391949975,149.2076854979975,149.2074485709974,149.2073806099973,149.2071615179972,149.2072534979974,149.2071056189971,149.2069206459979,149.2068247839973,149.2066405389978,149.2065495049973,149.2063694549972,149.2062812229977,149.2061940769973,149.2060250529972,149.2058597389978,149.2057797089972,149.2057014919979,149.2056230509979,149.2055479029974,149.2054733269974,149.2054001789975,149.2052528419981,149.2051161019978,149.2050486189978,149.2049176899979,149.2048539189975,149.2047927839977,149.2047328439971,149.2046150909975,149.2045584609977,149.2044479819979,149.2028271439976,149.2001508499974,149.1997041289977,149.198285198998,149.1939249079971,149.190824354998,149.1900055039971,149.1874257869976,149.1871547819974,149.1869323289975,149.1866640799973,149.1863261089974,149.1861449559973,149.1858080039972,149.185567158998,149.1852043179975,149.1850130009976,149.1847187149974,149.1845352329971,149.1842582459978,149.1843929319973,149.183544962998,149.1830578379976,149.1821952539977,149.1809358669973,149.1786395579978,149.177986393998,149.1763606649974,149.1762010159975,149.1718650949971,149.1714160909972,149.1710268269976,149.1707385759979,149.1703761959974,149.1701882839977,149.1685746139973,149.1654532839976,149.1628372089971,149.162830433998,149.1626837139971,149.1610932129972,149.1595937999978,149.1595802489975,149.1594402619978,149.159350441997,149.157463355997,149.1573233049974,149.1571754089977,149.1570240869972,149.1569152839975,149.1566115809972,149.1565745249978,149.1564249959977,149.1561904619975,149.1558738159979,149.1557128449979,149.1555492949972,149.1551940489978,149.155029540998,149.154860967998,149.1546921179979,149.154520287998,149.1543464209974,149.1541718739977,149.1539957019975,149.1538195289972,149.1536426809978,149.1534646069971,149.152833463997,149.150905589998,149.1490096579975,149.1488352719979,149.148666956998,149.1485013629977,149.1483401729977,149.1481832359977,149.1480261409978,149.1478704089972,149.1477408119979,149.1475965609972,149.1474585789979,149.147321989998,149.1471880169977,149.1470428429977,149.1468041539978,149.1466875849975,149.1465824999975,149.1464787559979,149.1463902939978,149.146295649998,149.1462036399978,149.1460933939973,149.1458776419973,149.1458139209978,149.1457015309971,149.1456011949974,149.1453607339972,149.1453540979977,149.1445027069972,149.1444487879973,149.1443940309972,149.1443297889974,149.1442588169973,149.1441861579978,149.1440647109974,149.1439628819972,149.1438520389971,149.1437539769976,149.143360960998,149.1430888759977,149.1429299409973,149.1427644909971,149.1425909289977,149.1425238789973,149.1390945329978,149.1390678709978,149.1389479839975,149.1388379209979,149.1386931869977,149.1385617249979,149.1384638989975,149.1383764349972,149.1382989829978,149.1382440699978,149.1382203809975,149.1382031569974,149.1381876039977,149.1381788089972,149.1381640169973,149.138165361998,149.138191737998,149.1382289969975,149.1382677139973,149.1383251179974,149.1383867719977,149.1384938429973,149.1385828459975,149.1386094879979,149.138592619998,149.1386964819975,149.1387942669973,149.1388802909978,149.1389122549979,149.1389332269977,149.1389810069971,149.1390184309976,149.1390693559977,149.1391627689972,149.1392645399974,149.1393762109976,149.1395027149971,149.1396108099977,149.1397677519974,149.1399305069972,149.1401045969974,149.1403629259971,149.140339622998,149.1400538959977,149.1403240219974,149.1405913859977,149.141098699997,149.1417534579975,149.1423279189979,149.1428791039977,149.1433576249979,149.1432591789974,149.1443187969976,149.1444147679973,149.1445145599975,149.1446166819978,149.1447258169972,149.1448438569971,149.145064210998,149.1452847139972,149.1453951259972,149.1455058179978,149.1457280959974,149.1458277219974,149.1460437989971,149.1468827789975,149.147352235998,149.1475697549972,149.1477882809978,149.1480070439973,149.148227110998,149.1484478599972,149.1486623169977,149.1488845789972,149.1491063369974,149.1493277319978,149.1495488329975,149.1497697529977,149.1503182339975,149.1516852369972,149.1519094429975,149.1521308729973,149.1523506969971,149.1525680509974,149.1527835239978,149.1528476009977,149.1528982859973,149.1531106589979,149.1532562699977,149.1534536149977,149.1535354739975,149.1537167739978,149.1538942989971,149.154062027997,149.154198143997,149.154343012998,149.1544797429972,149.1546138929976,149.1547229359978,149.1547245709977,149.1548863199979,149.1549569209977,149.155015762997,149.1550555749975,149.1550811369975,149.1550951799978,149.155096162998,149.1550807379977,149.1550581179973,149.1550162549976,149.154958434997,149.1548884959971,149.1548235939971,149.1547275209972,149.1546195559977,149.1545012119979,149.154368318998,149.1543173949979,149.1540540489974,149.1539115859971,149.1537718969974,149.1536320349977,149.153496325998,149.1534562609973,149.1533405729973,149.1532361229975,149.1531433089971,149.1530946579973,149.1530155359977,149.1529983579973,149.1529394229977,149.152892554997,149.1528612679971,149.1528418419971,149.1528329459979,149.1528323169973,149.1528455319975,149.1528725829976,149.1529197239973,149.1530186419975,149.153070823997,149.1531071429974,149.1531165839971,149.1531231629977,149.1530147499977,149.152871114997,149.1528390929977,149.1525689419971,149.1524404969976,149.152340812997,149.1522122779974,149.1520318419972,149.1518415359976,149.1516416699978,149.1514632499973,149.1512472519976,149.1510287849977,149.1508078179976,149.1506554849973,149.1504338549976,149.1502138979979,149.1499952749973,149.1497762819979,149.1496009649972,149.1493768259977,149.1491541749971,149.1489324829978,149.1487131149975,149.1484952959971,149.1483290379979,149.1482033179971,149.1480528429972,149.1478538939977,149.147663209998,149.1474557619979,149.146284754998,149.1441627009977,149.1439936509977,149.143837239998,149.1436910199977,149.1435577729977,149.1435233749975,149.1434082749976,149.1433102079972,149.1432281549979,149.1431642459978,149.143116064998,149.1430789069971,149.1430663999972,149.1430658609971,149.1430775719974,149.1431250679973,149.1431528389975,149.1431521699972,149.1430149009972,149.1430641139972,149.143056856997,149.1428815689978,149.1428281889971,149.1425755909972,149.142417249997,149.1422510079977,149.1418876519974,149.1415244589979,149.1412492029972,149.1407977189979,149.1401299639974,149.1391661449972,149.138754037998,149.1379256959978,149.1377067819979,149.1374959869975,149.1372934659977,149.1370529449971,149.1365512239978,149.1363851209974,149.1362173259976,149.1360648289978,149.1359838189976,149.1358569059979,149.1357385949972,149.1355705079973,149.1351789939974,149.1350924129973,149.1350721319975,149.1353140979974,149.1355335309977,149.1356226309976,149.1357049399978,149.1357825069974,149.1358479719971,149.1359217899972,149.1359820449978,149.1359996799975,149.1361158959979,149.1361253899975,149.1361202239972,149.1359087249977,149.1358922709972,149.1358784679971,149.1358677659974,149.1358684539972,149.1358772979978,149.1359163339976,149.1359597539979,149.1360067939974,149.1360644199976,149.136131446998,149.1362120629979,149.1362897339976,149.1367306239971,149.1367639929976,149.1369760759979,149.1375212219978,149.1378150509971,149.1378971539972,149.137967289998,149.1379962019972,149.1379971749977,149.1380009869978,149.137967447998,149.1379294379971,149.1379058439973,149.138058744997,149.1380893829976,149.1381014639975,149.1381143999976,149.1381293219979,149.1381484489978,149.1381706609972,149.1381864859976,149.1381769999973,149.1381815509976,149.1381918519976,149.1382288279978,149.1383360999972,149.1383939939975,149.1384555109971,149.1385227879975,149.1386014399978,149.1389527929976,149.1391233339975,149.1393571299971,149.1394737709978,149.1396006689973,149.1397222039974,149.1398487069979,149.1399777599977,149.1401186069979,149.1416025859975,149.1419762599974,149.142331564997,149.1426339799974,149.1430655439974,149.1435320339978,149.1436404199977,149.1437476219975,149.1438524659971,149.1439569179976,149.144060185998,149.1441585299979,149.1442554949977,149.1443504919972,149.1443962519978,149.1444897369972,149.1445803759973,149.1446687819971,149.1447547459977,149.144823701998,149.1449840399979,149.1450612979975,149.1451455959971,149.1462852549978,149.1463601119979,149.1499045079973,149.1511202189971,149.1511332769971,149.1511485259971,149.1511635349971,149.1511783029971,149.151192830997,149.151207117998,149.1512211629979,149.1512349659977,149.1512485269975,149.1512618449974,149.1512749199971,149.1512877509979,149.1513003379976,149.1513126809973,149.1513247799979,149.1513366329975,149.1513482409971,149.1513596039976,149.1513707199971,149.1513815909977,149.1513922139971,149.1514025909976,149.1514127209979,149.1514226029973,149.1514322379976,149.1514416239979,149.1514507619972,149.1514596519974,149.1514682919976,149.1514766839978,149.1514848259979,149.151492718998,149.151500361997,149.1515077549971,149.151514897997,149.1515472269979,149.1515711779976,149.1515865049973,149.1516101209976,149.1515150579975,149.1514512649977,149.151444873998,149.1514844869976,149.1514314469978,149.1513695249979,149.1513374229971,149.1512752349976,149.151268117998,149.1512558329976,149.151226979997,149.1511976889974,149.1511701569971,149.1511364739977,149.1510837559977,149.1509590609976,149.1508619399974,149.1508137179976,149.1507629179972,149.150707409998,149.1506519019977,149.1505912489976,149.150528241998,149.1504640859977,149.150400416998,149.1503317009973,149.1502606909972,149.1501869479976,149.1501121509978,149.1500200069971,149.1476084849979,149.1449948009971,149.144986976997,149.1413513299977,149.138581598998,149.1383740909976,149.1378650759974,149.1380443599972,149.1380403429977,149.1352169139971,149.1327568959975,149.1327489689975,149.1326695099978,149.1325932249977,149.1325224389977,149.132454184997,149.1323867829976,149.1323223349978,149.1322564139976,149.1321940889971,149.1321328149978,149.1320519749977,149.1320029539973,149.1319534909975,149.1319092539973,149.1318678379976,149.1318292449974,149.131810164998,149.1317751609974,149.1317401569978,149.1317060389974,149.1316747769974,149.1316476949971,149.1316250209976,149.1316043289975,149.1315910319971,149.1314533869977,149.1314504169975,149.1315760569973,149.1316217489973,149.1316424799976,149.1316658499972,149.1316929769974,149.1317222929979,149.1317489129974,149.1317832219976,149.1318225549975,149.1318634189975,149.1319049339977,149.1319450279977,149.1353976959971,149.1354509909978,149.1352139539976,149.1353858499973,149.1356022189978,149.1357367889974,149.1357495609973,149.1354352089974,149.1347029189977,149.1347520519979,149.1358477499977,149.1364799329971,149.1375095329973,149.138117950997,149.1388298749976,149.1388875939974,149.1398211779972,149.1400559919974,149.1401684829975,149.1406674339972,149.140826559997,149.141052433998,149.1412203259981,149.141441018998,149.1416971129976,149.1426815629973,149.1383871689974,149.1351386449975,149.1351643969972,149.1303451719971,149.1300559859979,149.1260346489977,149.126465133998,149.1251873989973,149.1256172009971,149.1236021099978,149.123565745998,149.116244926998,149.1138922299973,149.1124713369977,149.1110861569973,149.1107633479977,149.1104528019974,149.110107896998,149.1092010729978,149.1088956329976,149.1091476749971,149.1046116279977,149.0949470929978,149.0846143029974,149.0829227149978,149.0781477499978,149.0779966559973,149.078309173998,149.0787252189972,149.0791203069978,149.0791212739973,149.0782327249972,149.078589403998,149.079365528997,149.0788725659974,149.0781802069971,149.0795196589975,149.0800572739973,149.0795168069974,149.0794978629973,149.0792345909975,149.0797338709972,149.0804244239976,149.0812167989975,149.0812481619973,149.0819309029975,149.082570727998,149.0845251279979,149.0849484239976,149.0847569779978,149.0849012879971,149.085208461998,149.0841899939973,149.0851293299974,149.0859263639975,149.0878736259976,149.0877424549977,149.0877732739975,149.0872612669973,149.0877734899979,149.0881457409975,149.0885854859974,149.0865047689972,149.0872365649976,149.0874460919971,149.0876606029973,149.0875626169973,149.0882662709971,149.089042218998,149.0906553829971,149.0924225089977,149.093576894998,149.0956286799975,149.0958330009977,149.0963200719976,149.0961332369978,149.0974796369979,149.0971077839977,149.0968061569976,149.0954276799974,149.095388105997,149.0960374469974,149.0976141359971,149.0983552259976,149.0985347769974,149.0978472739976,149.0962172159973,149.0958924239973,149.0958522679977,149.0960922319978,149.0966683759976,149.0966178009974,149.0959745919979,149.0956861639974,149.0957260229974,149.0959557979972,149.0959402329971,149.0962173269973,149.0966694749976,149.0966057589976,149.0972705609975,149.0971185219971,149.0965692649972,149.0960751079973,149.0949600809972,149.0954953079979,149.0952979099976,149.0958934399972,149.0994196969975,149.1014458309971,149.1020586939974,149.102899911997,149.1043817259975,149.1047671799973,149.104839014998,149.1043769759973,149.1037991729971,149.1037547779971,149.1041779369974,149.1059339399971,149.1066743099971,149.1078823269971,149.1082149209978,149.1084952999975,149.109417860998,149.108947492998,149.1086328909971,149.1078246489977,149.1078805419976,149.1074762629974,149.1062885389972,149.105453912998,149.1041279039978,149.1034257609974,149.102743042998,149.1022534359977,149.1019666499976,149.1019174449971,149.1016051269974,149.1015967899974,149.1012663149971,149.100983384998,149.1011108449971,149.0997787379975,149.0993493709971,149.0993711369972,149.100065709997,149.1006128249978,149.1006773269978,149.1016629259973,149.1024099979975,149.1024083499974,149.1038873039976,149.1041326969979,149.1040985989971,149.1036737829979,149.1028103669979,149.1001161419974,149.0990980659976,149.0990393059972,149.1005862459973,149.1005885739976,149.1007684129971,149.1006860739973,149.0997030649972,149.099034756998,149.0990601309974,149.0984183469971,149.0980659929972,149.0977891119975,149.0968975499978,149.0962284379974,149.0956148219971,149.0969828649975,149.0956389969976,149.095063749998,149.0962196739974,149.0963996449979,149.0956022109979,149.0949350299975,149.0949016699978,149.0945996559975,149.0946440589973,149.0929254229971,149.0932093169979,149.0936345529978,149.0933049339974,149.0928452709977,149.0907095359979,149.0911444029973,149.0922338879971,149.0927132059977,149.0932714909974,149.0930725709977,149.0916305009972,149.0929323139979,149.0948513369972,149.0958832709974,149.0963194249971,149.0973703129973,149.0962738899976,149.0957709249975,149.0950600089979,149.0947266229978,149.0931420399972,149.0933269809974,149.0928857749973,149.0930116159979,149.0933574559972,149.0934755189979,149.0961239599977,149.0975534029974,149.1001494449974,149.1003233319977,149.1005307439978,149.1004523859971,149.1001946319975,149.099457276997,149.0987113999971,149.0977689619979,149.0970646389972,149.0967590189978,149.0969067589971,149.0971095969975,149.0984017639978,149.0989900429979,149.0998376529972,149.0998316889977,149.1015044549976,149.1011164289974,149.1004213459971,149.0995529179974,149.0996687239976,149.098838762998,149.0982627549976,149.0995997489978,149.1004777679972,149.1002713029978,149.0995650479979,149.1001500069979,149.1005999229974,149.1004286829973,149.0988039679975,149.0973406079975,149.0959207229973,149.0958011189977,149.096045824997,149.0954058559975,149.094511694998,149.094983485997,149.0943172429976,149.0935719149975,149.0933759049979,149.094254231997,149.0947046119971,149.0945132389975,149.0945584019971,149.0939860509978,149.0937073829979,149.0936777409974,149.0922598319976,149.0920460969977,149.0926130329973,149.0929692089972,149.0929874949972,149.0934095539978,149.095384493997,149.0950354679975,149.0946111159975,149.0958151619978,149.0960189469972,149.0956873949975,149.0948589979974,149.0933156579972,149.0890070199977,149.086572862998,149.0862066469976,149.0852791179973,149.0842037959972,149.0845314449974,149.0837805069976,149.0821933039975,149.0808123219974,149.0808673179978,149.0797569839977,149.0780834869971,149.0768291879977,149.0761476089971,149.074803946998,149.0747192969976,149.0743173959971,149.0728263759975,149.0703925839978,149.0697205439976,149.0677370849972,149.0665672149977,149.0654951739974,149.0642838329973,149.0643387549975,149.063924411997,149.0629239649977,149.0624560419971,149.0617110339971,149.0615184889977,149.0617358029979,149.061523346997,149.0618189989978,149.0619462979977,149.0624472119974,149.0623768519971,149.0619399739976,149.0610685039979,149.0601395119975,149.0604329349976,149.0611693499972,149.0617374259973,149.0612493349972,149.0611458999972,149.0608135189972,149.0585778509979,149.0587999579972,149.0583423269978,149.0568882059976,149.0560492899972,149.0541987549972,149.053313838998,149.0522111469979,149.0517805879979,149.0516963399974,149.0526893229971,149.054883538997,149.0572445599973,149.0568427839975,149.0568181099977,149.0564288369975,149.055970144997,149.0557391609973,149.0559812169974,149.0558395569977,149.0554793609974,149.0554232519978,149.0551270929974,149.0549521249975,149.0548701499974,149.0543140699978,149.0539061369979,149.0532198879972,149.0526280049976,149.0526402999974,149.0520893659977,149.0513571859971,149.0507385009978,149.0502088039971,149.0499071409973,149.0495445449974,149.0490436829976,149.0484490369975,149.0475186699975,149.0463808299974,149.0449022399974,149.0445379009974,149.0441720529972,149.0440671669979,149.042675834997,149.0414901289971,149.0399648659976,149.0387487469974,149.0368891589971,149.0363146719971,149.0353153339975,149.0343170449977,149.0340328289976,149.032674013997,149.0313611249975,149.0303794559975,149.0297288999975,149.0285352449979,149.0277689929971,149.0272875229972,149.0265965159973,149.025790399997,149.0255121339978,149.0250935629978,149.024451356998,149.0240510449974,149.0239330239972,149.0228823049976,149.0214824159973,149.0208620199975,149.0193069929973,149.0176767069978,149.0164146699977,149.0153486269977,149.0140554279975,149.0123949879974,149.010929953997,149.0088198899979,149.0034865929974,148.9994170489973,148.9973980539975,148.997607406997,148.9979585969971,148.9976626179979,148.9969571349974,148.9953205209973,148.9946980009973,148.9932498159975,148.9920037459972,148.9908171839974,148.9896119599971,148.9879731479971,148.9869117199972,148.9861797449971,148.9843286799977,148.9836698349977,148.9816455929979,148.9799670249973,148.9791761519973,148.9786187369978,148.9772440689978,148.9756555889974,148.9729596129977,148.9708505869977,148.9703508069979,148.9698698219977,148.9677585729971,148.9673587179974,148.9671039739977,148.9663547979972,148.9662950489979,148.9642461089974,148.962173408997,148.9615991039971,148.9591789399973,148.9595397299979,148.9585020039974,148.9583665329976,148.9565700869973,148.9559303959976,148.9540832459979,148.952919846997,148.9518070029973,148.9509714859973,148.9497520639979,148.9483447449979,148.9470869659975,148.9463645549972,148.9456781509977,148.944554625997,148.9443140719973,148.9429329849976,148.9419350689974,148.9410650359974,148.9405492329977,148.9385239579972,148.937232193997,148.9360543719972,148.9356176809971,148.934175171997,148.9328967409979,148.9321603819976,148.9322055629971,148.9322097289976,148.931219431998,148.9303459679971,148.929017381997,148.9280044839974,148.9275511349977,148.9265638579973,148.9263910639976,148.9250142789976,148.9244090169978,148.9236099569979,148.9222292799972,148.9208222289974,148.9198128129971,148.9194575329976,148.9204658109979,148.9200446259978,148.9181930909971,148.9177273299973,148.9163805089973,148.9147231949972,148.9129561369977,148.9119824019979,148.9116955039977,148.9113564679973,148.9106183449974,148.9094457429978,148.9090509429978,148.9087087499971,148.9078608349976,148.9079714799971,148.9076709019978,148.9079580409977,148.9079068449979,148.9073534339974,148.9064686669978,148.9065036469979,148.9060736429974,148.9048950629978,148.9048311759974,148.903988479997,148.9042141819975,148.9048166459978,148.9051553989972,148.9053117319975,148.9045640779975,148.904388292998,148.9039252199977,148.9036842699975,148.9033107449972,148.9031481859975,148.9032192559972,148.9037889509979,148.9050902149976,148.9065961049974,148.9070634749977,148.9062267569978,148.9036060129971,148.9018740269977,148.8997561239975,148.8976350869976,148.8977032729971,148.8973426109974,148.8966041149973,148.8958335119973,148.8949546759972,148.8937293029973,148.8925157949979,148.8921491179979,148.8918851389979,148.8911095099979,148.8890610579978,148.8877510759974,148.8874141279976,148.8866789699977,148.8869467109974,148.8874328589972,148.8891516659976,148.8894273079975,148.8898155749978,148.8902520889971,148.8907606379974,148.8919912529977,148.892956511997,148.8932187509977,148.8931537039976,148.8945487799975,148.8951986289974,148.8958524009974,148.8963494969979,148.8971805159975,148.8977770569975,148.8970516899973,148.8969842929973,148.8965677669972,148.8963671179979,148.8963445449973,148.8961569319974,148.8954376039971,148.8953236319971,148.8949942949976,148.8951593119978,148.895428280998,148.8948403379979,148.8954982489972,148.8947000139976,148.8950530069979,148.8952595419975,148.8948093189978,148.8948628639975,148.8950923439974,148.8960505389979,148.8970647829976,148.8983862579979,148.8993333479972,148.900112006997,148.9004508569975,148.9017977839973,148.9022991609979,148.9021471549971,148.9018067569976,148.9022747729978,148.902755970998,148.9030606269972,148.9033196319976,148.9032148699974,148.9028985179971,148.9024911949978,148.9014004509976,148.9012030739973,148.8992063769973,148.8988218739971,148.8975114479971,148.8951262099971,148.8940984129978,148.8934118029973,148.8930005849978,148.8917612709972,148.890912666998,148.8903577499971,148.8883268139978,148.888073367997,148.8880487199979,148.8883750749974,148.8924731649978,148.8923057279975,148.8905985669973,148.8893674949973,148.8881923929973,148.8872697989972,148.8867052609975,148.8850132389977,148.883787078998,148.8805730579973,148.8798414469974,148.8781996549974,148.8777140129977,148.8740754369972,148.8724857229979,148.8723856799978,148.8722521789972,148.8720219659975,148.8715947849975,148.8709764559979,148.8704484419974,148.8694507609971,148.8686799399972,148.8686087309975,148.868114349998,148.8672346289978,148.8658229699973,148.8640604029978,148.8667505429976,148.8674452759979,148.8667658949971,148.864872251998,148.8649312359977,148.864092026998,148.864044633998,148.8639323769974,148.8627061709976,148.8614200269979,148.8607301219973,148.8610798559974,148.8624413799971,148.8613171189975,148.8606038479972,148.8596568569973,148.858104861998,148.8575234219973,148.8556656019979,148.8549336229976,148.8560834579973,148.8540421029973,148.8534193579976,148.8510113239976,148.8495813969978,148.8488763009971,148.8483635149973,148.847079470998,148.8460478949972,148.8447001239973,148.8437017899979,148.8429177949974,148.8409548149972,148.8397254739976,148.8386304619972,148.8371717429978,148.8357916529971,148.8353056309971,148.8347206919971,148.8341062749978,148.8331284359971,148.8328995469971,148.831488496998,148.8301564979971,148.8295341059971,148.8292064899975,148.8289920999973,148.8278628409976,148.8258822529978,148.8249822069971,148.8235751339977,148.8231446369971,148.8231035869971,148.8226681279978,148.8224945479973,148.8206837249971,148.8187488609977,148.8172771749977,148.8160176289976,148.814199928998,148.8133091689976,148.8127749079973,148.8119263939974,148.8115094719972,148.8103849469978,148.8085582779973,148.8078508869974,148.8073146679972,148.8064110879973,148.8052739829974,148.8041468829979,148.8031407099976,148.8024079619976,148.8017946049977,148.8009110739977,148.8001383509972,148.7994640479976,148.7989819119973,148.7980526429971,148.7969595399975,148.796282491997,148.7965313839978,148.7961590679974,148.7953727909977,148.7942696689973,148.7937722079973,148.7932061649975,148.7933151429972,148.7927983409978,148.7920997139979,148.7914784369972,148.7910977749971,148.7911107589977,148.7906228909973,148.790316065997,148.7901206249974,148.7896424709977,148.7892751839971,148.7888943869972,148.7884422219972,148.7887292439973,148.7893596559973,148.7896275149971,148.7901406239973,148.7904352629978,148.7913972539973,148.7911522919974,148.7911688299976,148.7915262179975,148.7913453369971,148.7911674789975,148.7913260109971,148.7913755329972,148.7923701459974,148.7926143689976,148.7929139669975,148.7930258679973,148.7932481549972,148.7936945809975,148.7941117309973,148.7945717409975,148.7954758129973,148.795682583998,148.7965699379971,148.7971416139973,148.7975017259978,148.7976690389978,148.7975291409971,148.7979756079971,148.7981531659975,148.7982434989976,148.7983883369976,148.7980836339977,148.7980105719977,148.7976967209975,148.7972933039972,148.797170264997,148.7973380499973,148.797451498998,148.7975319509975,148.7979540989978,148.7985205979979,148.7984480809973,148.7973774789973,148.7967393659977,148.7963355599973,148.7964220329972,148.7948342499979,148.7943151969978,148.7938184819976,148.7926266119979,148.7916756289974,148.7905542709976,148.7897856259974,148.7875920599977,148.7869988429972,148.7863472269971,148.7864479299976,148.7860894009979,148.7852306369973,148.7842238079979,148.7833427059974,148.7826657799975,148.7817220049977,148.7809604899972,148.7799221029977,148.7782792209973,148.777613715997,148.7763789319979,148.7753234199974,148.7746676099971,148.7735023459974,148.7730801919973,148.7725113569975,148.772204367997,148.7730697499972,148.7729567019977,148.7728277079974,148.7717612439972,148.7701877299974,148.7695631829973,148.7684430939971,148.7679629779972,148.7674985049973,148.768110110998,148.7691239519976,148.7704326009978,148.771361064998,148.7717460769977,148.7714170139971,148.7717084219979,148.7719585419974,148.7712285329972,148.7708575489976,148.7756674299972,148.7762289609971,148.780379415998,148.7817067219977,148.7823666569978,148.782961206997,148.7834424339973,148.7830954589978,148.7823604049978,148.7806974989973,148.7804325319978,148.7796215149977,148.779489637998,148.7798384139977,148.7806223229974,148.7803365259971,148.7803881899977,148.7795887009971,148.7790642279977,148.7781747009978,148.7762643699976,148.774865468998,148.7737198929975,148.7726659729975,148.7716250599972,148.7710141319974,148.7706192669974,148.7697703279977,148.7688955929975,148.7684338349975,148.7690449069972,148.7695860099973,148.7709627369975,148.7721627809972,148.7725311069971,148.7733048849973,148.7736144879978,148.7745180149977,148.775591171998,148.7766222659978,148.7783357529974,148.7802551519971,148.7831914649975,148.783955482997,148.785653628998,148.7874925659971,148.7883087479974,148.7887732739976,148.7886320549979,148.7884769019977,148.788210093998,148.787796777998,148.7872293639979,148.7870672669976,148.7865974279976,148.7861242199975,148.7849746749974,148.7839261809975,148.7825560579977,148.782199007998,148.7821476239971,148.7815243169974,148.7806244719973,148.7803432519972,148.7796335339977,148.7770751929977,148.7751934139976,148.7736229369971,148.7731264359971,148.7729397609974,148.7785241969973,148.7779488439972,148.7773851529978,148.7768709169974,148.7761212159978,148.7754219669976,148.7752268739978,148.7746817029978,148.7740944329973,148.7732380539981,148.771403179998,148.7699971879971,148.769672537998,148.7694069079977,148.7696583159977,148.7698396339978,148.7699274799974,148.7697971429976,148.7699945869975,148.7702805229973,148.7712168899978,148.7716912529979,148.7721955219977,148.7722483919971,148.7719312429979,148.7714929129978,148.7709582349975,148.7696153839974,148.7679720689972,148.767664488998,148.7680077209975,148.7674973539978,148.7672498439975,148.7671659809975,148.766900261998,148.7670523299979,148.7672459739972,148.7669920449977,148.7660501789975,148.7683201189977,148.7678346409978,148.7669122629972,148.7651881539977,148.7643600549979,148.7642566289973,148.7644191599972,148.7640306829973,148.7629454719975,148.7627901059977,148.7637056269972,148.7645225729971,148.7651851219975,148.7670065059972,148.7687653939975,148.7698455679971,148.7708893979979,148.7718632139977,148.7731854229976,148.7738498049971,148.7743808789978,148.7744796039971,148.7744726149976,148.7736396329974,148.7729941299973,148.7719173309974,148.7708415479972,148.7702498459978,148.770451137997,148.7705613759974,148.7693349139971,148.7681629779971,148.7668460839975,148.7668678689971,148.7668459239974,148.7667415859973,148.7671520669979,148.7690166299979,148.7702127889976,148.7716836449972,148.7728765749972,148.7727071349974,148.7729826769971,148.7734509489976,148.7746776259978,148.774908035998,148.7759852719975,148.7751121889976,148.7746165179972,148.7737551799972,148.773013785998,148.7738853389971,148.774293338998,148.7745978649975,148.7743534489977,148.7748405609979,148.7777100539971,148.778690536998,148.7802801829974,148.7810273589978,148.7835554649976,148.7842052089979,148.785080609997,148.785327692998,148.7862102099979,148.7873476899972,148.7883337109979,148.7889165189971,148.7885703099977,148.788335321998,148.7876113369978,148.7888822159979,148.7889073659973,148.7893242609971,148.7889265729971,148.7897180859975,148.790157740998,148.7887665229977,148.7872103779976,148.7862868109976,148.7857776179973,148.7857944489975,148.7875076249975,148.7883182939977,148.7902112179973,148.7925246609975,148.7953102469977,148.795976404998,148.7961932589971,148.7960883259975,148.7963563449975,148.7958247489976,148.7961265159973,148.7956898359976,148.796070031998,148.7958159169976,148.7958543589974,148.7956870899977,148.796722319997,148.7994097879979,148.8011468049973,148.802100275998,148.8036099909973,148.8047644639979,148.8047873969974,148.8060596239972,148.8078708609975,148.8086596479976,148.8087153209977,148.8086321319976,148.8078622479973,148.8069229469974,148.8052975409976,148.8045817899975,148.8040644039973,148.8041645089972,148.8039071019979,148.8039260839971,148.8042861629972,148.8042327709976,148.8044309989979,148.8050128709978,148.8057274869979,148.8056964349975,148.8049106359971,148.8032852209978,148.8014881749977,148.8007356899979,148.8007881569977,148.7995531379975,148.7966985289972,148.7976904469971,148.798684003997,148.7992443399974,148.799397268997,148.7992946389973,148.7987290929977,148.7969041009975,148.7966644169978,148.7960318999978,148.7954939009973,148.7935466119971,148.7943720509972,148.795269349998,148.7976533109977,148.7985049589971,148.800396152998,148.8017121899977,148.8021362699979,148.802286093998,148.8020834659971,148.8010684739974,148.8028371829975,148.8034695839974,148.803728907998,148.8053175499972,148.8069881529973,148.8073363329972,148.8077986719976,148.8079602759976,148.8096710009978,148.8101335959977,149.0913383829972,149.0919176389978,149.0922175569972,149.0931524929976,149.0963192329973,149.0978552759974,149.1025736849977,149.1031277509972,149.1041446499978,149.1067184709974,149.1096786679979,149.1098538809976,149.1111153039974,149.1113188089975,149.1126521309976,149.113387055998,149.1155033699972,149.1162417059971,149.1169091679976,149.1180763179973,149.1209478569973,149.1228048539976,149.1264487239972,149.1271862699975,149.1270545109979,149.1282422679975,149.1289327019973,149.1298322619976,149.1320535199974,149.1370831689971,149.1389864579973,149.1387449109973,149.1401328399974,149.1388394539973,149.1388247079977,149.1401683869978,149.1407162829974,149.1414613339971,149.1435644199974,149.1448749389977,149.1460233249979,149.1458999569978,149.1475686009979,149.1482988629974,149.1496120349971,149.1497716059973,149.1492927349971,149.1472467979979,149.1465043599972,149.1467261709978,149.1477845299976,149.1484727739972,149.1489577369973,149.1502004139975,149.1507973029974,149.1522385749971,149.152659111998,149.1540019779978,149.1548952629971,149.1560723239976,149.157455803998,149.1576507739973,149.1582240479977,149.1591700089978,149.160905794998,149.1619725859973,149.1634802819979,149.1642780929972,149.1648293949977,149.1643857149978,149.1639021749978,149.1634542919971,149.1631777449976,149.163878978997,149.1647285579976,149.164388966998,149.1652154249974,149.1649532419971,149.1634524039974,149.1632543139973,149.1624296029971,149.1626363389971,149.1641284119976,149.164684023998,149.1653110629977,149.1668470679974,149.1676260509979,149.1675775229976,149.1694633389974,149.1706597859979,149.171188706998,149.1717823049976,149.1728388659976,149.1731868259972,149.1740776479971,149.1765387229972,149.1774112739976,149.1793950639975,149.1830024259974,149.1837364679975,149.1856061369972,149.1890726099971,149.1886353019974,149.1875457139977,149.1849761239979,149.1849804909974,149.1836407889976,149.1843300519974,149.1858793809974,149.1884447219977,149.1914150899972,149.192265460998,149.1929637569978,149.192922717998,149.1942976899975,149.195458503998,149.1970352349979,149.1968409279974,149.196855108998,149.1963752269972,149.1963882739974,149.1922028239978,149.190694987998,149.1902864419973,149.1913290119977,149.1914963839976,149.1901899039974,149.1902208539979,149.1895416809974,149.1923895579972,149.1963351239972,149.1977686319973,149.1985175739973,149.200715877998,149.2006718019979,149.204225292998,149.2058947589971,149.2071928719979,149.2085175429975,149.2087026869972,149.2075548669977,149.2060988349979,149.2056122919977,149.205027499998,149.2024557979976,149.2032792629971,149.2042782149976,149.2049859889979,149.2097624679971,149.2108397159972,149.2119498009974,149.2130501929977,149.213784845998,149.2160037079978,149.2199887399974,149.2235099829979,149.2242778669978,149.2257996229978,149.2270373449978,149.228775456997,149.231714769998,149.2343922349978,149.236510536997,149.237105293998,149.2386973349974,149.2398998489973,149.2407284299976,149.2412877579971,149.2432610279977,149.245531575998,149.2460096489971,149.2461250849976,149.246794043998,149.2463172879973,149.2459532439973,149.2448084549974,149.2429346089972,149.2427406869974,149.2429389249974,149.2429702559972,149.2427647469975,149.2415181079971,149.2412421989979,149.2384255969974,149.238483791997,149.2370437689978,149.236184804998,149.2345502119972,149.2343736039974,149.2348906309974,149.2372985609975,149.2379434649974,149.2406081539975,149.2418670359971,149.2427364149979,149.2442665099973,149.2458030989978,149.2472333479976,149.2494294669975,149.2503245569979,149.2496514959978,149.2499921749975,149.2506531929975,149.2530115359977,149.2539001369972,149.2553414589974,149.2553789779972,149.2573291909973,149.260006257997,149.2612915349975,149.2622610339975,149.262868221997,149.2677029819979,149.2695968629978,149.2705466379975,149.2717497019974,149.273179329997,149.2733163679976,149.2728197769978,149.2730177929977,149.2725543019971,149.2727781419977,149.2737923619972,149.2735125089978,149.2734613039974,149.2720768459972,149.272477307998,149.2723600949976,149.2717135039979,149.2716270229976,149.2722500659979,149.271807795998,149.2724395529973,149.2743769299975,149.2753781539971,149.2757509219979,149.2763809009978,149.2770210229976,149.2784478839976,149.2796276729977,149.2801264559974,149.2815243749972,149.2829763519976,149.2854329999976,149.2873235669973,149.2875204069972,149.2883645569973,149.2892930059973,149.2914341039974,149.293640413998,149.2943005589972,149.2966719969974,149.2973234389973,149.2984625449972,149.2987855299978,149.3006652229978,149.3016434829979,149.3020992409978,149.3022293279978,149.3027115709978,149.3038458139972,149.3057666009973,149.3062290439971,149.3054167769972,149.3066452619978,149.3090607729979,149.3097682209977,149.3116967199975,149.3121390389975,149.3142233819977,149.3153003359976,149.316068648998,149.3165648349974,149.3162784039972,149.3162642559973,149.3170436449978,149.3183220839971,149.319345781998,149.3203475619977,149.3209498949975,149.3212697129973,149.3220349789972,149.3224768109978,149.3235156959974,149.3245808389974,149.3250249819977,149.3254346009973,149.3265301839973,149.3275610499979,149.3287934469971,149.3300075779975,149.331154681998,149.3316950179971,149.3328699159974,149.3347718909973,149.3348523829978,149.3357569059974,149.3358050439977,149.3363248609978,149.3376174939975,149.3376980799974,149.339708722998,149.3414981929979,149.3414389179976,149.342837797998,149.3432104589972,149.3450342389972,149.3457677059978,149.3478720819972,149.348869894998,149.3487609859977,149.3480796769972,149.3489442339972,149.3497007059972,149.3505047689976,149.3505680009972,149.3501663349975,149.3504209569971,149.3503415819974,149.350552257998,149.3520173309977,149.3537125199975,149.3550244529978,149.3566145569975,149.3576160849979,149.359506959997,149.3609537229973,149.3619906209975,149.3619252159976,149.361061407998,149.3596586669975,149.361665833998,149.3637969519971,149.3658397449976,149.3668063739972,149.3698912039975,149.3719624379977,149.3737926599978,149.3760049189975,149.3760525559979,149.3777967059973,149.3798615429976,149.3816231739978,149.3818974749975,149.3836969829978,149.3841757139972,149.3865793229974,149.3882658509977,149.3896760409971,149.3916060549973,149.3934159259978,149.3947852189978,149.3949554979974,149.3950088189978,149.3949426159977,149.3946853119977,149.3953422289972,149.3944977549978,149.3964278849975,149.3972810299972,149.3971363079975,149.3966882979972,149.3971355269972,149.3972013339979,149.3980055299974,149.399287041998,149.3981629299973,149.3981297349972,149.3974224199974,149.3971764079975,149.3980355139979,149.3971308319977,149.3965457579972,149.3951442129974,149.3949114049973,149.3944678619979,149.3941636739973,149.3939971249973,149.3938381089971,149.3937172629972,149.3936253369979,149.3935184899976,149.393373598998,149.3930811229975,149.392861043998,149.3928359379977,149.3926992919971,149.3922501589978,149.391865397998,149.3917287229973,149.3915780609975,149.3914327759975,149.3912723329971,149.391109218998,149.3909822019973,149.390810243998,149.3906327809978,149.3904498139979,149.3901797049979,149.3899858449976,149.3897884829975,149.389588643998,149.3893770029973,149.3891710809973,149.3889620829978,149.3887497389978,149.3886068639973,149.387274989998,149.3870599469973,149.3868454309977,149.3866336899973,149.3864261989976,149.3862241809971,149.3860245059975,149.3858273519979,149.3856327989974,149.3853540679972,149.3823148149978,149.3764309139976,149.3761458609979,149.3759359339977,149.3757367839973,149.3754614899979,149.3752617299972,149.3750606769971,149.3748573409972,149.3745960519975,149.3739556379976,149.3732758219971,149.3726988839977,149.3722019949973,149.3719726699971,149.3719999329973,149.3684149639978,149.3682011709978,149.3679902659979,149.367782063998,149.3675797409973,149.3673828269978,149.3671884309971,149.366998137998,149.3668540509973,149.3666030869974,149.3664172289973,149.3662230959977,149.3659857769972,149.3658486649972,149.3657538549972,149.3656333269971,149.3654417189978,149.3653881669977,149.3653404569974,149.3652488069972,149.3651732489977,149.3651046379975,149.3650473309972,149.365002202998,149.364963818998,149.3649397749975,149.364921381998,149.3649147369975,149.3649174279976,149.364919563998,149.3649014709977,149.3649769509979,149.3649893419976,149.3650584289976,149.3650569459979,149.3650459499978,149.3649989749977,149.3649852779971,149.3649178779977,149.3648205959973,149.3647726999972,149.3645296529974,149.3644579619972,149.364302527998,149.364131242998,149.3638930319974,149.3636505439974,149.3635614319979,149.3634481779972,149.3633421999973,149.3630504779975,149.3627850389976,149.362450143998,149.3619908579975,149.361251951998,149.3611456799979,149.3606878979971,149.360630744998,149.3604679829973,149.3602528439977,149.3601119129973,149.3599010169971,149.3596971439972,149.3595570889978,149.3595022309974,149.3593256859975,149.3591236549973,149.3588185309972,149.3584645659975,149.3583214649972,149.3581650619979,149.3578979449973,149.3577244599972,149.3575462189976,149.3573617609972,149.3570914759972,149.3568859239978,149.3566789609976,149.3564697589972,149.3562570839979,149.3560381109973,149.3555658529979,149.3514468879977,149.3512251069976,149.351003567998,149.350782112998,149.3505607339978,149.350339589998,149.3501189109978,149.3499364499971,149.3497203159975,149.349289918998,149.3490808629973,149.3488754479978,149.3487726089977,149.3486299289974,149.3484391479973,149.3482483609971,149.3480599449979,149.3478756389977,149.3477012929975,149.3475216559979,149.3438544129977,149.3425249709979,149.3412469049975,149.3410532359974,149.3409063259974,149.3407708949971,149.3406431789975,149.3405253369977,149.3404449189975,149.3403492059977,149.3402580629975,149.340181866998,149.3401123049972,149.3400533259977,149.3400438539971,149.3399325969976,149.3398043649971,149.3394174329979,149.3393099309979,149.3391964089975,149.339070152998,149.3389346099978,149.3387943249972,149.3387503979979,149.3385948629972,149.3384336549974,149.3382693449974,149.3380988179974,149.3379191059972,149.3377287259979,149.3375332089974,149.3374470659973,149.337247980998,149.337032685998,149.3368356469977,149.3366247619972,149.3364135179978,149.3361962649973,149.3360730739979,149.3292262859979,149.327019165998,149.3270611889976,149.3264660039971,149.3263042349976,149.3240451379976,149.3205478859975,149.3202145389975,149.3195534069976,149.3192624379979,149.318915150998,149.3186483229974,149.3157487749979,149.3149288029977,149.3140197539979,149.3133073339973,149.3122244649979,149.3120775069977,149.3118563629979,149.3093785859972,149.3086248999977,149.3086273279974,149.307963762998,149.3079613349972,149.3071169809975,149.3054835849977,149.3052597649976,149.305038426998,149.3048200389977,149.3046043829978,149.3045042689976,149.3043082989972,149.3041240209971,149.3039411769979,149.3037650839978,149.3036006949978,149.3035677439974,149.3032003049973,149.3028268959978,149.3025109669972,149.3023281179972,149.3017824249976,149.3013025719979,149.3010877009977,149.3008713259977,149.3006537249977,149.3004347199977,149.3002127799979,149.2999876499974,149.299789482998,149.2986295199978,149.298089785998,149.2978631639976],"lat":[-35.33306265399914,-35.33313770799925,-35.33314883699916,-35.3331610159992,-35.33296267999923,-35.3321345149992,-35.33232234399927,-35.33307619399915,-35.3331708489991,-35.33321203299914,-35.33322471599925,-35.33322976199922,-35.33325339099923,-35.33330161699925,-35.33335108899924,-35.33338977499908,-35.33345981399923,-35.33348667699912,-35.33355124599922,-35.33362038699912,-35.33373690599918,-35.3337773599991,-35.33396820499922,-35.33467658599911,-35.3348146489992,-35.33472039199919,-35.33507818199925,-35.33544362199922,-35.33565150299923,-35.3367116059991,-35.33677385699924,-35.33762785099919,-35.33772525399922,-35.33788902299912,-35.33809943399926,-35.33814394699913,-35.33807594499925,-35.33790050399909,-35.33774808599927,-35.33619768799922,-35.33618608899923,-35.33617465799915,-35.33616339699918,-35.33615230799921,-35.33614138999924,-35.33613064599922,-35.33612007499918,-35.33610967999915,-35.33609945999924,-35.33608941799923,-35.33607955399924,-35.33606986799925,-35.33606036199927,-35.33605103699909,-35.33604189299925,-35.33603293099917,-35.33602415299923,-35.33601555899919,-35.33600714899927,-35.33599892499923,-35.33599088699921,-35.3359830359992,-35.33597537299909,-35.33596789899919,-35.33596061399911,-35.33595351799912,-35.33594661199913,-35.33593989599926,-35.33593337199909,-35.33592704099913,-35.33592090299916,-35.33591495899921,-35.33590920899926,-35.3359036539991,-35.33589829399917,-35.33589312899913,-35.3358881609992,-35.33588338999918,-35.33587881599914,-35.33587443899921,-35.33587026099919,-35.33586627999918,-35.33586249899925,-35.33585891699915,-35.33585553399924,-35.33585235099922,-35.33584936699922,-35.33584658499921,-35.33584400199911,-35.3358416209991,-35.3358394409992,-35.3358374619992,-35.33583569799918,-35.33583413299916,-35.33583276599924,-35.33583159799922,-35.33583062799911,-35.33582985699918,-35.33582928399916,-35.33582890999924,-35.33582873499921,-35.3358287589992,-35.33582898099927,-35.33582940199914,-35.33583002199921,-35.33583084099917,-35.33583185799915,-35.33583307299911,-35.33583448699918,-35.33583609999912,-35.33583790999918,-35.33583991799923,-35.33584212399919,-35.33584452799913,-35.33584712899917,-35.33584992699922,-35.33585292199925,-35.33585611299928,-35.33585950099919,-35.33586308499921,-35.33599896999918,-35.33598762599927,-35.33575814699925,-35.33544851799923,-35.33521508999927,-35.33514132099921,-35.33517938499909,-35.33515743199924,-35.33512147199925,-35.33506708499906,-35.33487258399919,-35.33442315999918,-35.3339026469991,-35.33357618299912,-35.33308576899925,-35.33262170699908,-35.33225181099911,-35.33165106899923,-35.33163807899924,-35.33162524899925,-35.3316125799992,-35.33160007199923,-35.33158772699908,-35.33157554599926,-35.33156353099923,-35.33155168099923,-35.33153999899923,-35.33152848599923,-35.33151714199915,-35.33150596799909,-35.33149496699923,-35.33148413699917,-35.33147348199923,-35.33146300099921,-35.33145269599909,-35.33144256699916,-35.33143261599918,-35.33142284299917,-35.3314132489992,-35.33140383599911,-35.33139460399924,-35.33138555399919,-35.33137668599915,-35.33136800299919,-35.33135950199916,-35.33135118699911,-35.3313430569992,-35.33133511499909,-35.33132735999918,-35.33131979299927,-35.33131241499927,-35.33130522699929,-35.3312982299992,-35.33129142299922,-35.33128480799924,-35.33127838499927,-35.3312721549992,-35.33126611799926,-35.3312602759992,-35.33125462699925,-35.3312491739991,-35.33124391699916,-35.33123885499921,-35.33123398999909,-35.33122932199925,-35.33122485199914,-35.33122057899912,-35.33121650399909,-35.33121262799918,-35.33120895099925,-35.33120547299924,-35.33120219499912,-35.33119789099915,-35.33119379099927,-35.33118989699908,-35.3311862079992,-35.33118272499922,-35.33117944899914,-35.33117637899917,-35.3311735159992,-35.33117086099924,-35.33116841299915,-35.33116617199909,-35.33116413999913,-35.33116231499926,-35.3311606989992,-35.33115929199913,-35.33115809299916,-35.3311571029992,-35.33115632099923,-35.33115574799925,-35.33115538499909,-35.33115522999921,-35.33115528399926,-35.33115554699928,-35.3311560189991,-35.33115669999924,-35.33115758999926,-35.33115868899917,-35.33115999599908,-35.3311615119991,-35.33116323599921,-35.33116516799921,-35.33116730899923,-35.33116965699921,-35.33117221199921,-35.3311749759991,-35.33117794599918,-35.33118112299917,-35.33118450599916,-35.33118809599913,-35.3311918909991,-35.33119589199926,-35.33120009799921,-35.33120450899926,-35.33120912399912,-35.33121394199926,-35.33121896399919,-35.33122418899922,-35.33122961599923,-35.33123524499925,-35.33124107599924,-35.33124710699924,-35.33125333799924,-35.33125976899921,-35.33126639799919,-35.33127322599925,-35.33128025199911,-35.33128747399926,-35.33129489299909,-35.33130250799923,-35.33131031699926,-35.33131831999926,-35.33132651699927,-35.33164985499921,-35.33196843999926,-35.33179744099909,-35.33170222399924,-35.33139487599916,-35.33096608899923,-35.33095126499926,-35.3309365679992,-35.33092199999916,-35.33090756199913,-35.33089325399911,-35.33087907999911,-35.33086503799922,-35.33085113199923,-35.33083736099927,-35.3308237279992,-35.33081023299926,-35.33079687699925,-35.33078366199912,-35.3307705889991,-35.33075765899921,-35.33074487299923,-35.33073223199916,-35.3307197369992,-35.33070735399924,-35.33069511899919,-35.33068303199926,-35.33067109399923,-35.33065930599921,-35.3306476689992,-35.3306361839992,-35.33062485299922,-35.33061367499913,-35.33060265299917,-35.33059178599921,-35.33058107599916,-35.33057052399912,-35.3305601309992,-35.33054989699927,-35.33053982399927,-35.33052991299925,-35.33052016299925,-35.33051057599907,-35.33020769499922,-35.33012117199924,-35.33018795299913,-35.33017765099917,-35.33024699299916,-35.3302474429992,-35.33025357299916,-35.33017121699918,-35.33015984699912,-35.33013929799915,-35.33012455799926,-35.3301272039992,-35.33014020799915,-35.33018388699928,-35.33023523199914,-35.33028878599919,-35.33033433799909,-35.33034471599927,-35.33041393199912,-35.33049704299927,-35.33058149799927,-35.33067510199916,-35.33078632499925,-35.33088205999926,-35.33099385499924,-35.33111430699921,-35.3312412989991,-35.33135522499921,-35.33149205699913,-35.33163433699925,-35.33177611999926,-35.33192730799911,-35.33208938799912,-35.33225285599921,-35.33242288299913,-35.33351545899921,-35.3335488849992,-35.33358222299919,-35.33361547299922,-35.33364863399917,-35.33368170399923,-35.3337146819991,-35.3337475689992,-35.33378036099925,-35.33381305899918,-35.33384566099913,-35.33387816699921,-35.33391057499912,-35.33394288399924,-35.33397509399919,-35.33400720199925,-35.33403920899922,-35.33407111299912,-35.33410291299923,-35.33413460899907,-35.33416619799913,-35.33419768099922,-35.33422905599921,-35.33426032099912,-35.33429147699925,-35.33432252299921,-35.33435345599917,-35.33438427599916,-35.33441498299908,-35.33444557499922,-35.33447605099927,-35.33450641099913,-35.33453665199911,-35.33456677599921,-35.33459677899926,-35.3346266619991,-35.33465642399916,-35.33468606299914,-35.33471557799913,-35.33474496999924,-35.33477423599906,-35.33480337599922,-35.33483238799909,-35.33486081199909,-35.3348891089992,-35.33491727599912,-35.33494531299917,-35.33497321999914,-35.33500099499923,-35.33502863699911,-35.33505614699913,-35.33508352199916,-35.33511076199912,-35.33513786599919,-35.33516483399927,-35.33519166399926,-35.33521835499908,-35.33524490799911,-35.33527131999916,-35.33529759099922,-35.33532372099921,-35.33534970799921,-35.33537555199922,-35.33540125199914,-35.33542680699919,-35.33545221599925,-35.33547747799923,-35.33550259399912,-35.33552756099913,-35.33555237899926,-35.3355770479991,-35.33560156599926,-35.33562593299921,-35.33565014799921,-35.3356742099992,-35.33569811899923,-35.33572187399914,-35.33574547299919,-35.33576891799915,-35.33579220499923,-35.33581533599911,-35.33583830799911,-35.33586112199922,-35.33588377699916,-35.33590627199911,-35.33592860599929,-35.33595077899925,-35.33674129899919,-35.33781909599918,-35.34246217699918,-35.34257918799916,-35.34264952799923,-35.3427242969992,-35.34276551999918,-35.34282970299916,-35.34288449899926,-35.34291077299928,-35.34292019199926,-35.34260588299926,-35.3421901499992,-35.34193173199926,-35.34177468499919,-35.34168571999916,-35.34177412299918,-35.34168998899922,-35.34124169499922,-35.34135556699918,-35.34132033799907,-35.34129405999909,-35.3412713419992,-35.3412591929992,-35.34125465799924,-35.34125991899923,-35.34128065699924,-35.34130873999916,-35.34134189199909,-35.34138659099916,-35.34143776699917,-35.34149628199921,-35.34156319599924,-35.34157460899922,-35.34324393299912,-35.34516053899913,-35.34527385799919,-35.34537873899924,-35.34525587899927,-35.3452992429991,-35.34546552699911,-35.34553189899921,-35.34562039099922,-35.34566848599919,-35.34576889699926,-35.3458204089991,-35.34592685699916,-35.34598215399922,-35.3460379999992,-35.34615501499925,-35.34627336699919,-35.34633340799922,-35.34639414499919,-35.34645740399927,-35.34652119099926,-35.34658724299909,-35.34665305999911,-35.34678845199907,-35.34692844199922,-35.34700092099921,-35.34714481799912,-35.34721873699916,-35.34729411499919,-35.34737030599919,-35.34752358399913,-35.34760145599915,-35.34775958499912,-35.35026612199912,-35.35441127199917,-35.35510312499927,-35.35730024699919,-35.36405103099928,-35.36885409799913,-35.37012064599922,-35.37411050099926,-35.37453057799926,-35.37487167999927,-35.37527338799926,-35.37576917199907,-35.3760267529992,-35.37649743199921,-35.37682590599926,-35.3773082459992,-35.37755627799916,-35.37793476799913,-35.37783236999918,-35.37818892999923,-35.37834376199908,-35.37936017699925,-35.37990776799924,-35.38085001099913,-35.38218333799916,-35.3846143239992,-35.3848880399992,-35.38660873199927,-35.38719521599925,-35.39178418299925,-35.39218730299924,-35.39259913299919,-35.39290408899922,-35.39336211799927,-35.39356109199927,-35.39526969299914,-35.39857497799915,-35.40134122299917,-35.4013483939992,-35.40150370799927,-35.40318873899918,-35.40477578599928,-35.40479012899912,-35.40493829399926,-35.40503336099909,-35.40703060899916,-35.40717144199915,-35.40730639699925,-35.40743878399926,-35.4075342109992,-35.40780555999917,-35.4078392339991,-35.40797296499916,-35.40816902299923,-35.40842267399923,-35.4085471879991,-35.40866944499913,-35.40893205399915,-35.40905424899925,-35.40917214699913,-35.40928975299914,-35.40940420899911,-35.4095165129993,-35.40962809699912,-35.4097379629991,-35.40984782899917,-35.40995698299921,-35.41006483899927,-35.41042877699912,-35.41156429899923,-35.41268094599921,-35.41279378699912,-35.41291191299926,-35.41303240899917,-35.41315673899918,-35.4132847719991,-35.41341266699912,-35.41354174999921,-35.41365769299909,-35.41379548399916,-35.41393730399906,-35.41408001999925,-35.41422441599919,-35.41438548199918,-35.41469129599916,-35.41484553099926,-35.41500523699914,-35.4151655819991,-35.41530333899912,-35.41546730199929,-35.41563222599921,-35.41584844699926,-35.41633878499914,-35.41651416699911,-35.41686502299921,-35.41725635699913,-35.41850620699921,-35.41854205399915,-35.42314095399927,-35.42331725899908,-35.42349334199927,-35.42366689199927,-35.42383864699926,-35.4240099519991,-35.42424056199919,-35.42440178499911,-35.42455875299919,-35.42468161399922,-35.42487129099914,-35.42538794099915,-35.42551468899924,-35.42563526399912,-35.42574815299925,-35.42578741299921,-35.42786366199912,-35.42787980299909,-35.42796047099915,-35.42804178799927,-35.42817678299919,-35.42834567999918,-35.42850048099926,-35.42866745399908,-35.42883733599925,-35.42901376799912,-35.42910307399926,-35.42919425799911,-35.42928592799922,-35.42937932699913,-35.42953973499912,-35.42972407699917,-35.42990452299911,-35.43008327399924,-35.43020827199928,-35.43038278999923,-35.43052275199913,-35.43071939799918,-35.43088078799923,-35.43111849099915,-35.43125785499925,-35.43141852399923,-35.4315813829992,-35.43174847999925,-35.43185197099923,-35.43194282099923,-35.43221034699927,-35.43238906899928,-35.43253254099907,-35.43269805299921,-35.43285948099926,-35.43301607099918,-35.4331654109991,-35.43327466399926,-35.43340374499923,-35.43352711199922,-35.43363933199923,-35.43378699599923,-35.43390145599916,-35.43382895299908,-35.43397838899915,-35.43410479499914,-35.43424566999906,-35.4343035069993,-35.43426938999917,-35.43414893299922,-35.4340968819991,-35.43397627999919,-35.43339903799908,-35.43335035799925,-35.43331000599909,-35.43327473199925,-35.43325473799926,-35.43323762799923,-35.43321239799922,-35.43318988699927,-35.43318161599922,-35.4331784219992,-35.43318796099911,-35.43320114599913,-35.43324304099924,-35.43329614099918,-35.43339835799928,-35.4334348219992,-35.43346517599927,-35.43349409199913,-35.43351510399923,-35.4335319789992,-35.43354303999924,-35.43355216499925,-35.43355224199925,-35.43354579199922,-35.43353409199916,-35.43351912399913,-35.43348122699923,-35.43338324899926,-35.43338033099926,-35.4333935659991,-35.43341613599912,-35.43345307299924,-35.43350095099915,-35.43351712199927,-35.43353113699916,-35.43360028599908,-35.4336578709992,-35.43374047799911,-35.43378064399927,-35.43388554899921,-35.43399424999924,-35.43411279699924,-35.43422219099909,-35.43436038199923,-35.43450329299921,-35.43466547099928,-35.43482531899922,-35.43483034099923,-35.43512258799918,-35.4352947459992,-35.43546953399911,-35.43562928499914,-35.43581053599925,-35.43599180999923,-35.43617310999922,-35.43635444199921,-35.43649688899919,-35.43667573699927,-35.43685078799922,-35.43702295499922,-35.43715690399916,-35.43732137399925,-35.43747986999908,-35.43763315199914,-35.43777912599919,-35.43783177199928,-35.43809246199918,-35.43823138399918,-35.43837211299925,-35.43851272899922,-35.43865604999922,-35.4387071459992,-35.43886299899922,-35.43902316199924,-35.43918778899926,-35.43928726099914,-35.43946514199928,-35.43950666599916,-35.43968306399922,-35.43986080999922,-35.44004029799905,-35.44022110999921,-35.44040309899925,-35.44050201399914,-35.44068336299909,-35.44086330799927,-35.44107847299911,-35.44143205399919,-35.44160840399927,-35.44178735199916,-35.44188319199922,-35.44209981499909,-35.44245117499928,-35.44280905799922,-35.44286042999909,-35.44329381099912,-35.44341450699916,-35.44349185699924,-35.44357963799921,-35.44368752899916,-35.44378062699926,-35.44385940099917,-35.44391433899909,-35.44395933899911,-35.44398997099923,-35.44400606399926,-35.44400730499923,-35.4439961499992,-35.44397438599919,-35.44394416599913,-35.44391628699919,-35.44389594599917,-35.44388140099917,-35.44388002999916,-35.44388714799909,-35.44391484299921,-35.44395625899909,-35.44399213799912,-35.4440276229992,-35.44407775999919,-35.4441586909992,-35.44425100199913,-35.44436812399913,-35.44508324099922,-35.44638424699921,-35.44650357499921,-35.44663226599919,-35.44676850399922,-35.44691435299921,-35.44696219499921,-35.44711881399925,-35.44728157499922,-35.44745011099918,-35.44762902599923,-35.44780706899923,-35.44798610999911,-35.44816738599924,-35.44835578999913,-35.44846959999926,-35.4487410549992,-35.44911029699916,-35.44919455299923,-35.44978564699915,-35.45024464299918,-35.45032296499907,-35.45062837499926,-35.45069535199924,-35.45092422599924,-35.45105229499928,-35.45117312999923,-35.45139156599921,-35.45138933299918,-35.45138764099914,-35.45141497699924,-35.45151443199926,-35.45152065199913,-35.4515242699991,-35.45154683299923,-35.45158561199921,-35.45164203499929,-35.45171643999924,-35.45181572499926,-35.45224923699919,-35.45236954399923,-35.45248843099912,-35.45262016099922,-35.45270172899928,-35.4528505389991,-35.45300383299923,-35.45323250499922,-35.45368499599913,-35.45403360699916,-35.45483825899928,-35.45540012099919,-35.45581152199923,-35.45597765499924,-35.45614598499918,-35.45631584999924,-35.45646216799918,-35.45663329899925,-35.45680780499923,-35.45687018899922,-35.45750308699927,-35.45768431399914,-35.4578300169991,-35.45908104799921,-35.4592618809992,-35.45944283399926,-35.45962392799916,-35.45967603099924,-35.45985848899916,-35.46003698399914,-35.46021490399916,-35.46038158199923,-35.46055720099923,-35.46073010699926,-35.46089909099917,-35.46103781099921,-35.46167698399926,-35.46172704399909,-35.46204520399908,-35.46259968899913,-35.46314061599926,-35.46330930899924,-35.4634812909991,-35.46358189399927,-35.46415042499927,-35.46423276499919,-35.46438484699922,-35.46454930699925,-35.4648706469991,-35.46552322799909,-35.46570294899918,-35.46588391699913,-35.46606496499911,-35.46624587799912,-35.46642650199919,-35.46660691599908,-35.46671614799909,-35.46689833799928,-35.46698893299919,-35.4670792219991,-35.46724805199911,-35.46760009199912,-35.46777511799922,-35.46794929499919,-35.46812211999921,-35.46831097799924,-35.46879398399916,-35.46907293499915,-35.46942214699909,-35.46957657199913,-35.46970962299922,-35.46987688099913,-35.47002574599927,-35.47017317499918,-35.47032597799915,-35.47176449499915,-35.47215027299922,-35.47253980899922,-35.47289030699911,-35.4734179099992,-35.47404827299911,-35.47420653499921,-35.47436529799921,-35.4745250569991,-35.47468498099914,-35.47484540599916,-35.47500791099927,-35.47517099799921,-35.47533491599922,-35.47541728299928,-35.47558172399911,-35.47574718099927,-35.47591343399911,-35.47608055999928,-35.47621894499927,-35.47655700799912,-35.47672693899909,-35.47692044399923,-35.47960820599926,-35.47978494099908,-35.48815224999922,-35.49102176899913,-35.4910525889991,-35.49108927799916,-35.49112603299913,-35.49116285399923,-35.49119973799923,-35.49123668599928,-35.49127369499924,-35.49131076499921,-35.49134789499909,-35.49138508399911,-35.49142232999926,-35.49145963299921,-35.49149699199928,-35.49153440499928,-35.49157187099929,-35.49160938999923,-35.49164695999919,-35.49168457999928,-35.49172224899927,-35.49175996699929,-35.49179773099924,-35.49183554099908,-35.49187339599928,-35.49191129499928,-35.49194923599919,-35.49198721899925,-35.49202524299911,-35.49206330499909,-35.49210140599921,-35.49213954499913,-35.49217771899919,-35.49221592899916,-35.49225417199914,-35.49229244799916,-35.4923307559991,-35.49251022399913,-35.49269046399917,-35.4928501299992,-35.49320054499923,-35.49827340299919,-35.49875235399921,-35.49911559099921,-35.49988831899925,-35.50262120199913,-35.5058115729992,-35.50637771599924,-35.50702106599911,-35.50706473199913,-35.50720184499916,-35.50738160299911,-35.50756131299909,-35.50774121499926,-35.50792044699912,-35.50819586699927,-35.50874695899918,-35.50911432999909,-35.50929144599922,-35.50946800099927,-35.50964353199922,-35.50981906299926,-35.50999347499917,-35.51016737399919,-35.51033701899922,-35.51051082699917,-35.51068322199928,-35.51085497399918,-35.51102596099922,-35.51119665299924,-35.51139701599916,-35.51663109999928,-35.52230312599917,-35.52232009299922,-35.53020319999925,-35.53620764599925,-35.53614369199915,-35.53724682599914,-35.53737227499911,-35.53738095699919,-35.54348451199919,-35.54880165099927,-35.54881878299914,-35.54898838999926,-35.54915881899921,-35.54933067099919,-35.54950317899915,-35.54967590699913,-35.54984939999925,-35.55002251199912,-35.55019655399925,-35.55037086799921,-35.55061727699924,-35.55079137599914,-35.55097094499925,-35.55114860299912,-35.55132672299916,-35.55150530599925,-35.55160343899922,-35.55178256599909,-35.55196169399908,-35.5521409119992,-35.55232042499915,-35.55250036799925,-35.55268076499917,-35.55286136599911,-35.55302442099926,-35.5536033529992,-35.55446863799915,-35.55503544799925,-35.55545047299928,-35.55563103999919,-35.55581134699919,-35.55599128599918,-35.55617100899928,-35.55631561699915,-35.55649478799921,-35.55667321399918,-35.5568514139991,-35.55702951699908,-35.55720020199912,-35.56963588399919,-35.56982773399918,-35.56979340599919,-35.5704121959991,-35.57037207399924,-35.57085648899913,-35.57090245199923,-35.5709328349992,-35.57100360999912,-35.57118042999925,-35.57125613599911,-35.57353872899915,-35.57725471499925,-35.57944203799924,-35.58200371399915,-35.58255061599917,-35.58590883799923,-35.58642359899917,-35.58682821499929,-35.58861525199919,-35.58908579299919,-35.58969550699915,-35.59008654099913,-35.5905540749991,-35.59103780999913,-35.59278921099922,-35.59219805099928,-35.59175075699912,-35.59163057499921,-35.59097872699914,-35.59240254299914,-35.59185222499926,-35.58973066999911,-35.58955765499925,-35.58748867099922,-35.58721276499914,-35.58739160599922,-35.58634515299919,-35.58538005299918,-35.58518531899909,-35.58675967199921,-35.58692947999923,-35.58713304799909,-35.58707165799924,-35.58632460899919,-35.58538489699917,-35.58408597099925,-35.58348477099925,-35.58220324999918,-35.58081461399927,-35.58459391599919,-35.58641691199919,-35.58801086199923,-35.58902486099921,-35.59255569899911,-35.59304365499917,-35.59353310899922,-35.59533992299921,-35.59672469699924,-35.5974421089991,-35.59858114299916,-35.59881867299918,-35.60247065299924,-35.60498462299924,-35.60515074899924,-35.60664092299918,-35.60774869999914,-35.60819708299911,-35.60899697699908,-35.61048581699919,-35.61125426499919,-35.6117873549991,-35.61363908999916,-35.61464310599926,-35.61676758399917,-35.6176537589991,-35.61852370099923,-35.61957586299928,-35.62167677599927,-35.62288402499927,-35.62537144399909,-35.62790492199923,-35.62812025299926,-35.62905380899917,-35.63028105799918,-35.63242086699924,-35.63356320799915,-35.63409216199915,-35.63587786299923,-35.63636736899927,-35.63668760999922,-35.63790896899923,-35.63965196999909,-35.64072795399919,-35.64105764199923,-35.64002167999924,-35.63971959699924,-35.64006067399922,-35.64033468699915,-35.64163067699919,-35.64413159999926,-35.64559842099914,-35.6472945819992,-35.64871775599911,-35.65174927799927,-35.65255269499911,-35.65302138799925,-35.65433939999922,-35.65594553099912,-35.6567991739992,-35.65721285199916,-35.65875847399919,-35.66036236699916,-35.66144069199918,-35.66193080599911,-35.66240679899912,-35.66316655799915,-35.6646127909993,-35.66541737299919,-35.66698771099912,-35.66805056699924,-35.66859125099928,-35.66919676199926,-35.67013654299922,-35.67213222699923,-35.67282031799915,-35.67360526799928,-35.67417148899911,-35.67452973999923,-35.67586183799914,-35.67682349699912,-35.67804649899914,-35.67927980199907,-35.68038150699908,-35.68388332599914,-35.68413768799922,-35.68455790299918,-35.6848195209992,-35.68486931799922,-35.68638482599911,-35.68734287199909,-35.68905952299922,-35.68977105299921,-35.69072521899911,-35.69107886299926,-35.69114754899913,-35.6929041129991,-35.69402673699914,-35.69501054499917,-35.69554984599912,-35.6965858129992,-35.69849758899916,-35.69953195099921,-35.70053034299921,-35.70119670099919,-35.70230661099927,-35.70340292999919,-35.70388790099926,-35.70493492499924,-35.70597638699923,-35.70655668399921,-35.7072383049992,-35.70777567099921,-35.70880192699924,-35.70940411499928,-35.71044695799922,-35.71217778299926,-35.71256143199928,-35.71286803099929,-35.71442725699926,-35.71465919999923,-35.71613516899922,-35.71693564999921,-35.71851020799917,-35.71901758299929,-35.7198665989991,-35.72089500099919,-35.72176378399923,-35.72328969199925,-35.72411802099925,-35.72498204199928,-35.72603888199926,-35.72670175399927,-35.72835517599928,-35.72928805099923,-35.73060727899922,-35.7334638509993,-35.73488535099911,-35.73552958399911,-35.73630395299914,-35.73795740599922,-35.73882689499914,-35.73925232899924,-35.73967486599921,-35.74052081599923,-35.74172107999917,-35.74268741099923,-35.74365045999919,-35.74599315299923,-35.74737210399921,-35.74985122799924,-35.75040126399918,-35.7520780759992,-35.75282386799924,-35.7533217069991,-35.75430590599929,-35.75491157099926,-35.75560677199921,-35.75660535299917,-35.75911903699912,-35.76092718899922,-35.76186005099915,-35.76265887999915,-35.76356652199927,-35.76561687599926,-35.76704966999913,-35.76799737199919,-35.76870507199912,-35.77077762399913,-35.7714609639992,-35.77394655199922,-35.77445423799926,-35.77581982999909,-35.77601239399927,-35.77628131799928,-35.7774421909993,-35.77881672699916,-35.78018822799917,-35.78063129299918,-35.78137343299917,-35.78318958199919,-35.78389426999925,-35.78490123799926,-35.78568142199925,-35.78639320699912,-35.7872303299991,-35.78721466299912,-35.78819726899921,-35.78972286299927,-35.79030894499917,-35.79139045199922,-35.79306521599913,-35.79406235399909,-35.79509316099924,-35.79522497099919,-35.79596983599927,-35.79684902899911,-35.79818019199922,-35.79896127099914,-35.79968404899919,-35.80053360099924,-35.80115753899925,-35.80176989599909,-35.80327192099929,-35.80365251199908,-35.80506148599909,-35.80570663599921,-35.8066764589992,-35.80723053399926,-35.80746088799921,-35.80793625399923,-35.80962605799917,-35.81002279299926,-35.81135590199913,-35.81189261399912,-35.81364310999911,-35.81470348599927,-35.81530187699925,-35.81687739899923,-35.81737972399925,-35.81758610799909,-35.81826547699924,-35.81974016599921,-35.82011305199924,-35.82121061899916,-35.82199910999919,-35.82298267799928,-35.82411169299923,-35.82560332699927,-35.82700990499922,-35.82862817299925,-35.82980902299916,-35.83076433299915,-35.83132174899921,-35.83207725199927,-35.83387992799918,-35.83483633799916,-35.83538019899913,-35.83726460299917,-35.83772436299912,-35.83824040699913,-35.83826685399928,-35.83911897899929,-35.84008034099926,-35.84149583999911,-35.84331558699912,-35.84422302599924,-35.84563668099923,-35.84682898499913,-35.84645466799924,-35.84816171899927,-35.84819608399915,-35.84889886199909,-35.84978236499925,-35.85020153799923,-35.85221976399927,-35.85280563899909,-35.85311876999928,-35.85611125399921,-35.85704574599922,-35.85895836099922,-35.85992762699917,-35.86057169599925,-35.86212000599915,-35.86378087499924,-35.86470832899916,-35.8657743229992,-35.86634059199919,-35.8692875739991,-35.86972709599927,-35.87075108999908,-35.87239975899925,-35.87378972299924,-35.87494734899919,-35.87611362299928,-35.87664939799919,-35.87777971799912,-35.87849798899926,-35.87987947499912,-35.88007327299908,-35.88068251799928,-35.88170829399929,-35.88229544799918,-35.88333989799923,-35.88407316599923,-35.88451572799917,-35.88539870099908,-35.88696148099926,-35.88829299599927,-35.88933758199913,-35.89047522399915,-35.89144803599915,-35.89182767299926,-35.89241443599923,-35.89328264399929,-35.89466559899916,-35.8959475199991,-35.89636575299917,-35.89722743299926,-35.8973569179992,-35.89876210099911,-35.89999484799912,-35.90144130599916,-35.90210229599922,-35.90337235699923,-35.90407773399917,-35.90536147999924,-35.90733233699924,-35.90823213199926,-35.90827208799909,-35.90869318499914,-35.90934656199912,-35.91020125399923,-35.91041166399919,-35.91084551599915,-35.91179151599913,-35.91236336099929,-35.91284036799913,-35.91350009499922,-35.91394315599923,-35.9146521709991,-35.9148810009992,-35.91553890499917,-35.91569145799929,-35.91602556299913,-35.91661823399915,-35.9172006189992,-35.91805142999915,-35.91857936399929,-35.91955159999922,-35.91995865199918,-35.92020879799921,-35.92029051699923,-35.92035747099911,-35.92053007299919,-35.91930371999928,-35.91816796299923,-35.91718845599928,-35.91629308199922,-35.91559190499909,-35.91439693799921,-35.91387115299916,-35.9142166669991,-35.91386112999916,-35.91376316399913,-35.91283270299915,-35.91169619199923,-35.91102903999928,-35.91095413599919,-35.91116645299926,-35.91152184099924,-35.91187612199924,-35.91224555799916,-35.91273608699924,-35.91244713599927,-35.91200811399916,-35.91122469799929,-35.91076145399924,-35.91032275199923,-35.90888824899919,-35.9080168549992,-35.90701995699914,-35.90598019599929,-35.90534745899923,-35.90511211799924,-35.90430447599919,-35.90335947599919,-35.90187164299919,-35.90161179799922,-35.90014505999912,-35.89962355399922,-35.90074252799927,-35.90130585799913,-35.9012033629992,-35.90267717299922,-35.90099580499928,-35.89884214299927,-35.89669744499921,-35.89642647999916,-35.89617216499915,-35.89583970299928,-35.89562846299927,-35.8951517779992,-35.89519681999924,-35.89588522399925,-35.89580222399918,-35.89563743099923,-35.89538860899929,-35.89499718199911,-35.89405769899923,-35.89387505299917,-35.89374023599918,-35.89320495199919,-35.89298896299911,-35.89281900399917,-35.89239881099921,-35.8921760049992,-35.89237666199911,-35.89283812699912,-35.89300910699925,-35.89328740499925,-35.89400552699913,-35.89465788199908,-35.89543606499925,-35.89679477899912,-35.89718011299913,-35.89696052499914,-35.89667809599926,-35.89672041299921,-35.89541375199926,-35.89428346099911,-35.89300443099928,-35.89171634999929,-35.89035611199917,-35.88983008599921,-35.88885079899925,-35.88828787299926,-35.88731857499918,-35.88642053799921,-35.88564883399913,-35.88432680899924,-35.88353866799918,-35.88291387799926,-35.88241633399921,-35.88142055999928,-35.88088807699923,-35.8796141209992,-35.87836493399914,-35.87725755099925,-35.87580218799926,-35.87507320299915,-35.87467275099914,-35.87459045199909,-35.87419400699928,-35.87409152899919,-35.87358868599911,-35.8729020229991,-35.87143727699923,-35.87054074499923,-35.86914449499918,-35.86813553299909,-35.86775746499918,-35.86715801599922,-35.86678580199924,-35.86578786199916,-35.8649975969993,-35.8637528209991,-35.86341811999917,-35.86292918899912,-35.86237455299915,-35.86126245999922,-35.86074743499925,-35.85978368099922,-35.85876822099915,-35.8572446619992,-35.85656461199915,-35.85628475899908,-35.85575595499915,-35.8556340539991,-35.85551050699918,-35.85478936099926,-35.85457688099926,-35.85419787099917,-35.85324033899924,-35.85307357699929,-35.85250780399923,-35.85171401599924,-35.85077668999924,-35.84989653699918,-35.84895205199918,-35.84836841699927,-35.84787548799916,-35.84698199099925,-35.84626987099915,-35.84588942399913,-35.84496985799929,-35.84416388499915,-35.84338328399924,-35.84252559099926,-35.84135379399913,-35.84050884599929,-35.8399747579993,-35.83965815199922,-35.83900916199922,-35.8385376959991,-35.83770749099914,-35.83730360799922,-35.83630654799922,-35.83527517499908,-35.83426353399913,-35.83332940499925,-35.83321277499916,-35.8320655619992,-35.82957874199926,-35.82801658899927,-35.8260956399991,-35.8263517479992,-35.82587523599911,-35.82470469299908,-35.82326983899919,-35.82104868499916,-35.81790514699929,-35.81758236199914,-35.8176213289992,-35.81723849599925,-35.81660967099923,-35.81613405799919,-35.81494803799921,-35.81385101999923,-35.8120662479992,-35.81121713199926,-35.81080027899919,-35.81006372599929,-35.80949320099925,-35.80882765999925,-35.80762660999912,-35.80721424799926,-35.80612114499923,-35.80452763499908,-35.80358588199913,-35.80255524399927,-35.80151369899912,-35.80035123099928,-35.79932039799921,-35.79853169299926,-35.79792461599917,-35.7972190409991,-35.79671090799922,-35.79564882599909,-35.79465921999923,-35.79351371599917,-35.79311631499919,-35.79162864699928,-35.79028248499924,-35.78973017299922,-35.78844150699921,-35.78671160699922,-35.78552059499925,-35.7846625859992,-35.78306425199924,-35.78178753599921,-35.78052707799923,-35.7792825019991,-35.77767043899926,-35.77702395699924,-35.7753066599992,-35.77327168399927,-35.77187815199913,-35.77078918399926,-35.76996407299926,-35.76895263299927,-35.76821321799928,-35.76768413399923,-35.76650748999927,-35.76557965799921,-35.7638119639992,-35.76329203299922,-35.76266917399908,-35.76174587699922,-35.7603806339991,-35.75944031899921,-35.75856901799914,-35.75793721999924,-35.75739423899918,-35.75656860499924,-35.75609154699923,-35.75518966999915,-35.75509964199917,-35.75191880299929,-35.75130395599927,-35.75102158299926,-35.75148408999927,-35.75133912799919,-35.74849119399912,-35.74609923099929,-35.74424038199915,-35.74067758399925,-35.73948541699924,-35.73733583299926,-35.73705860799924,-35.73573758199924,-35.73369633199927,-35.73046731299922,-35.72842151999926,-35.72480424199915,-35.72278782199916,-35.72191037399915,-35.72060078299926,-35.71923901099917,-35.71793439999912,-35.71723204699924,-35.71587376299912,-35.71573567899921,-35.71539373499925,-35.71496155899921,-35.72019157199919,-35.72142794699911,-35.72249881699928,-35.72321262299915,-35.72425837199923,-35.72556913799924,-35.72677963899927,-35.72763485199911,-35.72908757699923,-35.72990729899911,-35.73104874099911,-35.73138002399926,-35.7318977039991,-35.73160149399922,-35.73387296299921,-35.73712639399926,-35.73868770899923,-35.74063605099926,-35.74237782499914,-35.74350410699927,-35.74692383799915,-35.74753521599927,-35.74799307999925,-35.74943415799917,-35.75018305799912,-35.75284963599927,-35.75420281399914,-35.7575247389992,-35.75904659499921,-35.75976083099914,-35.76064944499924,-35.76123382699924,-35.76145798199923,-35.76095842999924,-35.75927064299922,-35.7535445609992,-35.75120361299923,-35.75105195499928,-35.75129933699922,-35.75093760999911,-35.75107784299924,-35.75093209899919,-35.7505268959991,-35.74952970799923,-35.74908892099922,-35.74828203399918,-35.74767522799917,-35.7465939249992,-35.74552516499909,-35.74423715899925,-35.7431532749991,-35.74192273699921,-35.74114002299926,-35.7405351279992,-35.73831096399913,-35.73646959599912,-35.7350045149992,-35.73405296999913,-35.73217374899921,-35.73016612599925,-35.7283901959992,-35.72770364899927,-35.72616778099923,-35.72527420799925,-35.72504621499921,-35.72421331999919,-35.72323735699923,-35.72259914299922,-35.72175836599918,-35.7209707529992,-35.7195145419992,-35.71871742899928,-35.71899725199922,-35.71948123099926,-35.7198689369991,-35.71986887999923,-35.7197528169992,-35.7190624849991,-35.71824594199921,-35.7180443809992,-35.71721484299925,-35.71620646199912,-35.71555362599924,-35.71489182299923,-35.71401211499916,-35.71401904799923,-35.71332235499915,-35.71262957599922,-35.71209876699919,-35.71172791499922,-35.71143748099927,-35.71093724899924,-35.71046998699926,-35.71028114399924,-35.70965743699924,-35.70935207299912,-35.70881110099926,-35.70794512499923,-35.70741542799911,-35.70644887399909,-35.7061934499991,-35.70573949099928,-35.70513350199928,-35.70458959899921,-35.70414024399926,-35.70377849799925,-35.70342536899911,-35.7028736479992,-35.70235681599923,-35.70167209099921,-35.70102842999928,-35.70026700099913,-35.69960684599911,-35.6987708309991,-35.6978072319991,-35.69718196299912,-35.6964939119991,-35.69586600699914,-35.69526995699912,-35.69471739399921,-35.69332100699921,-35.69274418399909,-35.69220963999916,-35.69174060899924,-35.69127917499917,-35.69083634199924,-35.69012790799917,-35.68964612599925,-35.68932592099922,-35.68881826199924,-35.68803257499928,-35.68743933599926,-35.68678934699916,-35.68614186199916,-35.68571022899908,-35.68510868699924,-35.68413585499925,-35.68359831499922,-35.68265697399911,-35.68144854999925,-35.68042616999918,-35.67966264599914,-35.67918775099925,-35.67838710599916,-35.67762227199918,-35.67710561999925,-35.67614751299911,-35.67539839899925,-35.67412399799929,-35.67324894599914,-35.67245205899927,-35.67168255199914,-35.67094405199919,-35.66998287699909,-35.66877512899921,-35.66795947599928,-35.66697883399922,-35.66659568199926,-35.66593043499925,-35.66527204799924,-35.66483244999914,-35.66423931299913,-35.66349851399927,-35.66280657299929,-35.66209512499917,-35.6610575129991,-35.66009612399911,-35.65931982199917,-35.65975573999928,-35.66058947099922,-35.66043970699922,-35.65852139999922,-35.65788301999915,-35.65739256499926,-35.65711851399915,-35.6568471499992,-35.65629125699924,-35.65611456899921,-35.65581756899925,-35.65597952599926,-35.65597699999925,-35.65594602099926,-35.65583234299916,-35.65579806599909,-35.65581662699928,-35.65562655299914,-35.65550157999926,-35.65509450199912,-35.65425990599912,-35.65369062999923,-35.65197203899914,-35.65077230999922,-35.65004651599926,-35.64973922399921,-35.64987377999925,-35.6495345029992,-35.64862535199924,-35.64797254899918,-35.6474126479991,-35.64689685399926,-35.64587306699921,-35.64626194399917,-35.64585781899924,-35.64485971399915,-35.64335440899926,-35.64237733999909,-35.64123518399928,-35.64066080299914,-35.64003358099919,-35.63657109399928,-35.63645436899923,-35.63300222299918,-35.63082713899923,-35.63025552899928,-35.62986940699916,-35.62851032999922,-35.6273861659993,-35.62619678999911,-35.62598948099919,-35.62499309999924,-35.62373889999925,-35.6226154429992,-35.62172691299922,-35.62033674499925,-35.6183019749992,-35.61762134899911,-35.61619677499909,-35.61479889799917,-35.61342781799912,-35.61166519299918,-35.61071313099919,-35.61006097099918,-35.60944218399916,-35.60815145899912,-35.60715160199917,-35.60633494299919,-35.60536075099927,-35.60426195199915,-35.60330584699909,-35.60275200099914,-35.60263078999924,-35.6020616289991,-35.60139813399925,-35.60034242899928,-35.5994869239992,-35.59856462099925,-35.59799936799917,-35.59757041299927,-35.59734051999916,-35.59662841099924,-35.59606021499928,-35.59540631099919,-35.59342753599921,-35.59208501199923,-35.59061669199927,-35.58912964199913,-35.58833975399909,-35.58781651399912,-35.58734664399927,-35.58640535799922,-35.58610580799925,-35.58509652099924,-35.58455431899915,-35.58363197899919,-35.58247388199917,-35.58198717599924,-35.58162356499919,-35.58125310499926,-35.58029639299927,-35.57923725499924,-35.57858709099921,-35.5778383499992,-35.57725393499916,-35.57648930899921,-35.57350279799915,-35.5708630449992,-35.5692603569992,-35.56821838299916,-35.56779797799908,-35.56353134699921,-35.55851972699922,-35.5571184219992,-35.55641415699909,-35.55507430199924,-35.55448122699916,-35.55315388599927,-35.55194775799919,-35.5505984899992,-35.54887520599913,-35.5473458969992,-35.54558047199922,-35.54438710399917,-35.54369255499928,-35.54262281199909,-35.54200013499927,-35.54034712799919,-35.53814046299916,-35.53699280899921,-35.53605393299917,-35.53444893399921,-35.53313581699921,-35.53131945199915,-35.52985213099924,-35.52936668699916,-35.52891152399918,-35.52821521599921,-35.52666347699912,-35.52497974799925,-35.52345944899918,-35.52158459299911,-35.5201842889991,-35.51870049499927,-35.51684005399914,-35.51533649699925,-35.51445272099914,-35.51342420599921,-35.5120177359992,-35.51090102899922,-35.50827805199928,-35.50706752299912,-35.50650559799909,-35.50526959399928,-35.50315024299918,-35.50140386499915,-35.49963531899908,-35.49791242499924,-35.49658358999916,-35.49549900999914,-35.49356858099925,-35.49187460599924,-35.49089657499923,-35.48971421899913,-35.48878216799914,-35.48792718399913,-35.4878617389993,-35.4873645199992,-35.48666706499918,-35.48643841999918,-35.48614536099928,-35.48563350099914,-35.48502318499912,-35.48380158799914,-35.48263524899911,-35.48145375399928,-35.48006057899909,-35.47854494499917,-35.47704265599921,-35.47560636499919,-35.47432627899926,-35.4724698339992,-35.47119540699926,-35.47043756699922,-35.46894778199916,-35.46718130899924,-35.46549389899919,-35.46490944099922,-35.46384065299926,-35.46347698099918,-35.46239105299917,-35.46089121299921,-35.46027576099917,-35.45921981099925,-35.45769362599918,-35.45605803999926,-35.45488737499911,-35.45406694099923,-35.45283890099925,-35.45164346499919,-35.44949752699916,-35.44770669899921,-35.44696839599911,-35.44608353399923,-35.4441168029991,-35.44183468299921,-35.44004188899915,-35.43755516999914,-35.43521392199911,-35.43333959299921,-35.43272738499927,-35.43237354699911,-35.43157062999927,-35.43036843799923,-35.42901183199921,-35.42756577099912,-35.42691895799915,-35.42649518899927,-35.42596911799919,-35.42483879299918,-35.42319817899914,-35.4220906769992,-35.42106293299919,-35.4196258089992,-35.41800601399919,-35.41703009999922,-35.41565014799915,-35.41477759399908,-35.41412710899912,-35.41279071499928,-35.41068191399918,-35.40891074499917,-35.4085594619992,-35.40822137799925,-35.4079161639992,-35.40739130399907,-35.40709863799928,-35.40663692799924,-35.40597774499919,-35.4049510279992,-35.4038517579992,-35.40246284299918,-35.40147116199926,-35.40014224699918,-35.3985068729992,-35.39645906199924,-35.39441784799914,-35.39300313399924,-35.39171731399913,-35.39024102599928,-35.38972144399924,-35.38934814899912,-35.38882023799908,-35.38700583399918,-35.38511047899909,-35.38405637299928,-35.38296406699914,-35.38245463399912,-35.38159541699922,-35.38066531499915,-35.37992633699927,-35.37929617099928,-35.37891415799913,-35.37768588999922,-35.37620392199915,-35.37522370599915,-35.37404301099927,-35.37230871699922,-35.37032872699924,-35.36938106199909,-35.36835520799927,-35.36747513099909,-35.36610508599908,-35.36515564499926,-35.36469070499918,-35.36319191399924,-35.36260992799921,-35.36168466599921,-35.36028099899915,-35.35897177799919,-35.3584139519992,-35.35681882699919,-35.35566292599918,-35.35429302699922,-35.35338854899908,-35.35037033699918,-35.34814979399911,-35.34639115899912,-35.34586444799915,-35.34365021199915,-35.34193213599919,-35.33912216899908,-35.33815824899909,-35.33648757999923,-35.3338278519992,-35.33208978599922,-35.3304816529991,-35.32917480299916,-35.32656132299918,-35.32562405799924,-35.32434496999923,-35.32177136699913,-35.31981959699907,-35.31806063699921,-35.31676805399925,-35.3146959789992,-35.31162456199927,-35.3109380739992,-35.31040263999913,-35.30978644399913,-35.30810896099924,-35.30744900299911,-35.14208435099913,-35.14144307599923,-35.14066128899923,-35.13873714199918,-35.13802321499922,-35.1367419829992,-35.13522351999919,-35.13318326999927,-35.13213088399912,-35.13101690699916,-35.13110899099924,-35.13067992599923,-35.13018995299925,-35.12970598499911,-35.12771159299917,-35.12753856699913,-35.12624695499909,-35.12647860099919,-35.1261109659991,-35.12652743399926,-35.12441580299917,-35.12485897599922,-35.12532263999918,-35.12562207199907,-35.1261816099991,-35.12635843399909,-35.12748755999926,-35.12710725999914,-35.12852389799922,-35.12725624799925,-35.12798326799922,-35.12890157999917,-35.13039283999924,-35.13248727299925,-35.13478973499922,-35.13494038799924,-35.13581144699928,-35.13527261099914,-35.13536182599917,-35.13442884599912,-35.13515666499926,-35.13598604299913,-35.13720093599914,-35.13712964299918,-35.13840591599922,-35.13937883699926,-35.14182461599921,-35.14287929099913,-35.14382600199919,-35.14455274299927,-35.14486305799908,-35.14475630999915,-35.14503314299925,-35.14509259799925,-35.14443350399914,-35.14438251399923,-35.14374668499909,-35.14372969199923,-35.14436161399911,-35.1444316379992,-35.14390989999917,-35.14292488099913,-35.14208550799923,-35.14159992499926,-35.14198895999912,-35.14156543499921,-35.14188442599908,-35.14190470499911,-35.14364804299919,-35.14401005099918,-35.14523553799923,-35.14565993499925,-35.14676535299926,-35.14744853999923,-35.14859409999923,-35.14963202299928,-35.15014038699924,-35.15070752899917,-35.15150235199918,-35.15283258599907,-35.15376382599911,-35.15424978299919,-35.15465044299924,-35.15527919699919,-35.15674999599927,-35.1575563819991,-35.15824033899923,-35.15975187399914,-35.16021604599925,-35.15967613299915,-35.15880045899925,-35.15840486899916,-35.15859122099917,-35.15958316999918,-35.15834878899911,-35.1582468129991,-35.15929033399908,-35.15883169899917,-35.16001550599918,-35.16098705799915,-35.16112177899923,-35.1655237369991,-35.16702581199927,-35.1699853469992,-35.17295388199909,-35.17343458399916,-35.17566878499922,-35.1769523099991,-35.17790044999923,-35.17824962899915,-35.17925525299921,-35.17990087699923,-35.1809355829992,-35.18139701699909,-35.18286748299911,-35.18454851699912,-35.18536831299918,-35.18604866399909,-35.18745582499925,-35.18844681499925,-35.19094179099915,-35.19363680099921,-35.1940453339992,-35.19435200299912,-35.19708103999915,-35.19850407099914,-35.20012669399913,-35.20073994999925,-35.20332373999918,-35.20253504299922,-35.20236400599919,-35.20253621499918,-35.20290209599914,-35.20495492699927,-35.20635630099926,-35.20895240599922,-35.21156709499918,-35.21185162499924,-35.21151167499912,-35.21305883599924,-35.21604777399915,-35.21626836199908,-35.21744548399911,-35.21986306599923,-35.22462590099921,-35.22614968099926,-35.22668986299914,-35.2291003719991,-35.22649091599912,-35.22512901699924,-35.22212199799929,-35.22028483699923,-35.21960578599912,-35.21974920299915,-35.22070643699917,-35.21913550099926,-35.21936653099911,-35.21931259499922,-35.21984389599906,-35.22168731399923,-35.22200219499923,-35.22100322199921,-35.22156141999917,-35.22236341099914,-35.22222754099911,-35.22313857099914,-35.22504624799924,-35.22534448999913,-35.22546613199921,-35.22672270799924,-35.22726461499925,-35.22797922299925,-35.22915044599915,-35.22986869699923,-35.23071522099927,-35.23137131899914,-35.23133004199923,-35.23166674399916,-35.23213562799922,-35.23286734299919,-35.23363617399919,-35.23503186799928,-35.23675520099916,-35.23790993499912,-35.23834816599919,-35.23890982099913,-35.23974099299912,-35.24046959999918,-35.24279154999911,-35.24341933299925,-35.24329496699911,-35.24357155899926,-35.24581098699925,-35.24635964699921,-35.24612073999918,-35.24641104299924,-35.24737888299916,-35.24652736799917,-35.2471832559992,-35.24798683299922,-35.24935425599912,-35.25073350999924,-35.25224013699915,-35.25223064599915,-35.25363987499923,-35.25537892599914,-35.2563449919992,-35.25720287899926,-35.25734804999924,-35.25692020899913,-35.25739456299917,-35.25852072899912,-35.25943868199914,-35.25877688799918,-35.25915500699912,-35.25902579099917,-35.25917892299918,-35.25993686199922,-35.26048873799916,-35.26123826599922,-35.26183021499928,-35.26264886299924,-35.26321372599909,-35.26422230899908,-35.26610162699928,-35.26696491999923,-35.2672893199992,-35.26942852899921,-35.27013756399925,-35.27080469299916,-35.27191640099915,-35.27348513699918,-35.27339399999914,-35.27491731599927,-35.27505122299913,-35.2738012839991,-35.27308171399915,-35.27133766499924,-35.27075161199926,-35.27065137499916,-35.27106063599923,-35.2709939319992,-35.27205899299919,-35.27163048999918,-35.27296252599923,-35.27412805799927,-35.2752466919991,-35.2756984659991,-35.27424718399912,-35.27419456399927,-35.27355243599914,-35.27242858799924,-35.27276524199915,-35.2721566089992,-35.27217245799907,-35.2728455349991,-35.2728940759991,-35.2732302829992,-35.27390507299918,-35.2741092119992,-35.27337703099909,-35.27399306299922,-35.27450111099909,-35.27553214399926,-35.27654468699924,-35.27620650699923,-35.27826866099927,-35.27752501999917,-35.27658763199922,-35.27596575099911,-35.27623092799922,-35.27867014299915,-35.27944763899918,-35.28055696299921,-35.28178797799921,-35.2819600469992,-35.28282389299914,-35.28380857299915,-35.28394285299908,-35.2844076459992,-35.28521991599923,-35.28578704299925,-35.28674025499926,-35.28641397999919,-35.28638826799914,-35.28438654399919,-35.28346146799923,-35.28242945499915,-35.28240191899914,-35.2831627649991,-35.28443146099917,-35.28453032199921,-35.2851894719992,-35.28535436899909,-35.28630250299909,-35.28697651799921,-35.2873824439991,-35.28841376799912,-35.28873722499924,-35.28787298099922,-35.28697053699909,-35.28630021699924,-35.28670283399922,-35.28896061699908,-35.2901867329992,-35.29204775199918,-35.29220586799917,-35.29187049999923,-35.29158712199924,-35.29206938999913,-35.29286197499916,-35.29347941399911,-35.29443568799927,-35.2944037919992,-35.29595193199917,-35.29670825399923,-35.29726248299914,-35.29816555299915,-35.29876249399924,-35.29935812699912,-35.29987419099928,-35.29973125999918,-35.2996534099992,-35.3005963389992,-35.30081373799915,-35.30158699199919,-35.30160505899914,-35.30308925599927,-35.30429347099917,-35.30595490299911,-35.30753821199917,-35.30902478299927,-35.30864322099919,-35.30852603199921,-35.30802174699909,-35.30826316499923,-35.30676051399922,-35.30481251899913,-35.30511844699922,-35.30488601599919,-35.30512617499912,-35.30571558799917,-35.30569126499925,-35.30626570999915,-35.30647064699919,-35.30434864499917,-35.30341760799922,-35.30360897099929,-35.3026975249991,-35.30345507699922,-35.30292391499919,-35.30318870799916,-35.30403512799926,-35.30465238199921,-35.30558806899919,-35.30655807899923,-35.30731182799921,-35.30919108399922,-35.30967958099922,-35.31100300099921,-35.31353871299921,-35.31418174999909,-35.31596911599927,-35.31731323599924,-35.3185843069992,-35.31908967799921,-35.32061539499914,-35.32194773599922,-35.32335605799909,-35.32425047799927,-35.32525183499924,-35.32572456799917,-35.32611629299927,-35.32685117499916,-35.32698094499914,-35.32726661399914,-35.32747812999924,-35.32759906499918,-35.32772561499924,-35.32782424699919,-35.32790032299911,-35.32799468699908,-35.3281244079992,-35.32841616699915,-35.32865159999914,-35.3286798539992,-35.32883819799921,-35.32938086199917,-35.32982725599913,-35.32997009099925,-35.33011259399927,-35.33023973599924,-35.33036572799912,-35.33048982699924,-35.33058247399927,-35.33069974399919,-35.33080957799926,-35.33091197499914,-35.33105618699914,-35.33114511899925,-35.33122455599911,-35.33130415699921,-35.33138029699924,-35.33144766099923,-35.33150725799915,-35.33155841199911,-35.33158517299924,-35.33184401099908,-35.33189298199908,-35.33194296399913,-35.3319982759992,-35.33206175199926,-35.33213573899928,-35.33221422699926,-35.33229755599928,-35.33238588199924,-35.3325156639992,-35.33409217799915,-35.33714387399917,-35.33728475799919,-35.33737853399923,-35.3374656519991,-35.33758203499922,-35.33766007699921,-35.33773600699911,-35.33780820699924,-35.33789794199924,-35.33804985299927,-35.33822857799922,-35.33840975299918,-35.3385256789991,-35.33849435699916,-35.33857281799909,-35.33940912599927,-35.33946237499922,-35.33952071499908,-35.33958381999918,-35.33965728699921,-35.33974028999921,-35.33982773199916,-35.3399224059992,-35.34000367399916,-35.34015675599914,-35.34028544999927,-35.34045859599922,-35.34068435299922,-35.34082549399908,-35.34093118599922,-35.34108286899919,-35.34134864999908,-35.34142778299927,-35.34151389099928,-35.34168418699915,-35.34185698199927,-35.34203085599921,-35.34220648699915,-35.34238400899915,-35.34256257899915,-35.34274337699919,-35.34292505199916,-35.34310855299919,-35.34329350299921,-35.34333294799927,-35.34381212999909,-35.34514278099913,-35.34532797599921,-35.34641424599913,-35.34649685999911,-35.34658722299924,-35.34683811099921,-35.34689639999908,-35.34709832199923,-35.34728984699921,-35.34736244299924,-35.34765456899909,-35.34773170399924,-35.34786191799926,-35.34797327499925,-35.34810602799927,-35.34823256699917,-35.34827326799929,-35.34831042099928,-35.34833651599923,-35.34839084899907,-35.34841358299926,-35.34840441999926,-35.3483432169992,-35.3482268619991,-35.34822083099908,-35.34825614499916,-35.34826147099913,-35.34827975199913,-35.34832234899915,-35.34835525199927,-35.34841949999919,-35.34849338999913,-35.34854876299912,-35.34857958699924,-35.34869100599918,-35.34883831699918,-35.34910144199917,-35.34944982199907,-35.34958811899926,-35.34972658899909,-35.34993261899919,-35.35004640499915,-35.35015428499927,-35.35025444699917,-35.35036864999925,-35.35043994399927,-35.35050705099923,-35.35056751099923,-35.3506176579992,-35.35064910899923,-35.35071355799912,-35.35125066999925,-35.35125911499916,-35.35126176699922,-35.35126242899926,-35.35126127099912,-35.35125450099918,-35.35123666999909,-35.35120812899918,-35.35116632099916,-35.35107804399919,-35.35101848299927,-35.3509497889992,-35.35091578699928,-35.35085853199924,-35.35076595499907,-35.3506733859992,-35.35057796299926,-35.35047759299911,-35.35036523399924,-35.35024049399915,-35.34722405199913,-35.34613601699911,-35.34508998699916,-35.34492356199924,-35.3447868459992,-35.34464334099911,-35.34449527399909,-35.34434136699928,-35.34423304999922,-35.34406875499925,-35.3439030719991,-35.3437328559992,-35.34356062799925,-35.34338518899909,-35.34334543199918,-35.34261613999928,-35.34223475199927,-35.34166677999926,-35.34150727799909,-35.34135118099909,-35.34120228899927,-35.3410586499992,-35.3409176939992,-35.34087512499927,-35.34074348199913,-35.34061786999924,-35.34049555599919,-35.34037985299913,-35.34027391399921,-35.3401793169992,-35.34009018099912,-35.34005202699918,-35.33996870999917,-35.3398906259991,-35.33983605199921,-35.33978103999912,-35.33972688899924,-35.3396871499992,-35.33966741799921,-35.33858240499922,-35.33823255199927,-35.33805455899915,-35.33796020999915,-35.33811922899926,-35.33776107899921,-35.33720103799909,-35.33714765099919,-35.33700419699916,-35.33695759499917,-35.3367813029992,-35.33673747299922,-35.3362611389991,-35.33615813599912,-35.33604018999909,-35.33596110899921,-35.33586682699927,-35.33585403199918,-35.33584014999926,-35.33586428099917,-35.33585072599909,-35.33576010199909,-35.33574816499924,-35.33583878899924,-35.33582359399924,-35.33579418399918,-35.3357959139993,-35.33578345899927,-35.33575414299921,-35.33570921399923,-35.33567913299914,-35.33559173199924,-35.33549112599925,-35.33538890099913,-35.3352790529992,-35.33515598699925,-35.33512228699909,-35.33471049599921,-35.33415360599923,-35.33369220199926,-35.33351325699915,-35.33331110499927,-35.33317070399909,-35.33311521299913,-35.3330703399991,-35.33303411399912,-35.33300779799919,-35.33300218799929,-35.3330190839991,-35.33302668699925,-35.33307411199919,-35.33305149299927,-35.33306265399914]}]]],null,"ACT",{"interactive":true,"className":"","stroke":true,"color":"lightblue","weight":1,"opacity":0.5,"fill":true,"fillColor":"lightblue","fillOpacity":0.3,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[[-35.46,-35.32,-35.17,-35.17,-35.19,-35.16,-35.22,-35.19,-35.26,-35.16,-35.71,-35.43,-35.18,-35.46,-35.82,-35.42,-35.24,-35.18,-35.38,-35.18,-35.49,-35.44,-35.48,-35.41,-35.32,-35.18,-35.43,-35.33,-35.42,-35.34,-35.19,-35.42,-35.15,-35.17,-35.62,-35.46,-35.69,-35.42,-35.82,-35.31,-35.32,-35.45,-35.17,-35.42,-35.68,-35.62,-35.48,-35.51,-35.34,-35.44,-35.34,-35.42,-35.77,-35.79,-35.38,-35.41,-35.85,-35.13,-35.44,-35.18,-35.3,-35.25,-35.45,-35.41,-35.45,-35.2,-35.31,-35.32,-35.58,-35.2,-35.43,-35.49,-35.7,-35.35,-35.43,-35.42,-35.62,-35.45,-35.4,-35.19,-35.29,-35.76,-35.3,-35.86,-35.27,-35.2,-35.27,-35.3,-35.56,-35.3,-35.65,-35.56,-35.29,-35.6,-35.54,-35.51,-35.33,-35.42,-35.29,-35.58,-35.4,-35.18,-35.69,-35.44,-35.43,-35.41,-35.19,-35.5,-35.4,-35.63,-35.31,-35.15,-35.18,-35.31,-35.16,-35.83,-35.67,-35.42,-35.7,-35.62,-35.16,-35.87,-35.49,-35.57,-35.16,-35.32,-35.18,-35.18,-35.85,-35.83,-35.45,-35.33,-35.82,-35.8,-35.77,-35.62,-35.33,-35.33,-35.33,-35.38,-35.29,-35.24,-35.41,-35.49,-35.45,-35.26,-35.38,-35.36,-35.34,-35.37,-35.26,-35.32,-35.28,-35.4,-35.21,-35.28,-35.38,-35.24,-35.37,-35.3,-35.32,-35.39,-35.33,-35.34,-35.28,-35.4,-35.38,-35.39,-35.21,-35.26,-35.22,-35.26,-35.38,-35.29,-35.37,-35.22,-35.35,-35.34,-35.25,-35.25,-35.24,-35.48,-35.23,-35.33,-35.31,-35.26,-35.38,-35.37,-35.34,-35.32,-35.37,-35.25,-35.27,-35.33,-35.33,-35.33,-35.34,-35.35,-35.36,-35.34,-35.27,-35.34,-35.25,-35.4,-35.36,-35.35,-35.53,-35.36,-35.25,-35.37,-35.35,-35.26,-35.28,-35.44,-35.29,-35.26,-35.26,-35.35,-35.4,-35.21,-35.8,-35.27,-35.36,-35.33,-35.31,-35.33,-35.27,-35.39,-35.23,-35.38,-35.36,-35.24,-35.3,-35.38,-35.31,-35.37,-35.29,-35.21,-35.79,-35.29,-35.34,-35.29,-35.22,-35.2,-35.27,-35.22,-35.37,-35.36,-35.31,-35.24,-35.39,-35.25,-35.2,-35.26,-35.58,-35.3,-35.26,-35.39,-35.39,-35.32,-35.31,-35.21,-35.53,-35.29,-35.33,-35.31,-35.32,-35.33,-35.38,-35.23,-35.25,-35.2,-35.23,-35.31,-35.39,-35.4,-35.32,-35.28,-35.32,-35.31,-35.39,-35.22,-35.36,-35.25,-35.75,-35.21,-35.6,-35.22,-35.32,-35.23,-35.31,-35.31,-35.33,-35.27,-35.32,-35.21,-35.3,-35.24,-35.31,-35.23,-35.37,-35.21,-35.32,-35.25,-35.35,-35.23,-35.55,-35.36,-35.35,-35.22,-35.27,-35.23,-35.22,-35.28,-35.3,-35.35,-35.33,-35.25,-35.34,-35.37,-35.3,-35.21,-35.33,-35.3,-35.33,-35.26,-35.25,-35.27,-35.21,-35.29,-35.35,-35.26,-35.33,-35.39,-35.28,-35.28,-35.38,-35.37,-35.3,-35.37,-35.26,-35.38,-35.24,-35.26,-35.35,-35.21,-35.26,-35.27,-35.39,-35.56,-35.35,-35.34,-35.36,-35.35,-35.2,-35.51,-35.28,-35.21,-35.21,-35.2,-35.31,-35.21,-35.35,-35.37,-35.26,-35.26,-35.27,-35.36,-35.22,-35.26,-35.22,-35.37,-35.27,-35.22,-35.34,-35.23,-35.31,-35.23,-35.21,-35.29,-35.74,-35.2,-35.25,-35.23,-35.28,-35.21,-35.22,-35.26,-35.39,-35.31,-35.28,-35.23,-35.38,-35.21,-35.28,-35.22,-35.28,-35.23,-35.26,-35.57,-35.3,-35.29,-35.26,-35.36,-35.32,-35.4,-35.38,-35.2,-35.2,-35.24,-35.44,-35.38,-35.32,-35.32,-35.22,-35.35,-35.53,-35.28,-35.39,-35.31,-35.36,-35.27,-35.37,-35.39,-35.21,-35.2,-35.31,-35.51,-35.24,-35.36,-35.39,-35.34,-35.26,-35.52,-35.29,-35.54,-35.52,-35.24,-35.25,-35.4,-35.59,-35.25,-35.32,-35.31,-35.2,-35.49,-35.5,-35.34,-35.28,-35.4,-35.55,-35.3,-35.37,-35.35,-35.3,-35.3,-35.43,-35.69,-35.39,-35.24,-35.21,-35.27,-35.4,-35.32,-35.25,-35.28,-35.69,-35.24,-35.27,-35.23,-35.6,-35.24,-35.36,-35.53,-35.44,-35.22,-35.28,-35.25,-35.77,-35.29,-35.29,-35.37,-35.29,-35.52,-35.21,-35.44,-35.39,-35.24,-35.27,-35.53,-35.44,-35.31,-35.33,-35.21,-35.78,-35.32,-35.27,-35.27,-35.3,-35.3,-35.34,-35.36,-35.53,-35.34,-35.28,-35.28,-35.28,-35.46,-35.39,-35.35,-35.24,-35.27,-35.35,-35.39,-35.31,-35.49,-35.19,-35.34,-35.65,-35.29,-35.54,-35.24,-35.36,-35.32,-35.5,-35.37,-35.25,-35.53,-35.53,-35.25,-35.46,-35.37,-35.8,-35.23,-35.3,-35.76,-35.39,-35.4,-35.23,-35.53,-35.57,-35.38,-35.2,-35.49,-35.36,-35.22,-35.3,-35.2,-35.31,-35.57,-35.33,-35.3,-35.17,-35.24,-35.25,-35.24,-35.66,-35.69,-35.45,-35.66,-35.4,-35.38,-35.33,-35.41,-35.15,-35.36,-35.23,-35.3,-35.35,-35.47,-35.7,-35.55,-35.35,-35.34,-35.36,-35.4,-35.7,-35.43,-35.58,-35.34,-35.26,-35.17,-35.74,-35.54,-35.26,-35.59,-35.42,-35.41,-35.48,-35.34,-35.17,-35.39,-35.19,-35.37,-35.29,-35.48,-35.52,-35.55,-35.44,-35.53,-35.33,-35.33,-35.18,-35.46,-35.4,-35.43,-35.41,-35.42,-35.25,-35.32,-35.57,-35.23,-35.45,-35.76,-35.37,-35.25,-35.39,-35.29,-35.32,-35.45,-35.31,-35.31,-35.32,-35.19,-35.53,-35.39,-35.89,-35.53,-35.19,-35.69,-35.89,-35.87,-35.65,-35.74,-35.33,-35.34,-35.37,-35.53,-35.28,-35.71,-35.58,-35.29,-35.31,-35.55,-35.65,-35.66,-35.42,-35.45,-35.4,-35.52,-35.26,-35.53,-35.68,-35.62,-35.46,-35.19,-35.35,-35.32,-35.8,-35.33,-35.44,-35.71,-35.38,-35.28,-35.23,-35.55,-35.43,-35.54,-35.34,-35.21,-35.32,-35.44,-35.73,-35.8,-35.67,-35.3,-35.35,-35.34,-35.35,-35.24,-35.36,-35.34,-35.35,-35.38,-35.17,-35.38,-35.37,-35.62,-35.29,-35.61,-35.41,-35.88,-35.34,-35.9,-35.35,-35.4,-35.44,-35.6,-35.49,-35.82,-35.45,-35.63,-35.53,-35.55,-35.32,-35.22,-35.31,-35.49,-35.19,-35.15,-35.44,-35.88,-35.57,-35.33,-35.8,-35.47,-35.41,-35.4,-35.33,-35.32,-35.33,-35.21,-35.47,-35.24,-35.3,-35.34,-35.52,-35.33,-35.87,-35.47,-35.67,-35.67,-35.59,-35.23,-35.27,-35.35,-35.77,-35.85,-35.86,-35.42,-35.34,-35.17,-35.85,-35.56,-35.5,-35.34,-35.46,-35.5,-35.86,-35.5,-35.62,-35.32,-35.42,-35.24,-35.72,-35.44,-35.26,-35.14,-35.29,-35.37,-35.63,-35.41,-35.53,-35.45,-35.53,-35.24,-35.44,-35.17,-35.77,-35.83,-35.55,-35.51,-35.45,-35.71,-35.23,-35.83,-35.31,-35.46,-35.44,-35.4,-35.83,-35.27,-35.52,-35.58,-35.69,-35.24,-35.7,-35.57,-35.56,-35.74,-35.29,-35.57,-35.3,-35.58,-35.34,-35.75,-35.33,-35.74,-35.65,-35.88,-35.56,-35.56,-35.35,-35.68,-35.66,-35.56,-35.5,-35.64,-35.32,-35.42,-35.53,-35.23,-35.67,-35.71,-35.63,-35.49,-35.54,-35.32,-35.52,-35.26,-35.87,-35.54,-35.51,-35.88,-35.78,-35.25,-35.45,-35.29,-35.47,-35.18,-35.65,-35.17,-35.48,-35.82,-35.48,-35.52,-35.81,-35.58,-35.56,-35.7,-35.67,-35.36,-35.86,-35.19,-35.72,-35.41,-35.28,-35.73,-35.33,-35.72,-35.78,-35.54,-35.46,-35.82,-35.83,-35.69,-35.3,-35.85,-35.33,-35.86,-35.33,-35.53,-35.4,-35.33,-35.79,-35.33,-35.57,-35.41,-35.16,-35.31,-35.4,-35.29,-35.54,-35.77,-35.44,-35.48,-35.17,-35.35,-35.44,-35.28,-35.41,-35.26,-35.66,-35.43,-35.46,-35.59,-35.68,-35.32,-35.29,-35.53,-35.61,-35.9,-35.45,-35.33,-35.35,-35.41,-35.55,-35.49,-35.24,-35.37,-35.75,-35.49,-35.25,-35.2,-35.22,-35.41,-35.41,-35.19,-35.16,-35.25,-35.45,-35.75,-35.41,-35.45,-35.58,-35.28,-35.58,-35.75],[149.03,149.19,149.17,149.14,149.12,149.14,149.03,149.11,148.93,149.15,149.08,149.12,149.18,149.08,149.06,149.13,149,149.19,149.15,149.12,148.93,149.07,149.04,149.06,149.21,149.14,149.11,149.2,149.1,149,149.02,149.09,149.14,149.09,148.82,148.98,149.08,149.12,148.96,149.37,149.38,149.09,149.18,149.07,148.84,148.84,148.95,149.14,149.2,149.05,149.22,149.14,148.98,148.97,149.13,149,148.98,149.12,149.09,149.16,148.94,148.98,149.07,148.95,149.1,149.18,149.25,149.22,149.04,149.11,149.1,148.89,148.83,148.93,149.06,148.95,148.83,149.03,148.99,149.08,149.26,149.08,148.97,148.99,149.23,149,149.19,149.07,148.91,149.29,149.07,149.13,149.11,148.88,149.13,149.13,149.01,148.84,148.92,148.99,148.96,149.17,149.04,149.06,149.09,149.04,149.05,149.14,149.06,148.93,149.21,149.15,149.03,148.9,149.08,149.01,148.96,148.81,149.09,149.06,149.11,149,149.09,149.13,149.17,148.94,149.1,149.11,149.04,149.09,149.13,149.02,149.07,148.96,149.08,148.92,149.25,149.13,149.11,149.06,149.12,149.07,148.81,149.06,149.05,149.05,148.96,149.16,149.02,149.12,149.12,149.1,149.11,149.04,149.1,149.09,149.07,149.1,149.02,149.04,148.87,149.08,149.17,149.17,149.12,149.08,149.01,149.05,149.03,149.17,149.08,149.07,149.03,149.1,149.08,149.2,149.13,149.08,149.16,149.12,149.16,148.93,149,149.15,149.18,149.16,149.09,148.88,149.09,149.14,149.05,149.08,149.07,149.05,149.16,149.04,149.1,149.15,149.11,149.04,149.09,149.05,149,149.13,149.03,149.16,148.89,149.04,149.19,149.15,149.11,149.14,149,149.14,149.07,149.09,149,149.1,149.14,149.05,149.06,149.18,149.19,149.14,149.06,149.37,149.04,149.16,149.1,149.11,149.15,149.13,149.01,149.14,149.15,149.1,149.02,149.18,148.95,149.05,149.03,149.01,149.13,149.09,149.1,149.12,149.18,149.1,149.08,149.08,149.13,149.1,149.05,149.19,148.83,149.19,149.15,149.12,149.14,149.2,149,149.06,149,149.19,149.1,149.17,149.16,149.09,149.12,149.01,149.02,149.17,149.08,149.14,149.07,149.1,149.03,149.16,149.08,149.07,149.17,149.15,149.06,149.17,149.03,149.12,148.87,148.97,149.07,149.15,149.12,149.19,149.03,149.13,149.12,149.16,149.05,149.03,149.02,149.11,149.06,149.15,149.09,149.11,149.06,149.2,148.81,149.14,149.08,149.16,149.05,149.19,149.14,148.88,148.93,149.02,149.22,149.05,149.18,149.01,149.11,149,149.07,149.18,149.18,149.2,149.18,149.06,149.13,149.04,149.03,149.04,149.12,149.1,149.03,149.05,149.1,149.11,149.17,149.07,149.01,149,149.15,149.13,149.2,149.11,149.03,149.03,149.03,148.82,149.05,149.13,149.18,149.12,149.03,149.09,149.18,149.19,149.17,149.19,149.04,149.07,149.17,149.19,149.08,149.1,149.14,149.07,149.09,149.11,149.02,149.14,149.11,149.07,149.06,149.16,149.32,149.13,149.01,149.15,148.91,149.01,149.24,149.17,149.02,149.04,149.18,149.02,149.11,149.03,149.17,149.03,149.04,149.14,149.19,149.17,149.04,149.05,148.99,149.06,149.06,149.13,148.96,149.09,149.11,149.15,149.18,149.02,149.14,149.05,148.91,149.08,149.04,149.17,149.1,149.04,148.82,149.08,149.01,149.13,149.08,148.91,149.09,148.82,149.02,149.07,149.16,149.08,149.12,149.13,149.02,149.12,149.06,148.88,149.08,148.87,148.86,149.11,149.15,149.12,148.83,149.13,149.13,149.1,149.16,148.87,148.92,149.21,149.1,149.09,149.02,149.16,149.16,149.01,149.2,149,148.91,149.06,149.04,149.01,149.09,149.15,149.05,149.02,149.06,149.06,148.98,149.06,149.02,149.12,148.82,149.19,149.12,148.84,148.92,149.04,149.01,149.09,148.96,149.16,149.09,149.13,149.14,148.93,149.08,149.13,149.09,149.02,149.2,149.01,148.99,149.01,149.06,149.2,148.96,149.15,149.16,149.12,149.1,149.13,149.11,149.05,149.06,149.07,149.14,149.15,149.13,148.91,148.84,149.09,149.17,149.17,149.07,148.81,149.11,148.77,149.06,149.14,148.83,148.91,149.04,149.18,148.87,149.39,149.13,148.82,149.14,149.03,149.04,149.07,148.9,148.99,149.07,149.07,149.14,148.97,148.85,148.85,149.09,149.05,148.96,149.05,149.1,149.04,148.84,149.11,149.12,149.15,149.09,148.99,149.08,149.09,149.12,149.09,149.03,149.14,148.95,148.8,148.78,148.96,148.81,148.81,148.99,149.12,149.11,148.85,149.14,149.08,149.14,148.91,149.06,149.03,148.83,148.91,148.82,149.02,148.82,148.79,148.97,149.01,148.91,149.13,149,149.01,149.27,148.98,149.03,148.8,148.9,148.97,149.11,148.99,149.15,148.85,148.93,148.94,148.91,148.98,148.78,148.78,148.89,148.94,149.13,148.92,148.83,149.08,149.07,148.9,148.95,149.01,149,149.02,148.89,148.98,148.81,149.04,149.06,148.88,148.96,148.93,148.81,148.86,148.84,149.19,148.9,148.83,148.98,149.08,149.09,149,149,148.99,148.97,148.99,149.21,148.8,149.04,149.07,149.07,149,148.98,149.18,148.94,149.05,148.96,148.98,148.79,149.11,149.01,148.92,148.92,148.91,149,148.95,148.94,149.1,148.92,148.91,148.99,149,149.08,148.97,148.84,148.92,149.24,149.11,149.07,148.96,149.23,148.98,148.95,148.96,149,148.9,148.95,148.9,148.8,149.16,148.87,148.98,148.95,148.96,148.84,148.82,149.16,148.83,148.84,148.93,149.06,148.96,149.13,148.97,149.15,149.02,148.88,149.11,148.83,149.06,148.9,148.92,149.08,148.95,148.93,148.91,149.06,149.05,149.26,148.94,149.13,149.16,149.1,149.01,149.09,148.81,149,148.9,149.09,148.82,149.36,148.93,148.88,148.99,149.05,148.96,148.99,148.83,148.78,148.95,149.01,148.93,148.84,148.83,149.04,149.06,149.08,148.9,149.01,148.97,149.01,149.06,148.98,149.08,148.99,148.78,149.15,148.93,148.96,148.93,149.05,148.77,148.79,148.81,149.05,149.04,148.99,148.93,148.95,149.14,148.87,148.83,149.07,149.1,148.87,148.98,148.94,148.99,148.95,149.06,148.97,148.96,148.78,148.93,148.95,149.02,148.97,149,148.84,149.11,148.94,148.8,149.02,149.27,149.07,148.92,148.81,149.2,148.87,149.08,148.93,148.95,149.03,149.03,149.15,149,148.82,148.99,149.39,148.98,148.99,148.98,148.99,149,148.91,148.82,148.94,149.03,149.07,149,148.83,148.92,149.02,149.18,149,148.9,148.83,148.78,148.83,149.05,148.94,148.94,149.03,148.89,149.07,149.02,148.93,148.96,148.94,148.89,148.89,149.15,148.84,149.15,149.12,148.93,148.91,148.77,148.92,149.07,149.02,149,148.99,148.98,149,149.16,148.89,148.85,148.87,148.99,148.84,149,148.92,148.9,149.1,148.94,149.06,148.89,148.88,149.05,148.92,148.93,148.83,148.92,149.07,148.96,148.92,148.98,148.79,149.05,149.16,148.96,149.16,149.34,148.77,149,149.11,148.78,149.07,148.85,149.12,149.22,149.11,148.9,148.99,148.94,148.89,148.97,148.8,148.86,148.99,148.83,148.95,149.05,149.14,148.91,148.82,149.15,149.1,149.07,148.97,148.93,148.96,149.08,148.97,149.06,149.01,149.08,149.14,149.03,149.1,148.91,148.91,148.91,148.91,148.88,148.91,149.21,149.08,149.08],1,null,"Gang-gang Cockatoo Records",{"interactive":true,"className":"","stroke":true,"color":["#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96"],"weight":0.5,"opacity":1,"fill":true,"fillColor":["#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#f6aa70","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96","#11aa96"],"fillOpacity":1},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLayersControl","args":[[],["ACT","Gang-gang Cockatoo Records"],{"collapsed":false,"autoZIndex":true,"position":"topright"}]},{"method":"addControl","args":["\n    <div style='background-color: white; padding: 10px; border-radius: 5px;'>\n      <strong>Legend<\/strong><br>\n      <i style='background: lightblue; width: 18px; height: 18px; display: inline-block; margin-right: 8px; opacity: 0.7;'><\/i>\n      ACT Boundary<br>\n      <i style='background: #11aa96; width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 8px;'><\/i>\n      Gang-gang Cockatoo Presence<br>\n      <i style='background: #f6aa70; width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 8px;'><\/i>\n      Gang-gang Cockatoo Absence\n    <\/div>\n    ","bottomright",null,"info legend"]}],"limits":{"lat":[-35.92053007299919,-35.12441580299917],"lng":[148.7627901059977,149.399287041998]},"setView":[[-35.5,149],8,[]]},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Now, let’s calculate the number of presences and absences in the dataset to assess the extent of imbalance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate counts of presence (PRESENT) and absence (ABSENT)</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>occ_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(gang_gang_act<span class="sc">$</span>occrrnS)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to data frame for plotting</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>occ_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(occ_counts)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(occ_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Occurrence"</span>, <span class="st">"Count"</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create bar plot with custom colors</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(occ_df, <span class="fu">aes</span>(<span class="at">x =</span> Occurrence, <span class="at">y =</span> Count, <span class="at">fill =</span> Occurrence)) <span class="sc">+</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> Count),</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>,  </span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Presence vs Absence Count"</span>,</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Occurrence"</span>,</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"PRESENT"</span> <span class="ot">=</span> <span class="st">"#11aa96"</span>, <span class="st">"ABSENT"</span> <span class="ot">=</span> <span class="st">"#f6aa70"</span>)) <span class="sc">+</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="imbalanced_data_files/figure-html/sum_classification-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can see the amount of Gang-gang Cockatoo absent records are way less than its present records.</p>
</section>
<section id="environmental-variables" class="level2">
<h2 class="anchored" data-anchor-id="environmental-variables">2.4 Environmental variables</h2>
<p>We conducted several tests and selected seven environmental variables for this case study. For more information on preparing environmental datasets and selecting environmental variables, please refer to our notebooks: <a href="https://github.com/ecocommonsaustralia/notebooks/blob/main/notebooks/raster_preparation.qmd">Raster-preparation</a> and <a href="https://github.com/ecocommonsaustralia/notebooks/blob/main/notebooks/EC_GLM.qmd">GLM</a> (section 2.3-3.1).</p>
<table class="caption-top table">
<colgroup>
<col style="width: 40%">
<col style="width: 59%">
</colgroup>
<thead>
<tr class="header">
<th>Variable code</th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>AusClim_bioclim_03_9s_1976-2005</td>
<td><strong>Isothermality</strong> (BIO3) — Mean Diurnal Range / Annual Temp Range × 100</td>
</tr>
<tr class="even">
<td>AusClim_bioclim_06_9s_1976-2005</td>
<td><strong>Min Temperature of Coldest Month</strong> (BIO6)</td>
</tr>
<tr class="odd">
<td>AusClim_bioclim_09_9s_1976-2005</td>
<td><strong>Mean Temperature of Driest Quarter</strong> (BIO9)</td>
</tr>
<tr class="even">
<td>AusClim_bioclim_15_9s_1976-2005</td>
<td><strong>Precipitation Seasonality</strong> (Coefficient of Variation) (BIO15)</td>
</tr>
<tr class="odd">
<td>AusClim_bioclim_24_9s_1976-2005</td>
<td><strong>Annual Mean Moisture Index</strong> (custom or derived bioclim variable)</td>
</tr>
<tr class="even">
<td>AusClim_bioclim_27_9s_1976-2005</td>
<td><strong>Mean Moisture Index of Driest Quarter</strong> (custom/derived)</td>
</tr>
<tr class="odd">
<td>AusClim_bioclim_29_9s_1976-2005</td>
<td><strong>Mean Radiation of Warmest Quarter</strong> (custom/derived)</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the stacked raster layers</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>env_var_stack <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="st">"imbalanced_data/ACT_raster.tif"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the desired layers by their names</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>selected_layers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"AusClim_bioclim_03_9s_1976-2005"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"AusClim_bioclim_06_9s_1976-2005"</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"AusClim_bioclim_09_9s_1976-2005"</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"AusClim_bioclim_15_9s_1976-2005"</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"AusClim_bioclim_24_9s_1976-2005"</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"AusClim_bioclim_27_9s_1976-2005"</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"AusClim_bioclim_29_9s_1976-2005"</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the raster stack</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>selected_rasters <span class="ot">&lt;-</span> env_var_stack[[selected_layers]]</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all selected layers</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selected_rasters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="imbalanced_data_files/figure-html/env_data-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="when-we-have-true-absence-data" class="level1">
<h1>3. When we have true-absence data</h1>
<section id="including-true-absence-in-the-training-dataset" class="level2">
<h2 class="anchored" data-anchor-id="including-true-absence-in-the-training-dataset">3.1 Including true absence in the training dataset</h2>
<p>Including true-absence data in training dataset is always recommended when such data is available <span class="citation" data-cites="vaclavik2009invasive">(<a href="#ref-vaclavik2009invasive" role="doc-biblioref">Václavı́k &amp; Meentemeyer, 2009</a>)</span>. In this study, we aim to explore the question: ‘<strong>how much true-absence data is enough?</strong>’ <strong>‘Is more always better?’</strong></p>
<p>To answer this question, we allocate 90%, 70%, 50% of the true absence data, along with an equal amount of present data to the test dataset, using the rest data as training dataset.</p>
<p>Here, we can make a function to split the data as we want.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>split_occurrence_data_by_absence_test <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">p_abs_test =</span> <span class="fl">0.9</span>, <span class="at">seed =</span> <span class="dv">123</span>) {</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set seed for reproducibility</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify indices for ABSENT and PRESENT rows</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  abs_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(data<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="st">"ABSENT"</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  pres_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(data<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="st">"PRESENT"</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total number of ABSENT records</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  n_abs <span class="ot">&lt;-</span> <span class="fu">length</span>(abs_idx)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Number of ABSENT records to include in test set</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  n_test_abs <span class="ot">&lt;-</span> <span class="fu">round</span>(p_abs_test <span class="sc">*</span> n_abs)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Randomly sample n_test_abs indices from the ABSENT indices for the test set</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  test_abs_idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(abs_idx, n_test_abs)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For the test set, randomly sample an equal number of PRESENT records</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  test_pres_idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(pres_idx, n_test_abs)</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create test data: sampled ABSENT + sampled PRESENT</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> data[<span class="fu">c</span>(test_abs_idx, test_pres_idx), ]</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create training data: the remaining rows (i.e., those not selected for test)</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> data[<span class="sc">-</span><span class="fu">c</span>(test_abs_idx, test_pres_idx), ]</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">test_data =</span> test_data, <span class="at">train_data =</span> train_data))</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we can use the above function to split the data in three difference ways:</p>
<ul>
<li><p>90% of true absence data, along with an equal amount of present data to the test dataset, using the rest data as training dataset.</p></li>
<li><p>70% of true absence data, along with an equal amount of present data to the test dataset, using the rest data as training dataset.</p></li>
<li><p>50% of the true absence data, along with an equal amount of present data to the test dataset, using the rest data as training dataset.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For a 90% test split (of the ABSENT records)</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>split_90_absence <span class="ot">&lt;-</span> <span class="fu">split_occurrence_data_by_absence_test</span>(gang_gang_act, <span class="at">p_abs_test =</span> <span class="fl">0.9</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For a 70% test split</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>split_70_absence <span class="ot">&lt;-</span> <span class="fu">split_occurrence_data_by_absence_test</span>(gang_gang_act, <span class="at">p_abs_test =</span> <span class="fl">0.7</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># For a 50% test split</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>split_50_absence <span class="ot">&lt;-</span> <span class="fu">split_occurrence_data_by_absence_test</span>(gang_gang_act, <span class="at">p_abs_test =</span> <span class="fl">0.5</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate counts from the split data</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>train_90_absence <span class="ot">&lt;-</span> <span class="fu">table</span>(split_90_absence<span class="sc">$</span>train_data<span class="sc">$</span>occrrnS)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>test_90_absence <span class="ot">&lt;-</span> <span class="fu">table</span>(split_90_absence<span class="sc">$</span>test_data<span class="sc">$</span>occrrnS)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>train_70_absence <span class="ot">&lt;-</span> <span class="fu">table</span>(split_70_absence<span class="sc">$</span>train_data<span class="sc">$</span>occrrnS)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>test_70_absence <span class="ot">&lt;-</span> <span class="fu">table</span>(split_70_absence<span class="sc">$</span>test_data<span class="sc">$</span>occrrnS)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>train_50_absence <span class="ot">&lt;-</span> <span class="fu">table</span>(split_50_absence<span class="sc">$</span>train_data<span class="sc">$</span>occrrnS)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>test_50_absence <span class="ot">&lt;-</span> <span class="fu">table</span>(split_50_absence<span class="sc">$</span>test_data<span class="sc">$</span>occrrnS)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with the extracted counts</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>split_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">Split =</span> <span class="fu">c</span>(<span class="st">"90% Absence Train"</span>, <span class="st">"90% Absence Test"</span>, <span class="st">"70% Absence Train"</span>, <span class="st">"70% Absence Test"</span>, <span class="st">"50% Absence Train"</span>, <span class="st">"50% Absence Test"</span>),</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">ABSENT =</span> <span class="fu">c</span>(train_90_absence[<span class="st">"ABSENT"</span>], test_90_absence[<span class="st">"ABSENT"</span>],</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>             train_70_absence[<span class="st">"ABSENT"</span>], test_70_absence[<span class="st">"ABSENT"</span>],</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>             train_50_absence[<span class="st">"ABSENT"</span>], test_50_absence[<span class="st">"ABSENT"</span>]),</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">PRESENT =</span> <span class="fu">c</span>(train_90_absence[<span class="st">"PRESENT"</span>], test_90_absence[<span class="st">"PRESENT"</span>],</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>              train_70_absence[<span class="st">"PRESENT"</span>], test_70_absence[<span class="st">"PRESENT"</span>],</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>              train_50_absence[<span class="st">"PRESENT"</span>], test_50_absence[<span class="st">"PRESENT"</span>])</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(split_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Split ABSENT PRESENT
1 90% Absence Train     14     660
2  90% Absence Test    122     122
3 70% Absence Train     41     687
4  70% Absence Test     95      95
5 50% Absence Train     68     714
6  50% Absence Test     68      68</code></pre>
</div>
</div>
<p>We can visualise above table in a bar chart.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape data for ggplot using melt (or use pivot_longer)</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>split_data_melted <span class="ot">&lt;-</span> <span class="fu">melt</span>(split_data, <span class="at">id.vars =</span> <span class="st">"Split"</span>, <span class="at">variable.name =</span> <span class="st">"Status"</span>, <span class="at">value.name =</span> <span class="st">"Count"</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar plot with labels</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(split_data_melted, <span class="fu">aes</span>(<span class="at">x =</span> Split, <span class="at">y =</span> Count, <span class="at">fill =</span> Status)) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span>  <span class="co"># Adjust bar positions</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Count), </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  <span class="co"># Add text labels</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ABSENT and PRESENT Counts Across Data Splits"</span>, <span class="at">x =</span> <span class="st">"Data Split"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"ABSENT"</span> <span class="ot">=</span> <span class="st">"#f6aa70"</span>, <span class="st">"PRESENT"</span> <span class="ot">=</span> <span class="st">"#11aa96"</span>)) <span class="sc">+</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="imbalanced_data_files/figure-html/plot_split-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now, we combine the training and test data with environmental dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>get_occurrence_data <span class="ot">&lt;-</span> <span class="cf">function</span>(occurrence_sf, env_var_stack, <span class="at">drop_na =</span> <span class="cn">TRUE</span>, <span class="at">dropCols =</span> <span class="cn">NULL</span>) {</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert the occurrence sf object to a terra SpatVector</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  occ_vect <span class="ot">&lt;-</span> <span class="fu">vect</span>(occurrence_sf)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract raster values at the occurrence points</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  extracted_values <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">extract</span>(env_var_stack, occ_vect)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine occurrence data (as a data frame) with the extracted raster values</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  occ_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(occurrence_sf), extracted_values)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Optionally remove rows with any NA values</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (drop_na) {</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    occ_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(occ_data)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Optionally drop specified columns</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(dropCols)) {</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    occ_data <span class="ot">&lt;-</span> occ_data[, <span class="sc">-</span>dropCols]</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(occ_data)</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>combine_with_env_data <span class="ot">&lt;-</span> <span class="cf">function</span>(split_list, env_var_stack, <span class="at">dropCols =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Process the training data</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  train_data_env <span class="ot">&lt;-</span> <span class="fu">get_occurrence_data</span>(split_list<span class="sc">$</span>train_data, env_var_stack, <span class="at">dropCols =</span> dropCols)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Process the test data</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  test_data_env  <span class="ot">&lt;-</span> <span class="fu">get_occurrence_data</span>(split_list<span class="sc">$</span>test_data, env_var_stack, <span class="at">dropCols =</span> dropCols)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">train_data_env =</span> train_data_env, <span class="at">test_data_env =</span> test_data_env))</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Then, combine each split with the environmental variables:</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>env_combined_90 <span class="ot">&lt;-</span> <span class="fu">combine_with_env_data</span>(split_90_absence, env_var_stack, <span class="at">dropCols =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>env_combined_70 <span class="ot">&lt;-</span> <span class="fu">combine_with_env_data</span>(split_70_absence, env_var_stack, <span class="at">dropCols =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>env_combined_50 <span class="ot">&lt;-</span> <span class="fu">combine_with_env_data</span>(split_50_absence, env_var_stack, <span class="at">dropCols =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list of three training data data frames</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>train_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"split_90_train"</span> <span class="ot">=</span> env_combined_90<span class="sc">$</span>train_data_env,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"split_70_train"</span> <span class="ot">=</span> env_combined_70<span class="sc">$</span>train_data_env,</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"split_50_train"</span> <span class="ot">=</span> env_combined_50<span class="sc">$</span>train_data_env</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list of three training data data frames</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>test_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"split_90_test"</span> <span class="ot">=</span> env_combined_90<span class="sc">$</span>test_data_env,</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"split_70_test"</span> <span class="ot">=</span> env_combined_70<span class="sc">$</span>test_data_env,</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"split_50_test"</span> <span class="ot">=</span> env_combined_50<span class="sc">$</span>test_data_env</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we have three sets of training and test data ready for modelling.</p>
<ul>
<li><p>split_90_train &amp; split_90_test</p></li>
<li><p>split_70_train &amp; split_70_test</p></li>
<li><p>split_50_train &amp; split_50_test</p></li>
</ul>
</section>
<section id="un-weighted-models" class="level2">
<h2 class="anchored" data-anchor-id="un-weighted-models">3.2 Un-weighted models</h2>
<p>In this section, we will ignore the issue of dataset imbalance and run a GLM SDM model. We will generate all the evaluation metrics mentioned in section <a href="#evaluation-metric">1.4 Evaluation metric</a>.</p>
<p>This is a function running GLM and producing evaluation metrics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>fit_model_and_get_perf_no_wt <span class="ot">&lt;-</span> <span class="cf">function</span>(train_data_env, test_data_env, <span class="at">tss_step =</span> <span class="fl">0.01</span>) {</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Load required libraries</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(pROC)     <span class="co"># For AUROC</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(PRROC)    <span class="co"># For AUPR</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1) Copy data locally</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> train_data_env</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  test_data  <span class="ot">&lt;-</span> test_data_env</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert occrrnS to 0/1 numeric</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  train_data<span class="sc">$</span>occrrnS <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(train_data<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="st">"PRESENT"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  test_data<span class="sc">$</span>occrrnS  <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(test_data<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="st">"PRESENT"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define model formula</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  my_formula <span class="ot">&lt;-</span> occrrnS <span class="sc">~</span> <span class="st">`</span><span class="at">AusClim_bioclim_03_9s_1976-2005</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">AusClim_bioclim_06_9s_1976-2005</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">AusClim_bioclim_09_9s_1976-2005</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">AusClim_bioclim_15_9s_1976-2005</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">AusClim_bioclim_24_9s_1976-2005</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">AusClim_bioclim_27_9s_1976-2005</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">AusClim_bioclim_29_9s_1976-2005</span><span class="st">`</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2) Fit the unweighted GLM model</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">glm</span>(my_formula, <span class="at">data =</span> train_data, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Predict probabilities on the test data</span></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  predicted_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> test_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -----------------------------</span></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PART A: Standard metrics at threshold = 0.5</span></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -----------------------------</span></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>  pred_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predicted_probs <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Force table to have both '0' and '1' as levels</span></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>  pred_class_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_class, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>  actual_factor     <span class="ot">&lt;-</span> <span class="fu">factor</span>(test_data<span class="sc">$</span>occrrnS, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>  conf_mat <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> pred_class_factor, <span class="at">Actual =</span> actual_factor)</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Safely extract entries</span></span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>  TP <span class="ot">&lt;-</span> conf_mat[<span class="st">"1"</span>,<span class="st">"1"</span>]</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>  FP <span class="ot">&lt;-</span> conf_mat[<span class="st">"1"</span>,<span class="st">"0"</span>]</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>  FN <span class="ot">&lt;-</span> conf_mat[<span class="st">"0"</span>,<span class="st">"1"</span>]</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>  TN <span class="ot">&lt;-</span> conf_mat[<span class="st">"0"</span>,<span class="st">"0"</span>]</span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>  accuracy    <span class="ot">&lt;-</span> (TP <span class="sc">+</span> TN) <span class="sc">/</span> <span class="fu">sum</span>(conf_mat)</span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>  sensitivity <span class="ot">&lt;-</span> TP <span class="sc">/</span> (TP <span class="sc">+</span> FN)  <span class="co"># Recall</span></span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>  specificity <span class="ot">&lt;-</span> TN <span class="sc">/</span> (TN <span class="sc">+</span> FP)</span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>  precision   <span class="ot">&lt;-</span> TP <span class="sc">/</span> (TP <span class="sc">+</span> FP)</span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>  f1          <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> precision <span class="sc">*</span> sensitivity <span class="sc">/</span> (precision <span class="sc">+</span> sensitivity)</span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -----------------------------</span></span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PART B: Additional Metrics</span></span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -----------------------------</span></span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># AUROC</span></span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a>  roc_curve <span class="ot">&lt;-</span> pROC<span class="sc">::</span><span class="fu">roc</span>(<span class="at">response =</span> test_data<span class="sc">$</span>occrrnS, <span class="at">predictor =</span> predicted_probs)</span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a>  auc_value <span class="ot">&lt;-</span> pROC<span class="sc">::</span><span class="fu">auc</span>(roc_curve)</span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># AUPR (Area Under Precision-Recall Curve)</span></span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> <span class="fu">pr.curve</span>(<span class="at">scores.class0 =</span> predicted_probs[test_data<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb43-63"><a href="#cb43-63" aria-hidden="true" tabindex="-1"></a>                 <span class="at">scores.class1 =</span> predicted_probs[test_data<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="dv">0</span>],</span>
<span id="cb43-64"><a href="#cb43-64" aria-hidden="true" tabindex="-1"></a>                 <span class="at">curve =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-65"><a href="#cb43-65" aria-hidden="true" tabindex="-1"></a>  aupr_value <span class="ot">&lt;-</span> pr<span class="sc">$</span>auc.integral</span>
<span id="cb43-66"><a href="#cb43-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-67"><a href="#cb43-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Correlation between observed and predicted</span></span>
<span id="cb43-68"><a href="#cb43-68" aria-hidden="true" tabindex="-1"></a>  corr_value <span class="ot">&lt;-</span> <span class="fu">cor</span>(test_data<span class="sc">$</span>occrrnS, predicted_probs, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb43-69"><a href="#cb43-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-70"><a href="#cb43-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -----------------------------</span></span>
<span id="cb43-71"><a href="#cb43-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PART C: Sweep thresholds to find max TSS</span></span>
<span id="cb43-72"><a href="#cb43-72" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -----------------------------</span></span>
<span id="cb43-73"><a href="#cb43-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-74"><a href="#cb43-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Helper function to safely compute TSS elements</span></span>
<span id="cb43-75"><a href="#cb43-75" aria-hidden="true" tabindex="-1"></a>  compute_tss <span class="ot">&lt;-</span> <span class="cf">function</span>(obs, preds, threshold) {</span>
<span id="cb43-76"><a href="#cb43-76" aria-hidden="true" tabindex="-1"></a>    pred_bin <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(preds <span class="sc">&gt;=</span> threshold, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb43-77"><a href="#cb43-77" aria-hidden="true" tabindex="-1"></a>    TP <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred_bin <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> obs <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb43-78"><a href="#cb43-78" aria-hidden="true" tabindex="-1"></a>    TN <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred_bin <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> obs <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb43-79"><a href="#cb43-79" aria-hidden="true" tabindex="-1"></a>    FP <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred_bin <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> obs <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb43-80"><a href="#cb43-80" aria-hidden="true" tabindex="-1"></a>    FN <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred_bin <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> obs <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb43-81"><a href="#cb43-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-82"><a href="#cb43-82" aria-hidden="true" tabindex="-1"></a>    sens <span class="ot">&lt;-</span> <span class="cf">if</span> ((TP <span class="sc">+</span> FN) <span class="sc">&gt;</span> <span class="dv">0</span>) TP <span class="sc">/</span> (TP <span class="sc">+</span> FN) <span class="cf">else</span> <span class="cn">NA</span></span>
<span id="cb43-83"><a href="#cb43-83" aria-hidden="true" tabindex="-1"></a>    spec <span class="ot">&lt;-</span> <span class="cf">if</span> ((TN <span class="sc">+</span> FP) <span class="sc">&gt;</span> <span class="dv">0</span>) TN <span class="sc">/</span> (TN <span class="sc">+</span> FP) <span class="cf">else</span> <span class="cn">NA</span></span>
<span id="cb43-84"><a href="#cb43-84" aria-hidden="true" tabindex="-1"></a>    tss_val <span class="ot">&lt;-</span> sens <span class="sc">+</span> spec <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb43-85"><a href="#cb43-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">sensitivity =</span> sens, <span class="at">specificity =</span> spec, <span class="at">TSS =</span> tss_val))</span>
<span id="cb43-86"><a href="#cb43-86" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-87"><a href="#cb43-87" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-88"><a href="#cb43-88" aria-hidden="true" tabindex="-1"></a>  thresholds <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> tss_step)</span>
<span id="cb43-89"><a href="#cb43-89" aria-hidden="true" tabindex="-1"></a>  tss_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb43-90"><a href="#cb43-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">threshold   =</span> thresholds,</span>
<span id="cb43-91"><a href="#cb43-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">sensitivity =</span> <span class="cn">NA</span>,</span>
<span id="cb43-92"><a href="#cb43-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">specificity =</span> <span class="cn">NA</span>,</span>
<span id="cb43-93"><a href="#cb43-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">TSS         =</span> <span class="cn">NA</span></span>
<span id="cb43-94"><a href="#cb43-94" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-95"><a href="#cb43-95" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-96"><a href="#cb43-96" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(thresholds)) {</span>
<span id="cb43-97"><a href="#cb43-97" aria-hidden="true" tabindex="-1"></a>    res_tss <span class="ot">&lt;-</span> <span class="fu">compute_tss</span>(test_data<span class="sc">$</span>occrrnS, predicted_probs, thresholds[i])</span>
<span id="cb43-98"><a href="#cb43-98" aria-hidden="true" tabindex="-1"></a>    tss_df<span class="sc">$</span>sensitivity[i] <span class="ot">&lt;-</span> res_tss<span class="sc">$</span>sensitivity</span>
<span id="cb43-99"><a href="#cb43-99" aria-hidden="true" tabindex="-1"></a>    tss_df<span class="sc">$</span>specificity[i] <span class="ot">&lt;-</span> res_tss<span class="sc">$</span>specificity</span>
<span id="cb43-100"><a href="#cb43-100" aria-hidden="true" tabindex="-1"></a>    tss_df<span class="sc">$</span>TSS[i]         <span class="ot">&lt;-</span> res_tss<span class="sc">$</span>TSS</span>
<span id="cb43-101"><a href="#cb43-101" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-102"><a href="#cb43-102" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-103"><a href="#cb43-103" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify the threshold that yields the maximum TSS</span></span>
<span id="cb43-104"><a href="#cb43-104" aria-hidden="true" tabindex="-1"></a>  max_idx <span class="ot">&lt;-</span> <span class="fu">which.max</span>(tss_df<span class="sc">$</span>TSS)</span>
<span id="cb43-105"><a href="#cb43-105" aria-hidden="true" tabindex="-1"></a>  best_threshold <span class="ot">&lt;-</span> tss_df<span class="sc">$</span>threshold[max_idx]</span>
<span id="cb43-106"><a href="#cb43-106" aria-hidden="true" tabindex="-1"></a>  best_tss       <span class="ot">&lt;-</span> tss_df<span class="sc">$</span>TSS[max_idx]</span>
<span id="cb43-107"><a href="#cb43-107" aria-hidden="true" tabindex="-1"></a>  best_sens      <span class="ot">&lt;-</span> tss_df<span class="sc">$</span>sensitivity[max_idx]</span>
<span id="cb43-108"><a href="#cb43-108" aria-hidden="true" tabindex="-1"></a>  best_spec      <span class="ot">&lt;-</span> tss_df<span class="sc">$</span>specificity[max_idx]</span>
<span id="cb43-109"><a href="#cb43-109" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-110"><a href="#cb43-110" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -----------------------------</span></span>
<span id="cb43-111"><a href="#cb43-111" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PART D: Return all metrics</span></span>
<span id="cb43-112"><a href="#cb43-112" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -----------------------------</span></span>
<span id="cb43-113"><a href="#cb43-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb43-114"><a href="#cb43-114" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The fitted model + raw predictions</span></span>
<span id="cb43-115"><a href="#cb43-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">model             =</span> model,</span>
<span id="cb43-116"><a href="#cb43-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">predicted_probs   =</span> predicted_probs,</span>
<span id="cb43-117"><a href="#cb43-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">roc_obj           =</span> roc_curve,</span>
<span id="cb43-118"><a href="#cb43-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">auc               =</span> <span class="fu">as.numeric</span>(auc_value),</span>
<span id="cb43-119"><a href="#cb43-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">aupr              =</span> <span class="fu">as.numeric</span>(aupr_value),</span>
<span id="cb43-120"><a href="#cb43-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">corr              =</span> corr_value,</span>
<span id="cb43-121"><a href="#cb43-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">confusion_matrix_0.5  =</span> conf_mat,</span>
<span id="cb43-122"><a href="#cb43-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics_0.5 =</span> <span class="fu">data.frame</span>(</span>
<span id="cb43-123"><a href="#cb43-123" aria-hidden="true" tabindex="-1"></a>      <span class="at">Accuracy     =</span> accuracy,</span>
<span id="cb43-124"><a href="#cb43-124" aria-hidden="true" tabindex="-1"></a>      <span class="at">Sensitivity  =</span> sensitivity,  <span class="co"># Recall</span></span>
<span id="cb43-125"><a href="#cb43-125" aria-hidden="true" tabindex="-1"></a>      <span class="at">Specificity  =</span> specificity,</span>
<span id="cb43-126"><a href="#cb43-126" aria-hidden="true" tabindex="-1"></a>      <span class="at">Precision    =</span> precision,</span>
<span id="cb43-127"><a href="#cb43-127" aria-hidden="true" tabindex="-1"></a>      <span class="at">F1           =</span> f1</span>
<span id="cb43-128"><a href="#cb43-128" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb43-129"><a href="#cb43-129" aria-hidden="true" tabindex="-1"></a>    <span class="co"># TSS sweep results</span></span>
<span id="cb43-130"><a href="#cb43-130" aria-hidden="true" tabindex="-1"></a>    <span class="at">tss_table      =</span> tss_df,</span>
<span id="cb43-131"><a href="#cb43-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">best_threshold =</span> best_threshold,</span>
<span id="cb43-132"><a href="#cb43-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_tss        =</span> best_tss,</span>
<span id="cb43-133"><a href="#cb43-133" aria-hidden="true" tabindex="-1"></a>    <span class="at">best_sensitivity =</span> best_sens,</span>
<span id="cb43-134"><a href="#cb43-134" aria-hidden="true" tabindex="-1"></a>    <span class="at">best_specificity =</span> best_spec</span>
<span id="cb43-135"><a href="#cb43-135" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb43-136"><a href="#cb43-136" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Run models with our three pairs of data and extract the evaluation metrics of these models.</p>
<ul>
<li><p>Split_90_absence_unwt: split_90_train &amp; split_90_test</p></li>
<li><p>Split_70_absence_unwt: split_70_train &amp; split_70_test</p></li>
<li><p>Split_50_absence_unwt: split_50_train &amp; split_50_test</p></li>
</ul>
<p>‘unwt’ means unweighted.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the fit_model_and_get_perf_no_wt function to train and test lists</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>model_including_true_absence_no_wt <span class="ot">&lt;-</span> <span class="fu">mapply</span>(fit_model_and_get_perf_no_wt, </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">train_data_env =</span> train_list, </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">test_data_env =</span> test_list,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">SIMPLIFY =</span> <span class="cn">FALSE</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a data frame by extracting each metric from the results</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>results_including_true_absence_table_no_wt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">AUC              =</span> <span class="fu">sapply</span>(model_including_true_absence_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>auc),</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">AUPR             =</span> <span class="fu">sapply</span>(model_including_true_absence_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>aupr),</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">CORR             =</span> <span class="fu">sapply</span>(model_including_true_absence_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>corr),</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Accuracy         =</span> <span class="fu">sapply</span>(model_including_true_absence_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>metrics_0<span class="fl">.5</span><span class="sc">$</span>Accuracy),</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sensitivity      =</span> <span class="fu">sapply</span>(model_including_true_absence_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>metrics_0<span class="fl">.5</span><span class="sc">$</span>Sensitivity),  <span class="co"># Recall</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Specificity      =</span> <span class="fu">sapply</span>(model_including_true_absence_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>metrics_0<span class="fl">.5</span><span class="sc">$</span>Specificity),</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Precision        =</span> <span class="fu">sapply</span>(model_including_true_absence_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>metrics_0<span class="fl">.5</span><span class="sc">$</span>Precision),</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">F1               =</span> <span class="fu">sapply</span>(model_including_true_absence_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>metrics_0<span class="fl">.5</span><span class="sc">$</span>F1),</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Best_Threshold   =</span> <span class="fu">sapply</span>(model_including_true_absence_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>best_threshold),</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max_TSS          =</span> <span class="fu">sapply</span>(model_including_true_absence_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>max_tss),</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Best_Sensitivity =</span> <span class="fu">sapply</span>(model_including_true_absence_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>best_sensitivity),</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Best_Specificity =</span> <span class="fu">sapply</span>(model_including_true_absence_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>best_specificity)</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can print the evaluation metrics of all three models in one table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Round numeric values to 3 decimal places</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>results_including_true_absence_table_no_wt <span class="ot">&lt;-</span> results_including_true_absence_table_no_wt <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">3</span>)))</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the table with smaller font</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>results_including_true_absence_table_no_wt <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="st">"html"</span>, <span class="at">caption =</span> <span class="st">"Model Evaluation Metrics"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">12</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Model Evaluation Metrics</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AUC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AUPR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CORR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Accuracy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sensitivity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Specificity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Precision</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">F1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Best_Threshold</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Max_TSS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Best_Sensitivity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Best_Specificity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">split_90_train</td>
<td style="text-align: right;">0.661</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">0.143</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">0.172</td>
<td style="text-align: right;">0.852</td>
<td style="text-align: right;">0.320</td>
</tr>
<tr class="even">
<td style="text-align: left;">split_70_train</td>
<td style="text-align: right;">0.695</td>
<td style="text-align: right;">0.688</td>
<td style="text-align: right;">0.325</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">0.284</td>
<td style="text-align: right;">0.716</td>
<td style="text-align: right;">0.568</td>
</tr>
<tr class="odd">
<td style="text-align: left;">split_50_train</td>
<td style="text-align: right;">0.664</td>
<td style="text-align: right;">0.643</td>
<td style="text-align: right;">0.317</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.309</td>
<td style="text-align: right;">0.882</td>
<td style="text-align: right;">0.426</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="which-model-is-better" class="level3">
<h3 class="anchored" data-anchor-id="which-model-is-better">3.2.1 Which model is better?</h3>
<p><strong>split_70_train</strong> shows <strong>better overall performance</strong> based on <strong>AUC, AUPR, CORR</strong>, and <strong>Best_Specificity</strong>.</p>
<p><strong>split_50_train</strong> leads in <strong>Max_TSS</strong> and <strong>Best_Sensitivity</strong>, indicating it may perform slightly better in balancing true positive and true negative rates.</p>
<p><strong>split_90_train</strong> consistently underperforms in most metrics.</p>
</section>
<section id="is-more-always-better" class="level3">
<h3 class="anchored" data-anchor-id="is-more-always-better">3.2.2 Is more always better?</h3>
<p><strong>Not necessarily — more true-absence data can help, but only up to a point.</strong> The results show that increasing the training data (from 50% to 90%) does <strong>not consistently improve</strong> the model’s performance. Here’s why:</p>
<p><strong>Performance Improvement with More Absences:</strong></p>
<ul>
<li><p>As we increased the proportion of true-absence data from <strong>10% (split_90)</strong> to <strong>50% (split_50)</strong>, there was a <strong>clear improvement</strong> in several metrics:</p></li>
<li><p><strong>AUC</strong> rose from <strong>0.661</strong> (split_90) to <strong>0.695</strong> (split_70), showing better discriminatory power with more absences.</p></li>
<li><p><strong>AUPR</strong> improved similarly, reflecting better precision-recall balance.</p></li>
<li><p><strong>Max_TSS</strong> increased from <strong>0.172</strong> (split_90) to <strong>0.309</strong> (split_50), indicating a better trade-off between sensitivity and specificity.</p></li>
</ul>
<p><strong>Diminishing Returns Beyond a Point:</strong></p>
<p>While moving from <strong>10% to 30%</strong> absences (split_90 to split_70) resulted in noticeable improvements, the jump from <strong>30% to 50%</strong> (split_70 to split_50) offered <strong>smaller gains</strong> in AUC and AUPR, suggesting diminishing returns.</p>
</section>
<section id="how-much-true-absence-data-is-enough" class="level3">
<h3 class="anchored" data-anchor-id="how-much-true-absence-data-is-enough">3.2.3 How much true-absence data is enough?</h3>
<p><strong>30% (split_70)</strong> seems to strike a <strong>good balance</strong>:</p>
<ul>
<li><p>It achieved the <strong>highest AUC (0.695)</strong> and <strong>AUPR (0.688)</strong>.</p></li>
<li><p><strong>Best_Specificity (0.568)</strong> was highest in split_70, showing better negative prediction performance.</p></li>
<li><p><strong>Max_TSS (0.284)</strong> is respectable and close to the best value (0.309 in split_50).</p></li>
</ul>
<p><strong>50% (split_50)</strong> provides the <strong>highest TSS (0.309)</strong> and <strong>Best_Sensitivity (0.882)</strong> but doesn’t outperform split_70 on AUC and AUPR. This suggests that <strong>too much absence data may dilute the signal</strong> and introduce noise.</p>
<p>Please note that these are the primary results and comparisons of models without addressing the imbalanced data issue. Next, we will investigate whether applying weights improves the models and leads to different performance outcomes.</p>
</section>
</section>
<section id="weighted-models" class="level2">
<h2 class="anchored" data-anchor-id="weighted-models">3.3 Weighted models</h2>
<p>As explained in Section <a href="#weighting-methods">1.2 Weighting methods</a>,, we will use a weighting approach to assign more importance to the minority class. To implement this, we adjusted the model code by adding a ‘wt’ parameter and incorporated it into the GLM model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>fit_model_and_get_perf_wt <span class="ot">&lt;-</span> <span class="cf">function</span>(train_data_env, test_data_env, <span class="at">tss_step =</span> <span class="fl">0.01</span>) {</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Load required libraries</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(pROC)    <span class="co"># For AUROC</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(PRROC)   <span class="co"># For AUPR</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1) Copy data</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> train_data_env</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  test_data  <span class="ot">&lt;-</span> test_data_env</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert occrrnS to 0/1 numeric</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  train_data<span class="sc">$</span>occrrnS <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(train_data<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="st">"PRESENT"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  test_data<span class="sc">$</span>occrrnS  <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(test_data<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="st">"PRESENT"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2) Calculate weights: presence gets 1; background gets (prNum / bgNum)</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  prNum <span class="ot">&lt;-</span> <span class="fu">sum</span>(train_data<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  bgNum <span class="ot">&lt;-</span> <span class="fu">sum</span>(train_data<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  wt <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(train_data<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, prNum <span class="sc">/</span> bgNum)</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3) Fit the weighted GLM</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  my_formula <span class="ot">&lt;-</span> occrrnS <span class="sc">~</span> </span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">AusClim_bioclim_03_9s_1976-2005</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">AusClim_bioclim_06_9s_1976-2005</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">AusClim_bioclim_09_9s_1976-2005</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">AusClim_bioclim_15_9s_1976-2005</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">AusClim_bioclim_24_9s_1976-2005</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">AusClim_bioclim_27_9s_1976-2005</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">AusClim_bioclim_29_9s_1976-2005</span><span class="st">`</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">glm</span>(my_formula, <span class="at">data =</span> train_data, <span class="at">weights =</span> wt, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Predict probabilities</span></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>  predicted_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> test_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -----------------------------</span></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PART A: Standard metrics at threshold = 0.5</span></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -----------------------------</span></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>  pred_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predicted_probs <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Force table to have both '0' and '1' levels</span></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>  pred_class_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_class, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>  actual_factor     <span class="ot">&lt;-</span> <span class="fu">factor</span>(test_data<span class="sc">$</span>occrrnS, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>  conf_mat <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> pred_class_factor, <span class="at">Actual =</span> actual_factor)</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Safely extract entries</span></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>  TP <span class="ot">&lt;-</span> conf_mat[<span class="st">"1"</span>,<span class="st">"1"</span>]</span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>  FP <span class="ot">&lt;-</span> conf_mat[<span class="st">"1"</span>,<span class="st">"0"</span>]</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>  FN <span class="ot">&lt;-</span> conf_mat[<span class="st">"0"</span>,<span class="st">"1"</span>]</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>  TN <span class="ot">&lt;-</span> conf_mat[<span class="st">"0"</span>,<span class="st">"0"</span>]</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute standard metrics</span></span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a>  accuracy    <span class="ot">&lt;-</span> (TP <span class="sc">+</span> TN) <span class="sc">/</span> <span class="fu">sum</span>(conf_mat)</span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>  sensitivity <span class="ot">&lt;-</span> TP <span class="sc">/</span> (TP <span class="sc">+</span> FN)  <span class="co"># Recall</span></span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>  specificity <span class="ot">&lt;-</span> TN <span class="sc">/</span> (TN <span class="sc">+</span> FP)</span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a>  precision   <span class="ot">&lt;-</span> TP <span class="sc">/</span> (TP <span class="sc">+</span> FP)</span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a>  f1          <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> precision <span class="sc">*</span> sensitivity <span class="sc">/</span> (precision <span class="sc">+</span> sensitivity)</span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -----------------------------</span></span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PART B: Additional Metrics</span></span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -----------------------------</span></span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># AUROC</span></span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a>  roc_curve <span class="ot">&lt;-</span> pROC<span class="sc">::</span><span class="fu">roc</span>(<span class="at">response =</span> test_data<span class="sc">$</span>occrrnS, <span class="at">predictor =</span> predicted_probs)</span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a>  auc_value <span class="ot">&lt;-</span> pROC<span class="sc">::</span><span class="fu">auc</span>(roc_curve)</span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># AUPR (Area Under Precision-Recall Curve)</span></span>
<span id="cb46-68"><a href="#cb46-68" aria-hidden="true" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> <span class="fu">pr.curve</span>(<span class="at">scores.class0 =</span> predicted_probs[test_data<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb46-69"><a href="#cb46-69" aria-hidden="true" tabindex="-1"></a>                 <span class="at">scores.class1 =</span> predicted_probs[test_data<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="dv">0</span>],</span>
<span id="cb46-70"><a href="#cb46-70" aria-hidden="true" tabindex="-1"></a>                 <span class="at">curve =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-71"><a href="#cb46-71" aria-hidden="true" tabindex="-1"></a>  aupr_value <span class="ot">&lt;-</span> pr<span class="sc">$</span>auc.integral</span>
<span id="cb46-72"><a href="#cb46-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-73"><a href="#cb46-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Correlation between observed and predicted</span></span>
<span id="cb46-74"><a href="#cb46-74" aria-hidden="true" tabindex="-1"></a>  corr_value <span class="ot">&lt;-</span> <span class="fu">cor</span>(test_data<span class="sc">$</span>occrrnS, predicted_probs, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb46-75"><a href="#cb46-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-76"><a href="#cb46-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -----------------------------</span></span>
<span id="cb46-77"><a href="#cb46-77" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PART C: Sweep thresholds to find max TSS</span></span>
<span id="cb46-78"><a href="#cb46-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -----------------------------</span></span>
<span id="cb46-79"><a href="#cb46-79" aria-hidden="true" tabindex="-1"></a>  compute_tss <span class="ot">&lt;-</span> <span class="cf">function</span>(obs, preds, threshold) {</span>
<span id="cb46-80"><a href="#cb46-80" aria-hidden="true" tabindex="-1"></a>    pred_bin <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(preds <span class="sc">&gt;=</span> threshold, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb46-81"><a href="#cb46-81" aria-hidden="true" tabindex="-1"></a>    TP <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred_bin <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> obs <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb46-82"><a href="#cb46-82" aria-hidden="true" tabindex="-1"></a>    TN <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred_bin <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> obs <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb46-83"><a href="#cb46-83" aria-hidden="true" tabindex="-1"></a>    FP <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred_bin <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> obs <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb46-84"><a href="#cb46-84" aria-hidden="true" tabindex="-1"></a>    FN <span class="ot">&lt;-</span> <span class="fu">sum</span>(pred_bin <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> obs <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb46-85"><a href="#cb46-85" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-86"><a href="#cb46-86" aria-hidden="true" tabindex="-1"></a>    sens <span class="ot">&lt;-</span> <span class="cf">if</span> ((TP <span class="sc">+</span> FN) <span class="sc">&gt;</span> <span class="dv">0</span>) TP <span class="sc">/</span> (TP <span class="sc">+</span> FN) <span class="cf">else</span> <span class="cn">NA</span></span>
<span id="cb46-87"><a href="#cb46-87" aria-hidden="true" tabindex="-1"></a>    spec <span class="ot">&lt;-</span> <span class="cf">if</span> ((TN <span class="sc">+</span> FP) <span class="sc">&gt;</span> <span class="dv">0</span>) TN <span class="sc">/</span> (TN <span class="sc">+</span> FP) <span class="cf">else</span> <span class="cn">NA</span></span>
<span id="cb46-88"><a href="#cb46-88" aria-hidden="true" tabindex="-1"></a>    tss_val <span class="ot">&lt;-</span> sens <span class="sc">+</span> spec <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb46-89"><a href="#cb46-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">sensitivity =</span> sens, <span class="at">specificity =</span> spec, <span class="at">TSS =</span> tss_val))</span>
<span id="cb46-90"><a href="#cb46-90" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-91"><a href="#cb46-91" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-92"><a href="#cb46-92" aria-hidden="true" tabindex="-1"></a>  thresholds <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> tss_step)</span>
<span id="cb46-93"><a href="#cb46-93" aria-hidden="true" tabindex="-1"></a>  tss_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb46-94"><a href="#cb46-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">threshold   =</span> thresholds,</span>
<span id="cb46-95"><a href="#cb46-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">sensitivity =</span> <span class="cn">NA</span>,</span>
<span id="cb46-96"><a href="#cb46-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">specificity =</span> <span class="cn">NA</span>,</span>
<span id="cb46-97"><a href="#cb46-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">TSS         =</span> <span class="cn">NA</span></span>
<span id="cb46-98"><a href="#cb46-98" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-99"><a href="#cb46-99" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-100"><a href="#cb46-100" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(thresholds)) {</span>
<span id="cb46-101"><a href="#cb46-101" aria-hidden="true" tabindex="-1"></a>    out_tss <span class="ot">&lt;-</span> <span class="fu">compute_tss</span>(test_data<span class="sc">$</span>occrrnS, predicted_probs, thresholds[i])</span>
<span id="cb46-102"><a href="#cb46-102" aria-hidden="true" tabindex="-1"></a>    tss_df<span class="sc">$</span>sensitivity[i] <span class="ot">&lt;-</span> out_tss<span class="sc">$</span>sensitivity</span>
<span id="cb46-103"><a href="#cb46-103" aria-hidden="true" tabindex="-1"></a>    tss_df<span class="sc">$</span>specificity[i] <span class="ot">&lt;-</span> out_tss<span class="sc">$</span>specificity</span>
<span id="cb46-104"><a href="#cb46-104" aria-hidden="true" tabindex="-1"></a>    tss_df<span class="sc">$</span>TSS[i]         <span class="ot">&lt;-</span> out_tss<span class="sc">$</span>TSS</span>
<span id="cb46-105"><a href="#cb46-105" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-106"><a href="#cb46-106" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-107"><a href="#cb46-107" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify threshold that yields the maximum TSS</span></span>
<span id="cb46-108"><a href="#cb46-108" aria-hidden="true" tabindex="-1"></a>  max_idx <span class="ot">&lt;-</span> <span class="fu">which.max</span>(tss_df<span class="sc">$</span>TSS)</span>
<span id="cb46-109"><a href="#cb46-109" aria-hidden="true" tabindex="-1"></a>  best_threshold <span class="ot">&lt;-</span> tss_df<span class="sc">$</span>threshold[max_idx]</span>
<span id="cb46-110"><a href="#cb46-110" aria-hidden="true" tabindex="-1"></a>  best_tss       <span class="ot">&lt;-</span> tss_df<span class="sc">$</span>TSS[max_idx]</span>
<span id="cb46-111"><a href="#cb46-111" aria-hidden="true" tabindex="-1"></a>  best_sens      <span class="ot">&lt;-</span> tss_df<span class="sc">$</span>sensitivity[max_idx]</span>
<span id="cb46-112"><a href="#cb46-112" aria-hidden="true" tabindex="-1"></a>  best_spec      <span class="ot">&lt;-</span> tss_df<span class="sc">$</span>specificity[max_idx]</span>
<span id="cb46-113"><a href="#cb46-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-114"><a href="#cb46-114" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -----------------------------</span></span>
<span id="cb46-115"><a href="#cb46-115" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PART D: Return all metrics</span></span>
<span id="cb46-116"><a href="#cb46-116" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -----------------------------</span></span>
<span id="cb46-117"><a href="#cb46-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb46-118"><a href="#cb46-118" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Model and predictions</span></span>
<span id="cb46-119"><a href="#cb46-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">model              =</span> model,</span>
<span id="cb46-120"><a href="#cb46-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">predicted_probs    =</span> predicted_probs,</span>
<span id="cb46-121"><a href="#cb46-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">roc_obj            =</span> roc_curve,</span>
<span id="cb46-122"><a href="#cb46-122" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-123"><a href="#cb46-123" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Evaluation Metrics</span></span>
<span id="cb46-124"><a href="#cb46-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">auc                =</span> <span class="fu">as.numeric</span>(auc_value),   <span class="co"># AUROC</span></span>
<span id="cb46-125"><a href="#cb46-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">aupr               =</span> <span class="fu">as.numeric</span>(aupr_value),  <span class="co"># AUPR</span></span>
<span id="cb46-126"><a href="#cb46-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">corr               =</span> corr_value,              <span class="co"># Correlation</span></span>
<span id="cb46-127"><a href="#cb46-127" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-128"><a href="#cb46-128" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Confusion Matrix at threshold 0.5</span></span>
<span id="cb46-129"><a href="#cb46-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">confusion_matrix_0.5 =</span> conf_mat,</span>
<span id="cb46-130"><a href="#cb46-130" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-131"><a href="#cb46-131" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Metrics at threshold 0.5</span></span>
<span id="cb46-132"><a href="#cb46-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics_0.5 =</span> <span class="fu">data.frame</span>(</span>
<span id="cb46-133"><a href="#cb46-133" aria-hidden="true" tabindex="-1"></a>      <span class="at">Accuracy     =</span> accuracy,</span>
<span id="cb46-134"><a href="#cb46-134" aria-hidden="true" tabindex="-1"></a>      <span class="at">Sensitivity  =</span> sensitivity,  <span class="co"># Recall</span></span>
<span id="cb46-135"><a href="#cb46-135" aria-hidden="true" tabindex="-1"></a>      <span class="at">Specificity  =</span> specificity,</span>
<span id="cb46-136"><a href="#cb46-136" aria-hidden="true" tabindex="-1"></a>      <span class="at">Precision    =</span> precision,</span>
<span id="cb46-137"><a href="#cb46-137" aria-hidden="true" tabindex="-1"></a>      <span class="at">F1           =</span> f1</span>
<span id="cb46-138"><a href="#cb46-138" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-139"><a href="#cb46-139" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-140"><a href="#cb46-140" aria-hidden="true" tabindex="-1"></a>    <span class="co"># TSS sweep results</span></span>
<span id="cb46-141"><a href="#cb46-141" aria-hidden="true" tabindex="-1"></a>    <span class="at">tss_table      =</span> tss_df,</span>
<span id="cb46-142"><a href="#cb46-142" aria-hidden="true" tabindex="-1"></a>    <span class="at">best_threshold =</span> best_threshold,</span>
<span id="cb46-143"><a href="#cb46-143" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_tss        =</span> best_tss,</span>
<span id="cb46-144"><a href="#cb46-144" aria-hidden="true" tabindex="-1"></a>    <span class="at">best_sensitivity =</span> best_sens,</span>
<span id="cb46-145"><a href="#cb46-145" aria-hidden="true" tabindex="-1"></a>    <span class="at">best_specificity =</span> best_spec</span>
<span id="cb46-146"><a href="#cb46-146" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb46-147"><a href="#cb46-147" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Run models with our three pairs of data and extract the evaluation metrics of these models.</p>
<ul>
<li><p>Split_90_absence_wt: split_90_train &amp; split_90_test</p></li>
<li><p>Split_70_absence_wt: split_70_train &amp; split_70_test</p></li>
<li><p>Split_50_absence_wt: split_50_train &amp; split_50_test</p></li>
</ul>
<p>‘wt’ means weighted.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Fit weighted models for each train/test pair</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>model_including_true_absence_wt <span class="ot">&lt;-</span> <span class="fu">mapply</span>(</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  fit_model_and_get_perf_wt,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_data_env =</span> train_list,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">test_data_env  =</span> test_list,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">SIMPLIFY       =</span> <span class="cn">FALSE</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Build a data frame by extracting each metric from the results</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co">#    Note: 'metrics_0.5' is where threshold=0.5 metrics live.</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>results_including_true_absence_table_wt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">AUC              =</span> <span class="fu">sapply</span>(model_including_true_absence_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>auc),                   <span class="co"># AUROC</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">AUPR             =</span> <span class="fu">sapply</span>(model_including_true_absence_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>aupr),                  <span class="co"># AUPR</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">CORR             =</span> <span class="fu">sapply</span>(model_including_true_absence_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>corr),                  <span class="co"># Correlation</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Accuracy         =</span> <span class="fu">sapply</span>(model_including_true_absence_wt, <span class="cf">function</span>(x) x<span class="sc">$</span><span class="st">`</span><span class="at">metrics_0.5</span><span class="st">`</span><span class="sc">$</span>Accuracy),</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sensitivity      =</span> <span class="fu">sapply</span>(model_including_true_absence_wt, <span class="cf">function</span>(x) x<span class="sc">$</span><span class="st">`</span><span class="at">metrics_0.5</span><span class="st">`</span><span class="sc">$</span>Sensitivity),  <span class="co"># Recall</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Specificity      =</span> <span class="fu">sapply</span>(model_including_true_absence_wt, <span class="cf">function</span>(x) x<span class="sc">$</span><span class="st">`</span><span class="at">metrics_0.5</span><span class="st">`</span><span class="sc">$</span>Specificity),</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Precision        =</span> <span class="fu">sapply</span>(model_including_true_absence_wt, <span class="cf">function</span>(x) x<span class="sc">$</span><span class="st">`</span><span class="at">metrics_0.5</span><span class="st">`</span><span class="sc">$</span>Precision),</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">F1               =</span> <span class="fu">sapply</span>(model_including_true_absence_wt, <span class="cf">function</span>(x) x<span class="sc">$</span><span class="st">`</span><span class="at">metrics_0.5</span><span class="st">`</span><span class="sc">$</span>F1),</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Best_Threshold   =</span> <span class="fu">sapply</span>(model_including_true_absence_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>best_threshold),</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max_TSS          =</span> <span class="fu">sapply</span>(model_including_true_absence_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>max_tss),</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">Best_Sensitivity =</span> <span class="fu">sapply</span>(model_including_true_absence_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>best_sensitivity),</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Best_Specificity =</span> <span class="fu">sapply</span>(model_including_true_absence_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>best_specificity)</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can print the evaluation metrics of all three models in one table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Round numeric values to 3 decimal places</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>results_including_true_absence_table_wt <span class="ot">&lt;-</span> results_including_true_absence_table_wt <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">3</span>)))</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the table with smaller font</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>results_including_true_absence_table_wt <span class="sc">%&gt;%</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="st">"html"</span>, <span class="at">caption =</span> <span class="st">"Model Evaluation Metrics"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">12</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Model Evaluation Metrics</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AUC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AUPR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CORR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Accuracy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sensitivity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Specificity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Precision</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">F1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Best_Threshold</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Max_TSS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Best_Sensitivity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Best_Specificity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">split_90_train</td>
<td style="text-align: right;">0.679</td>
<td style="text-align: right;">0.678</td>
<td style="text-align: right;">0.281</td>
<td style="text-align: right;">0.607</td>
<td style="text-align: right;">0.779</td>
<td style="text-align: right;">0.434</td>
<td style="text-align: right;">0.579</td>
<td style="text-align: right;">0.664</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.295</td>
<td style="text-align: right;">0.557</td>
<td style="text-align: right;">0.738</td>
</tr>
<tr class="even">
<td style="text-align: left;">split_70_train</td>
<td style="text-align: right;">0.697</td>
<td style="text-align: right;">0.690</td>
<td style="text-align: right;">0.336</td>
<td style="text-align: right;">0.647</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.621</td>
<td style="text-align: right;">0.640</td>
<td style="text-align: right;">0.656</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.295</td>
<td style="text-align: right;">0.705</td>
<td style="text-align: right;">0.589</td>
</tr>
<tr class="odd">
<td style="text-align: left;">split_50_train</td>
<td style="text-align: right;">0.670</td>
<td style="text-align: right;">0.647</td>
<td style="text-align: right;">0.297</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.324</td>
<td style="text-align: right;">0.838</td>
<td style="text-align: right;">0.485</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="general-trends-across-weighted-models" class="level3">
<h3 class="anchored" data-anchor-id="general-trends-across-weighted-models">3.3.1 General Trends Across Weighted Models</h3>
<p><strong>Best Overall Performer:</strong></p>
<ul>
<li><strong>split_70_train</strong> consistently shows the strongest performance across most metrics, striking a balance between sensitivity and specificity while achieving the highest <strong>AUC (0.697)</strong> and <strong>AUPR (0.690)</strong>.</li>
</ul>
<p><strong>Effect of Increasing True-Absence Data:</strong></p>
<p>Increasing the proportion of true-absence data from <strong>10% (split_90)</strong> to <strong>50% (split_50)</strong> shows mixed effects:</p>
<ul>
<li><p><strong>Discrimination metrics</strong> (AUC, AUPR) improve from split_90 to split_70 but decline slightly in split_50.</p></li>
<li><p><strong>Specificity</strong> improves as more absence data is included, while <strong>sensitivity</strong> tends to decrease.</p></li>
</ul>
</section>
</section>
<section id="comparing-un-weighted-and-weighted-methods." class="level2">
<h2 class="anchored" data-anchor-id="comparing-un-weighted-and-weighted-methods.">3.4 Comparing un-weighted and weighted methods.</h2>
<p>We combine the performance tables of un-weighted and weighted models to see the differences between these two methods.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#combine two evaluation tables</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  results_including_true_absence_table_no_wt <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Source =</span> <span class="st">"No_WT"</span>),</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  results_including_true_absence_table_wt <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Source =</span> <span class="st">"WT"</span>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">3</span>)))</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the table using row names</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(combined_df, <span class="st">"html"</span>, <span class="at">caption =</span> <span class="st">"Model Evaluation Metrics"</span>, <span class="at">rownames =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">12</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Model Evaluation Metrics</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AUC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AUPR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CORR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Accuracy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sensitivity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Specificity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Precision</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">F1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Best_Threshold</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Max_TSS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Best_Sensitivity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Best_Specificity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">split_90_train...1</td>
<td style="text-align: right;">0.661</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">0.143</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">0.172</td>
<td style="text-align: right;">0.852</td>
<td style="text-align: right;">0.320</td>
<td style="text-align: left;">No_WT</td>
</tr>
<tr class="even">
<td style="text-align: left;">split_70_train...2</td>
<td style="text-align: right;">0.695</td>
<td style="text-align: right;">0.688</td>
<td style="text-align: right;">0.325</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">0.284</td>
<td style="text-align: right;">0.716</td>
<td style="text-align: right;">0.568</td>
<td style="text-align: left;">No_WT</td>
</tr>
<tr class="odd">
<td style="text-align: left;">split_50_train...3</td>
<td style="text-align: right;">0.664</td>
<td style="text-align: right;">0.643</td>
<td style="text-align: right;">0.317</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.309</td>
<td style="text-align: right;">0.882</td>
<td style="text-align: right;">0.426</td>
<td style="text-align: left;">No_WT</td>
</tr>
<tr class="even">
<td style="text-align: left;">split_90_train...4</td>
<td style="text-align: right;">0.679</td>
<td style="text-align: right;">0.678</td>
<td style="text-align: right;">0.281</td>
<td style="text-align: right;">0.607</td>
<td style="text-align: right;">0.779</td>
<td style="text-align: right;">0.434</td>
<td style="text-align: right;">0.579</td>
<td style="text-align: right;">0.664</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.295</td>
<td style="text-align: right;">0.557</td>
<td style="text-align: right;">0.738</td>
<td style="text-align: left;">WT</td>
</tr>
<tr class="odd">
<td style="text-align: left;">split_70_train...5</td>
<td style="text-align: right;">0.697</td>
<td style="text-align: right;">0.690</td>
<td style="text-align: right;">0.336</td>
<td style="text-align: right;">0.647</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.621</td>
<td style="text-align: right;">0.640</td>
<td style="text-align: right;">0.656</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.295</td>
<td style="text-align: right;">0.705</td>
<td style="text-align: right;">0.589</td>
<td style="text-align: left;">WT</td>
</tr>
<tr class="even">
<td style="text-align: left;">split_50_train...6</td>
<td style="text-align: right;">0.670</td>
<td style="text-align: right;">0.647</td>
<td style="text-align: right;">0.297</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.324</td>
<td style="text-align: right;">0.838</td>
<td style="text-align: right;">0.485</td>
<td style="text-align: left;">WT</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="results-of-comparison" class="level3">
<h3 class="anchored" data-anchor-id="results-of-comparison">3.4.1 Results of comparison</h3>
<p>By comparing the performance of unweighted and weighted models, we find:</p>
<p>(1) The <strong>weighted models (WT)</strong> significantly outperform the <strong>unweighted models (No_WT)</strong> in terms of <strong>balanced classification</strong>, offering better <strong>specificity</strong>, <strong>F1 scores</strong>, and <strong>TSS</strong> — all while maintaining similar <strong>AUC</strong> and <strong>AUPR</strong>.</p>
<p>(2) <strong>Weighted models improved discrimination</strong> (AUC, AUPR) and provided more <strong>balanced classification</strong> by reducing the bias toward positive predictions.</p>
<p>(3) <strong>Specificity improved significantly</strong>, correcting the unweighted models’ tendency to overpredict presences (<strong>Sensitivity = 1</strong> in unweighted models).</p>
<p>(4) <strong>split_70_train (WT)</strong> provided the most balanced results:</p>
<ul>
<li><p><strong>Highest AUC (0.697)</strong> and <strong>AUPR (0.690)</strong></p></li>
<li><p><strong>Improved Accuracy (0.647)</strong> and <strong>TSS (0.295)</strong></p></li>
<li><p>Balanced <strong>Sensitivity (0.674)</strong> and <strong>Specificity (0.621)</strong></p></li>
</ul>
<p>(5) <strong>Weighting corrected imbalanced data issues</strong>:</p>
<ul>
<li><p>Reduced <strong>false positives</strong> and improved the model’s ability to correctly classify absences.</p></li>
<li><p>Optimal thresholds shifted lower, indicating improved model calibration.</p></li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 36%">
<col style="width: 31%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Metric</strong></th>
<th>Unweighted</th>
<th>Weighted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Sensitivity</strong></td>
<td>Very high (1.0) but at the expense of specificity.</td>
<td>Balanced (~0.58 - 0.77).</td>
</tr>
<tr class="even">
<td><strong>Specificity</strong></td>
<td>Extremely poor (0.0).</td>
<td>Improved (~0.43 - 0.62).</td>
</tr>
<tr class="odd">
<td><strong>AUC / AUPR</strong></td>
<td>Moderate (0.66 - 0.69).</td>
<td>Similar or slightly better (0.67 - 0.70).</td>
</tr>
<tr class="even">
<td><strong>F1 Score</strong></td>
<td>Inflated due to perfect recall but low precision.</td>
<td>More balanced (~0.59 - 0.66).</td>
</tr>
<tr class="odd">
<td><strong>TSS</strong></td>
<td>Low (~0.17 - 0.31), poor model skill.</td>
<td>Higher (~0.29 - 0.32), indicating improved skill.</td>
</tr>
</tbody>
</table>
</section>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">3.4.2 Summary</h3>
<p><strong>Weighting improved overall model performance</strong>, especially in addressing the imbalance between presences and absences.</p>
<p>The <strong>split_70_train (WT)</strong> appears to be the most balanced and effective model.</p>
<p>While <strong>sensitivity</strong> decreased, the gains in <strong>specificity</strong>, <strong>AUC</strong>, and <strong>TSS</strong> suggest more reliable and generalizable&nbsp;</p>
<p><strong>We should always consider weighting methods when the species binary dataset has an imbalance issue.</strong></p>
</section>
</section>
</section>
<section id="background-point-and-pseudo-absence-points" class="level1">
<h1>4. Background point and pseudo-absence points</h1>
<p>In Chapter 3, we explored the scenario where true-absence data is included in the training dataset. However, researchers often lack access to true-absence data when training models, or they may choose to reserve this valuable data for cross-validation purposes, as demonstrated by Elith et al. <span class="citation" data-cites="elith2006novel">(<a href="#ref-elith2006novel" role="doc-biblioref">Elith* et al., 2006</a>)</span> and Valavi et al. <span class="citation" data-cites="valavi2022predictive">(<a href="#ref-valavi2022predictive" role="doc-biblioref">Valavi et al., 2022</a>)</span>.</p>
<p>So, what options do we have when true-absence data isn’t available for training? One common approach is to generate background points or pseudo-absence points and include them in the training dataset as surrogates for true-absence data.</p>
<p>For example, if we allocate all true-absence data along with an equal number of presence records to the test dataset and use the remaining data for training, we would end up with <strong>272 rows</strong> in the test dataset (136 true absences and 136 presences) and <strong>646 rows</strong> in the training dataset. This results in an approximate <strong>30/70</strong> split between test and training data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># Identify indices for ABSENCE and PRESENCE rows</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  abs_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(gang_gang_act<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="st">"ABSENT"</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  pres_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(gang_gang_act<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="st">"PRESENT"</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Number of ABSENCE rows</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  n_abs <span class="ot">&lt;-</span> <span class="fu">length</span>(abs_idx)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set seed for reproducibility and sample PRESENCE rows</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  pres_sample_idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(pres_idx, n_abs)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create subdataframe 1: all ABSENCE rows + sampled PRESENCE rows</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> gang_gang_act[<span class="fu">c</span>(abs_idx, pres_sample_idx), ]</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create subdataframe 2: the remaining rows</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> gang_gang_act[<span class="sc">-</span><span class="fu">c</span>(abs_idx, pres_sample_idx), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get bounding box from the ACT boundary</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>act_bbox <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_bbox</span>(ACT)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of points in train and test datasets</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>n_train <span class="ot">&lt;-</span> <span class="fu">nrow</span>(train_data)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>n_test <span class="ot">&lt;-</span> <span class="fu">nrow</span>(test_data)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create ggplot for the training data with count annotation</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>p_train <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> ACT, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> train_data, <span class="fu">aes</span>(<span class="at">color =</span> occrrnS)) <span class="sc">+</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"PRESENT"</span> <span class="ot">=</span> <span class="st">"#11aa96"</span>, <span class="st">"ABSENT"</span> <span class="ot">=</span> <span class="st">"#f6aa70"</span>)) <span class="sc">+</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Training Data (n ="</span>, n_train, <span class="st">")"</span>)) <span class="sc">+</span>  <span class="co"># Add count to title</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(act_bbox[<span class="st">"xmin"</span>], act_bbox[<span class="st">"xmax"</span>]), </span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(act_bbox[<span class="st">"ymin"</span>], act_bbox[<span class="st">"ymax"</span>])</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Create ggplot for the test data with count annotation</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>p_test <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> ACT, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> test_data, <span class="fu">aes</span>(<span class="at">color =</span> occrrnS)) <span class="sc">+</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"PRESENT"</span> <span class="ot">=</span> <span class="st">"#11aa96"</span>, <span class="st">"ABSENT"</span> <span class="ot">=</span> <span class="st">"#f6aa70"</span>)) <span class="sc">+</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Test Data (n ="</span>, n_test, <span class="st">", 1:1)"</span>)) <span class="sc">+</span>  <span class="co"># Add count to title</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(act_bbox[<span class="st">"xmin"</span>], act_bbox[<span class="st">"xmax"</span>]), </span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(act_bbox[<span class="st">"ymin"</span>], act_bbox[<span class="st">"ymax"</span>])</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the two plots side-by-side</span></span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> p_train <span class="sc">+</span> p_test <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>combined_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="imbalanced_data_files/figure-html/plot_training_test-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="random-background-points" class="level2">
<h2 class="anchored" data-anchor-id="random-background-points">4.1 Random background points</h2>
<p>Many studies suggest that the number of background points should be sufficient to comprehensively sample and represent all environments in the study area, or at least a range of background point sizes should be tested. For example, Valavi et al. <span class="citation" data-cites="valavi2022predictive">(<a href="#ref-valavi2022predictive" role="doc-biblioref">Valavi et al., 2022</a>)</span> tested their models with <strong>100 to 100,000 background points</strong>. Barbet-Massin et al. <span class="citation" data-cites="barbet2012selecting">(<a href="#ref-barbet2012selecting" role="doc-biblioref">Barbet-Massin et al., 2012</a>)</span> tested 100, 300, 1000, 3000 or 10000 <strong>background points</strong>.</p>
<p>We here will also test the effect of different sizes of background points on the performance of models. We will test the ratio of background points to true presences from 1:1, 5:1, 10:1, 15:1, 20:1, 30:1, and 50:1 <strong>with and without weighting methods</strong>.</p>
<p>This is the function generating required number of random background points within the extent of the study area.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert SpatRaster to Raster</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>studyarea <span class="ot">&lt;-</span> <span class="fu">raster</span>(env_var_stack<span class="sc">$</span><span class="st">`</span><span class="at">AusClim_bioclim_01_9s_1976-2005</span><span class="st">`</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of presence points in train_data (assuming presence is coded as 1)</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>n_pres <span class="ot">&lt;-</span> <span class="fu">nrow</span>(train_data)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1963</span>)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate background points with a 1:1 ratio</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>random_bg_1to1 <span class="ot">&lt;-</span> <span class="fu">randomPoints</span>(studyarea, n_pres)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate background points with a 5:1 ratio</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>random_bg_5to1 <span class="ot">&lt;-</span> <span class="fu">randomPoints</span>(studyarea, n_pres <span class="sc">*</span> <span class="dv">5</span>)</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate background points with a 10:1 ratio</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>random_bg_10to1 <span class="ot">&lt;-</span> <span class="fu">randomPoints</span>(studyarea, n_pres <span class="sc">*</span> <span class="dv">10</span>)</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate background points with a 15:1 ratio</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>random_bg_15to1 <span class="ot">&lt;-</span> <span class="fu">randomPoints</span>(studyarea, n_pres <span class="sc">*</span> <span class="dv">15</span>)</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate background points with a 20:1 ratio</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>random_bg_20to1 <span class="ot">&lt;-</span> <span class="fu">randomPoints</span>(studyarea, n_pres <span class="sc">*</span> <span class="dv">20</span>)</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate background points with a 30:1 ratio</span></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>random_bg_30to1 <span class="ot">&lt;-</span> <span class="fu">randomPoints</span>(studyarea, n_pres <span class="sc">*</span> <span class="dv">30</span>)</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate background points with a 100:1 ratio</span></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>random_bg_50to1 <span class="ot">&lt;-</span> <span class="fu">randomPoints</span>(studyarea, n_pres <span class="sc">*</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>combine_bg_with_presence <span class="ot">&lt;-</span> <span class="cf">function</span>(bg_points, train_data, raster_obj, <span class="at">target_crs =</span> <span class="dv">4283</span>, <span class="at">occ_label =</span> <span class="st">"bg"</span>) {</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert the background points matrix to a data frame</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  bg_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(bg_points)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the occrrnS column with the specified label (e.g., "bg")</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  bg_df<span class="sc">$</span>occrrnS <span class="ot">&lt;-</span> occ_label</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert the data frame to an sf object using the raster's projection</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  bg_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(bg_df, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>), <span class="at">crs =</span> <span class="fu">projection</span>(raster_obj))</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Transform the sf object to the target CRS (default is EPSG:4283)</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  bg_sf_target <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(bg_sf, <span class="at">crs =</span> target_crs)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the original (presence) data with the background points</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">rbind</span>(train_data, bg_sf_target)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(combined)</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then combine the generated background points with true present data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>combined_random_bg_1to1 <span class="ot">&lt;-</span> <span class="fu">combine_bg_with_presence</span>(random_bg_1to1, train_data, studyarea)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>combined_random_bg_5to1 <span class="ot">&lt;-</span> <span class="fu">combine_bg_with_presence</span>(random_bg_5to1, train_data, studyarea)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>combined_random_bg_10to1 <span class="ot">&lt;-</span> <span class="fu">combine_bg_with_presence</span>(random_bg_10to1, train_data, studyarea)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>combined_random_bg_15to1 <span class="ot">&lt;-</span> <span class="fu">combine_bg_with_presence</span>(random_bg_15to1, train_data, studyarea)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>combined_random_bg_20to1 <span class="ot">&lt;-</span> <span class="fu">combine_bg_with_presence</span>(random_bg_20to1, train_data, studyarea)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>combined_random_bg_30to1 <span class="ot">&lt;-</span> <span class="fu">combine_bg_with_presence</span>(random_bg_30to1, train_data, studyarea)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>combined_random_bg_50to1 <span class="ot">&lt;-</span> <span class="fu">combine_bg_with_presence</span>(random_bg_50to1, train_data, studyarea)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>create_map_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(bg_sf, title, <span class="at">point_size =</span> <span class="fl">0.5</span>) {</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure correct factor levels</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  bg_sf<span class="sc">$</span>occrrnS <span class="ot">&lt;-</span> <span class="fu">factor</span>(bg_sf<span class="sc">$</span>occrrnS, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PRESENT"</span>, <span class="st">"bg"</span>))</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Split the data into background and present points</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  bg_only <span class="ot">&lt;-</span> bg_sf[bg_sf<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="st">"bg"</span>, ]</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  present_only <span class="ot">&lt;-</span> bg_sf[bg_sf<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="st">"PRESENT"</span>, ]</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add the ACT polygon layer (without including it in the legend)</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> ACT, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot background points first with mapped color</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> bg_only, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Background Points"</span>), <span class="at">size =</span> point_size, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot present points on top with mapped color</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> present_only, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Present"</span>), <span class="at">size =</span> point_size, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Manual color mapping</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Group"</span>,</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Present"</span> <span class="ot">=</span> <span class="st">"#11aa96"</span>, <span class="st">"Background Points"</span> <span class="ot">=</span> <span class="st">"grey"</span>)</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Legend with larger points</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(title) <span class="sc">+</span></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_sf</span>(<span class="at">lims_method =</span> <span class="st">"geometry_bbox"</span>) <span class="sc">+</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()</span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots for each background ratio</span></span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">create_map_plot</span>(combined_random_bg_1to1, <span class="st">"1:1"</span>, <span class="at">point_size =</span> <span class="fl">0.01</span>)</span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">create_map_plot</span>(combined_random_bg_5to1, <span class="st">"5:1"</span>, <span class="at">point_size =</span> <span class="fl">0.01</span>)</span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">create_map_plot</span>(combined_random_bg_10to1, <span class="st">"10:1"</span>, <span class="at">point_size =</span> <span class="fl">0.01</span>)</span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">create_map_plot</span>(combined_random_bg_15to1, <span class="st">"15:1"</span>, <span class="at">point_size =</span> <span class="fl">0.01</span>)</span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">create_map_plot</span>(combined_random_bg_20to1, <span class="st">"20:1"</span>, <span class="at">point_size =</span> <span class="fl">0.01</span>)</span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> <span class="fu">create_map_plot</span>(combined_random_bg_30to1, <span class="st">"30:1"</span>, <span class="at">point_size =</span> <span class="fl">0.01</span>)</span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span> <span class="fu">create_map_plot</span>(combined_random_bg_50to1, <span class="st">"50:1"</span>, <span class="at">point_size =</span> <span class="fl">0.01</span>)</span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots with a shared legend at the bottom</span></span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> (p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> p5 <span class="sc">+</span> p6 <span class="sc">+</span> p7) <span class="sc">+</span></span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">+</span>  <span class="co"># Collects the legend into one</span></span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>))</span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a>combined_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="imbalanced_data_files/figure-html/plot_ratio-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Then, we combine occurrence data with environmental variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>train_data_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">combined_random_bg_1to1_env =</span> <span class="fu">get_occurrence_data</span>(combined_random_bg_1to1, env_var_stack, <span class="at">dropCols =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)),</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">combined_random_bg_5to1_env =</span> <span class="fu">get_occurrence_data</span>(combined_random_bg_1to1, env_var_stack, <span class="at">dropCols =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)),</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">combined_random_bg_10to1_env =</span> <span class="fu">get_occurrence_data</span>(combined_random_bg_1to1, env_var_stack, <span class="at">dropCols =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)),</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">combined_random_bg_15to1_env =</span> <span class="fu">get_occurrence_data</span>(combined_random_bg_10to1, env_var_stack, <span class="at">dropCols =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)),</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">combined_random_bg_20to1_env =</span> <span class="fu">get_occurrence_data</span>(combined_random_bg_1to1, env_var_stack, <span class="at">dropCols =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)),</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">combined_random_bg_30to1_env =</span> <span class="fu">get_occurrence_data</span>(combined_random_bg_1to1, env_var_stack, <span class="at">dropCols =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)),</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">combined_random_bg_50to1_env =</span> <span class="fu">get_occurrence_data</span>(combined_random_bg_50to1, env_var_stack, <span class="at">dropCols =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>test_data_env <span class="ot">&lt;-</span> <span class="fu">get_occurrence_data</span>(test_data, env_var_stack, <span class="at">dropCols =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When the ratio of background points to true presences exceeds 1:1—such as 5:1, 10:1, 15:1, 20:1, 30:1, and 50:1—an imbalanced dataset issue is introduced. To address this imbalance, we need to use weighting methods.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Fit weighted models and extract results</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>results_list_wt <span class="ot">&lt;-</span> <span class="fu">lapply</span>(train_data_list, <span class="cf">function</span>(train_data) {</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_model_and_get_perf_wt</span>(train_data, test_data_env)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Build a data frame by extracting each metric from the results_list_wt</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>results_table_wt_random <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">AUC              =</span> <span class="fu">sapply</span>(results_list_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>auc),                    <span class="co"># AUROC</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">AUPR             =</span> <span class="fu">sapply</span>(results_list_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>aupr),                   <span class="co"># Area Under Precision-Recall Curve</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">CORR             =</span> <span class="fu">sapply</span>(results_list_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>corr),                   <span class="co"># Correlation</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Accuracy         =</span> <span class="fu">sapply</span>(results_list_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>metrics_0<span class="fl">.5</span><span class="sc">$</span>Accuracy),   <span class="co"># Accuracy at threshold 0.5</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sensitivity      =</span> <span class="fu">sapply</span>(results_list_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>metrics_0<span class="fl">.5</span><span class="sc">$</span>Sensitivity),<span class="co"># Sensitivity (Recall)</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Specificity      =</span> <span class="fu">sapply</span>(results_list_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>metrics_0<span class="fl">.5</span><span class="sc">$</span>Specificity),<span class="co"># Specificity</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Precision        =</span> <span class="fu">sapply</span>(results_list_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>metrics_0<span class="fl">.5</span><span class="sc">$</span>Precision),  <span class="co"># Precision</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">F1               =</span> <span class="fu">sapply</span>(results_list_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>metrics_0<span class="fl">.5</span><span class="sc">$</span>F1),         <span class="co"># F1 Score</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Best_Threshold   =</span> <span class="fu">sapply</span>(results_list_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>best_threshold),         <span class="co"># Best threshold based on TSS</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max_TSS          =</span> <span class="fu">sapply</span>(results_list_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>max_tss),                <span class="co"># Maximum TSS</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Best_Sensitivity =</span> <span class="fu">sapply</span>(results_list_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>best_sensitivity),       <span class="co"># Sensitivity at Best Threshold</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Best_Specificity =</span> <span class="fu">sapply</span>(results_list_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>best_specificity)        <span class="co"># Specificity at Best Threshold</span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Print the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Round numeric values to 3 decimal places</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>results_table_wt_random <span class="ot">&lt;-</span> results_table_wt_random <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">3</span>)))</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the table with smaller font</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>results_table_wt_random <span class="sc">%&gt;%</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="st">"html"</span>, <span class="at">caption =</span> <span class="st">"Model Evaluation Metrics"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">12</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Model Evaluation Metrics</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AUC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AUPR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CORR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Accuracy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sensitivity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Specificity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Precision</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">F1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Best_Threshold</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Max_TSS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Best_Sensitivity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Best_Specificity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">combined_random_bg_1to1_env</td>
<td style="text-align: right;">0.580</td>
<td style="text-align: right;">0.569</td>
<td style="text-align: right;">0.116</td>
<td style="text-align: right;">0.562</td>
<td style="text-align: right;">0.713</td>
<td style="text-align: right;">0.412</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right;">0.456</td>
<td style="text-align: right;">0.699</td>
</tr>
<tr class="even">
<td style="text-align: left;">combined_random_bg_5to1_env</td>
<td style="text-align: right;">0.580</td>
<td style="text-align: right;">0.569</td>
<td style="text-align: right;">0.116</td>
<td style="text-align: right;">0.562</td>
<td style="text-align: right;">0.713</td>
<td style="text-align: right;">0.412</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right;">0.456</td>
<td style="text-align: right;">0.699</td>
</tr>
<tr class="odd">
<td style="text-align: left;">combined_random_bg_10to1_env</td>
<td style="text-align: right;">0.580</td>
<td style="text-align: right;">0.569</td>
<td style="text-align: right;">0.116</td>
<td style="text-align: right;">0.562</td>
<td style="text-align: right;">0.713</td>
<td style="text-align: right;">0.412</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right;">0.456</td>
<td style="text-align: right;">0.699</td>
</tr>
<tr class="even">
<td style="text-align: left;">combined_random_bg_15to1_env</td>
<td style="text-align: right;">0.568</td>
<td style="text-align: right;">0.563</td>
<td style="text-align: right;">0.090</td>
<td style="text-align: right;">0.537</td>
<td style="text-align: right;">0.669</td>
<td style="text-align: right;">0.404</td>
<td style="text-align: right;">0.529</td>
<td style="text-align: right;">0.591</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.176</td>
<td style="text-align: right;">0.324</td>
<td style="text-align: right;">0.853</td>
</tr>
<tr class="odd">
<td style="text-align: left;">combined_random_bg_20to1_env</td>
<td style="text-align: right;">0.580</td>
<td style="text-align: right;">0.569</td>
<td style="text-align: right;">0.116</td>
<td style="text-align: right;">0.562</td>
<td style="text-align: right;">0.713</td>
<td style="text-align: right;">0.412</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right;">0.456</td>
<td style="text-align: right;">0.699</td>
</tr>
<tr class="even">
<td style="text-align: left;">combined_random_bg_30to1_env</td>
<td style="text-align: right;">0.580</td>
<td style="text-align: right;">0.569</td>
<td style="text-align: right;">0.116</td>
<td style="text-align: right;">0.562</td>
<td style="text-align: right;">0.713</td>
<td style="text-align: right;">0.412</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right;">0.456</td>
<td style="text-align: right;">0.699</td>
</tr>
<tr class="odd">
<td style="text-align: left;">combined_random_bg_50to1_env</td>
<td style="text-align: right;">0.571</td>
<td style="text-align: right;">0.559</td>
<td style="text-align: right;">0.097</td>
<td style="text-align: right;">0.533</td>
<td style="text-align: right;">0.662</td>
<td style="text-align: right;">0.404</td>
<td style="text-align: right;">0.526</td>
<td style="text-align: right;">0.586</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">0.162</td>
<td style="text-align: right;">0.331</td>
<td style="text-align: right;">0.831</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="results" class="level3">
<h3 class="anchored" data-anchor-id="results">4.1.1 Results</h3>
<ol type="1">
<li><strong>Background Ratios up to 10:1</strong></li>
</ol>
<ul>
<li>Metrics remain stable with minimal changes, indicating the model is robust to moderate increases in background points.</li>
</ul>
<p>(2) <strong>High Background Ratios (15:1 and 50:1)</strong></p>
<ul>
<li><p>Sensitivity and precision decline, leading to lower F1 scores.</p></li>
<li><p>Specificity improves, but at the cost of missing more true positives.</p></li>
</ul>
<p>(3) <strong>Overall Performance:</strong></p>
<ul>
<li><p>Increasing background points beyond <strong>10:1</strong> introduces diminishing returns and eventually harms model balance.</p></li>
<li><p>A ratio of <strong>5:1 to 10:1</strong> appears to be a sweet spot, maintaining good sensitivity and specificity without introducing severe imbalances.</p></li>
</ul>
</section>
<section id="summary-1" class="level3">
<h3 class="anchored" data-anchor-id="summary-1">4.1.2 Summary</h3>
<p>(1) <strong>Increasing background points beyond a 10:1 ratio does not consistently improve model performance</strong> and may even reduce sensitivity and overall balance.</p>
<p>(2) <strong>Moderate background ratios (5:1 to 10:1)</strong> provide a balance between sufficient background sampling and maintaining model sensitivity.</p>
<p>(3) At <strong>very high ratios (15:1 and 50:1)</strong>, the model starts favoring background points, leading to poorer detection of presences.</p>
</section>
</section>
<section id="the-disk-approach" class="level2">
<h2 class="anchored" data-anchor-id="the-disk-approach">4.2 The ‘disk’ approach</h2>
<p>Besides completely random background points, we will also test a ‘disk’ approach to generate random background point methods within a defined range around present records. As the below figure shown, these rings indicate potential areas where <strong>pseudo-absence points</strong> can be sampled, simulating <strong>absence data</strong> when real absences are unavailable.</p>
<p><img src="https://raw.githubusercontent.com/EcoCommons-Australia-2024-2026/ec-notebook_site/main/images/Gang_gang_buffer.png" class="img-fluid"></p>
<p>First, we extract present data from the training dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>presence_in_train_data <span class="ot">&lt;-</span> train_data[train_data<span class="sc">$</span>occrrnS <span class="sc">==</span> <span class="st">"PRESENT"</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function generating background points in a defined disk round the presence data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Generate random-buffer pseudo-absences within a study area</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>generate_pseudo_absences_random_buffer <span class="ot">&lt;-</span> <span class="cf">function</span>(presence_in_train_data, </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                                                   study_area,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                                                   min_buffer, max_buffer, </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                                                   n_points_per_presence, </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">seed =</span> <span class="dv">123</span>) {</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  pseudo_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(presence_in_train_data)), <span class="cf">function</span>(i) {</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Random distance for this presence point</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    random_buffer <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> min_buffer, <span class="at">max =</span> max_buffer)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the buffer polygon</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>    buffer_poly <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(presence_in_train_data[i, ], <span class="at">dist =</span> random_buffer)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Intersect buffer with study_area, so we only sample inside it</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>    intersection_poly <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(buffer_poly, study_area)</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If there's no overlap, return NULL</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">st_is_empty</span>(intersection_poly)) {</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Sample points inside the intersection</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">st_sample</span>(intersection_poly, <span class="at">size =</span> n_points_per_presence, <span class="at">type =</span> <span class="st">"random"</span>)</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine into an sfc</span></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>  pseudo_sfc <span class="ot">&lt;-</span> <span class="fu">do.call</span>(c, pseudo_list)</span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If all overlaps were empty, pseudo_sfc is NULL</span></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(pseudo_sfc)) {</span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert sfc to sf</span></span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a>  pseudo_sf <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(<span class="at">geometry =</span> pseudo_sfc)</span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Label them as "bg"</span></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a>  pseudo_sf<span class="sc">$</span>occrrnS <span class="ot">&lt;-</span> <span class="st">"bg"</span></span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Keep only the occrrnS column</span></span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>  pseudo_sf <span class="ot">&lt;-</span> pseudo_sf[, <span class="st">"occrrnS"</span>, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pseudo_sf)</span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Combine pseudo-absences with original data</span></span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a>generate_and_combine_pseudo_absences <span class="ot">&lt;-</span> <span class="cf">function</span>(presence_in_train_data, </span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a>                                                 train_data,</span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a>                                                 study_area,</span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a>                                                 min_buffer, max_buffer, </span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a>                                                 n_points_per_presence, </span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">seed =</span> <span class="dv">123</span>, </span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">target_crs =</span> <span class="dv">4283</span>) {</span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make sure everything is in the same CRS before buffering/intersecting</span></span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a>  presence_in_train_data <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(presence_in_train_data, target_crs)</span>
<span id="cb60-57"><a href="#cb60-57" aria-hidden="true" tabindex="-1"></a>  study_area <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(study_area, target_crs)</span>
<span id="cb60-58"><a href="#cb60-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-59"><a href="#cb60-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate pseudo-absence points</span></span>
<span id="cb60-60"><a href="#cb60-60" aria-hidden="true" tabindex="-1"></a>  pseudo_sf <span class="ot">&lt;-</span> <span class="fu">generate_pseudo_absences_random_buffer</span>(</span>
<span id="cb60-61"><a href="#cb60-61" aria-hidden="true" tabindex="-1"></a>    presence_in_train_data, </span>
<span id="cb60-62"><a href="#cb60-62" aria-hidden="true" tabindex="-1"></a>    study_area,</span>
<span id="cb60-63"><a href="#cb60-63" aria-hidden="true" tabindex="-1"></a>    min_buffer, max_buffer, </span>
<span id="cb60-64"><a href="#cb60-64" aria-hidden="true" tabindex="-1"></a>    n_points_per_presence, </span>
<span id="cb60-65"><a href="#cb60-65" aria-hidden="true" tabindex="-1"></a>    seed</span>
<span id="cb60-66"><a href="#cb60-66" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-67"><a href="#cb60-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-68"><a href="#cb60-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert and combine</span></span>
<span id="cb60-69"><a href="#cb60-69" aria-hidden="true" tabindex="-1"></a>  original_data <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(train_data, target_crs)</span>
<span id="cb60-70"><a href="#cb60-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-71"><a href="#cb60-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If pseudo_sf is NULL (no overlap found), just return original</span></span>
<span id="cb60-72"><a href="#cb60-72" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(pseudo_sf)) {</span>
<span id="cb60-73"><a href="#cb60-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"No pseudo-absence points generated (buffers might lie outside the study area)."</span>)</span>
<span id="cb60-74"><a href="#cb60-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(original_data)</span>
<span id="cb60-75"><a href="#cb60-75" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-76"><a href="#cb60-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-77"><a href="#cb60-77" aria-hidden="true" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">rbind</span>(original_data, pseudo_sf)</span>
<span id="cb60-78"><a href="#cb60-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(combined)</span>
<span id="cb60-79"><a href="#cb60-79" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Generate background points within these ranges around present records of Gang-gang Cockatoo in the training dataset:</p>
<ul>
<li><p><strong>Within 500m</strong></p></li>
<li><p><strong>500 - 1000m</strong></p></li>
<li><p><strong>1000 - 1500m</strong></p></li>
<li><p><strong>1500 - 2000m</strong></p></li>
<li><p><strong>More than 2000m</strong></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>({ <span class="co"># We want to suppress some irrelevant warnings</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  disk_bg_500 <span class="ot">&lt;-</span> <span class="fu">generate_and_combine_pseudo_absences</span>(</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    presence_in_train_data,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    train_data, </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_buffer =</span> <span class="dv">0</span>, </span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_buffer =</span> <span class="dv">500</span>, </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_points_per_presence =</span> <span class="dv">1</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">study_area =</span> ACT,</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">target_crs =</span> <span class="dv">4283</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  disk_bg_500_1000 <span class="ot">&lt;-</span> <span class="fu">generate_and_combine_pseudo_absences</span>(</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>    presence_in_train_data,</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>    train_data, </span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_buffer =</span> <span class="dv">500</span>, </span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_buffer =</span> <span class="dv">1000</span>, </span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_points_per_presence =</span> <span class="dv">1</span>,</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">study_area =</span> ACT,</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">target_crs =</span> <span class="dv">4283</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>  disk_bg_1000_1500 <span class="ot">&lt;-</span> <span class="fu">generate_and_combine_pseudo_absences</span>(</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>    presence_in_train_data,</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>    train_data, </span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_buffer =</span> <span class="dv">1000</span>, </span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_buffer =</span> <span class="dv">1500</span>, </span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_points_per_presence =</span> <span class="dv">1</span>,</span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">study_area =</span> ACT,</span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">target_crs =</span> <span class="dv">4283</span></span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a>  disk_bg_1500_2000 <span class="ot">&lt;-</span> <span class="fu">generate_and_combine_pseudo_absences</span>(</span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a>    presence_in_train_data,</span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a>    train_data, </span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_buffer =</span> <span class="dv">1500</span>, </span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_buffer =</span> <span class="dv">2000</span>,</span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_points_per_presence =</span> <span class="dv">1</span>, </span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">123</span>, </span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">study_area =</span> ACT,</span>
<span id="cb61-44"><a href="#cb61-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">target_crs =</span> <span class="dv">4283</span></span>
<span id="cb61-45"><a href="#cb61-45" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-46"><a href="#cb61-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-47"><a href="#cb61-47" aria-hidden="true" tabindex="-1"></a>  disk_bg_2000 <span class="ot">&lt;-</span> <span class="fu">generate_and_combine_pseudo_absences</span>(</span>
<span id="cb61-48"><a href="#cb61-48" aria-hidden="true" tabindex="-1"></a>    presence_in_train_data,</span>
<span id="cb61-49"><a href="#cb61-49" aria-hidden="true" tabindex="-1"></a>    train_data, </span>
<span id="cb61-50"><a href="#cb61-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_buffer =</span> <span class="dv">2000</span>, </span>
<span id="cb61-51"><a href="#cb61-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_buffer =</span> <span class="dv">10000</span>,</span>
<span id="cb61-52"><a href="#cb61-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_points_per_presence =</span> <span class="dv">1</span>, </span>
<span id="cb61-53"><a href="#cb61-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">123</span>, </span>
<span id="cb61-54"><a href="#cb61-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">study_area =</span> ACT,</span>
<span id="cb61-55"><a href="#cb61-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">target_crs =</span> <span class="dv">4283</span></span>
<span id="cb61-56"><a href="#cb61-56" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-57"><a href="#cb61-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-58"><a href="#cb61-58" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s plot the generated disk background points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots for each background ratio with smaller points</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">create_map_plot</span>(disk_bg_500, <span class="st">"Buffe &lt; 500m"</span>, <span class="at">point_size =</span> <span class="fl">0.01</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">create_map_plot</span>(disk_bg_500_1000, <span class="st">"Buffer 500-1000m"</span>, <span class="at">point_size =</span> <span class="fl">0.01</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">create_map_plot</span>(disk_bg_1000_1500, <span class="st">"Buffer 1000-1500m"</span>, <span class="at">point_size =</span> <span class="fl">0.01</span>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">create_map_plot</span>(disk_bg_1500_2000, <span class="st">"Buffer 1500-2000m"</span>, <span class="at">point_size =</span> <span class="fl">0.01</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">create_map_plot</span>(disk_bg_2000, <span class="st">"Buffer &gt; 2000m"</span>, <span class="at">point_size =</span> <span class="fl">0.01</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the three plots in one row and collect a common legend at the bottom</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> (p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3<span class="sc">+</span> p4 <span class="sc">+</span> p5) <span class="sc">+</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">+</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>))</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>combined_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="imbalanced_data_files/figure-html/plot_disk-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the above figure, we can see that as the range increases, the grey points (background points) move farther away from the present points.</p>
<p>Now, let’s combine the occurrence data with environmental variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>train_data_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">disk_bg_500_env =</span> <span class="fu">get_occurrence_data</span>(disk_bg_500, env_var_stack, <span class="at">dropCols =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)),</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">disk_bg_500_1000_env =</span> <span class="fu">get_occurrence_data</span>(disk_bg_500_1000, env_var_stack, <span class="at">dropCols =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)),</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">disk_bg_1000_1500_env =</span> <span class="fu">get_occurrence_data</span>(disk_bg_1000_1500, env_var_stack, <span class="at">dropCols =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)),</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">disk_bg_1500_2000_env =</span> <span class="fu">get_occurrence_data</span>(disk_bg_1500_2000, env_var_stack, <span class="at">dropCols =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)),</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">disk_bg_2000_env =</span> <span class="fu">get_occurrence_data</span>(disk_bg_2000, env_var_stack, <span class="at">dropCols =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>test_data_env <span class="ot">&lt;-</span> <span class="fu">get_occurrence_data</span>(test_data, env_var_stack, <span class="at">dropCols =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now run the GLM models with these datasets and generate the evaluation metrics. Please note that we created an equal number of background points and present points, so there is no imbalance issue in this case. Thus, we are not using ‘wt’ in the GLM function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>results_list_no_wt <span class="ot">&lt;-</span> <span class="fu">lapply</span>(train_data_list, <span class="cf">function</span>(train_data) {</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_model_and_get_perf_no_wt</span>(train_data, test_data_env)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Build a data frame by extracting each metric from the results_list_wt</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>results_table_no_wt_disk <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">AUC              =</span> <span class="fu">sapply</span>(results_list_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>auc),                    <span class="co"># AUROC</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">AUPR             =</span> <span class="fu">sapply</span>(results_list_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>aupr),                   <span class="co"># Area Under Precision-Recall Curve</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">CORR             =</span> <span class="fu">sapply</span>(results_list_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>corr),                   <span class="co"># Correlation</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Accuracy         =</span> <span class="fu">sapply</span>(results_list_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>metrics_0<span class="fl">.5</span><span class="sc">$</span>Accuracy),   <span class="co"># Accuracy at threshold 0.5</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sensitivity      =</span> <span class="fu">sapply</span>(results_list_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>metrics_0<span class="fl">.5</span><span class="sc">$</span>Sensitivity),<span class="co"># Sensitivity (Recall)</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Specificity      =</span> <span class="fu">sapply</span>(results_list_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>metrics_0<span class="fl">.5</span><span class="sc">$</span>Specificity),<span class="co"># Specificity</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Precision        =</span> <span class="fu">sapply</span>(results_list_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>metrics_0<span class="fl">.5</span><span class="sc">$</span>Precision),  <span class="co"># Precision</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">F1               =</span> <span class="fu">sapply</span>(results_list_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>metrics_0<span class="fl">.5</span><span class="sc">$</span>F1),         <span class="co"># F1 Score</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Best_Threshold   =</span> <span class="fu">sapply</span>(results_list_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>best_threshold),         <span class="co"># Best threshold based on TSS</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max_TSS          =</span> <span class="fu">sapply</span>(results_list_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>max_tss),                <span class="co"># Maximum TSS</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Best_Sensitivity =</span> <span class="fu">sapply</span>(results_list_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>best_sensitivity),       <span class="co"># Sensitivity at Best Threshold</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Best_Specificity =</span> <span class="fu">sapply</span>(results_list_no_wt, <span class="cf">function</span>(x) x<span class="sc">$</span>best_specificity)        <span class="co"># Specificity at Best Threshold</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Print the results of models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Round numeric values to 3 decimal places</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>results_table_no_wt_disk <span class="ot">&lt;-</span> results_table_no_wt_disk <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">3</span>)))</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the table with smaller font</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>results_table_no_wt_disk <span class="sc">%&gt;%</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="st">"html"</span>, <span class="at">caption =</span> <span class="st">"Model Evaluation Metrics"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">12</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Model Evaluation Metrics</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AUC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AUPR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CORR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Accuracy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sensitivity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Specificity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Precision</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">F1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Best_Threshold</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Max_TSS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Best_Sensitivity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Best_Specificity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">disk_bg_500_env</td>
<td style="text-align: right;">0.536</td>
<td style="text-align: right;">0.541</td>
<td style="text-align: right;">0.083</td>
<td style="text-align: right;">0.529</td>
<td style="text-align: right;">0.471</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.533</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.059</td>
<td style="text-align: right;">0.471</td>
<td style="text-align: right;">0.588</td>
</tr>
<tr class="even">
<td style="text-align: left;">disk_bg_500_1000_env</td>
<td style="text-align: right;">0.582</td>
<td style="text-align: right;">0.542</td>
<td style="text-align: right;">0.156</td>
<td style="text-align: right;">0.574</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">0.522</td>
<td style="text-align: right;">0.567</td>
<td style="text-align: right;">0.594</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.147</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">0.522</td>
</tr>
<tr class="odd">
<td style="text-align: left;">disk_bg_1000_1500_env</td>
<td style="text-align: right;">0.560</td>
<td style="text-align: right;">0.526</td>
<td style="text-align: right;">0.096</td>
<td style="text-align: right;">0.540</td>
<td style="text-align: right;">0.471</td>
<td style="text-align: right;">0.610</td>
<td style="text-align: right;">0.547</td>
<td style="text-align: right;">0.506</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.088</td>
<td style="text-align: right;">0.801</td>
<td style="text-align: right;">0.287</td>
</tr>
<tr class="even">
<td style="text-align: left;">disk_bg_1500_2000_env</td>
<td style="text-align: right;">0.542</td>
<td style="text-align: right;">0.495</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.507</td>
<td style="text-align: right;">0.471</td>
<td style="text-align: right;">0.544</td>
<td style="text-align: right;">0.508</td>
<td style="text-align: right;">0.489</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.184</td>
<td style="text-align: right;">0.838</td>
<td style="text-align: right;">0.346</td>
</tr>
<tr class="odd">
<td style="text-align: left;">disk_bg_2000_env</td>
<td style="text-align: right;">0.538</td>
<td style="text-align: right;">0.453</td>
<td style="text-align: right;">-0.049</td>
<td style="text-align: right;">0.478</td>
<td style="text-align: right;">0.463</td>
<td style="text-align: right;">0.493</td>
<td style="text-align: right;">0.477</td>
<td style="text-align: right;">0.470</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.044</td>
<td style="text-align: right;">0.735</td>
<td style="text-align: right;">0.309</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="results-1" class="level3">
<h3 class="anchored" data-anchor-id="results-1">4.2.1 Results</h3>
<p>(1) <strong>Moderate Buffers Perform Best:</strong></p>
<ul>
<li><strong>500 - 1000m</strong> buffer had the <strong>best AUC (0.582)</strong> and <strong>F1 (0.594)</strong>, indicating a good balance between ecological similarity and separation.</li>
</ul>
<p>(2) <strong>Too Close or Too Far Decreases Performance:</strong></p>
<ul>
<li><p><strong>Within 500m</strong>: Pseudo-absences too close to presences make it hard for the model to distinguish the two.</p></li>
<li><p><strong>Beyond 2000m</strong>: Pseudo-absences too far may not represent relevant environmental contrasts, leading to poor predictions.</p></li>
</ul>
<p>(3) <strong>Sensitivity vs.&nbsp;Specificity Trade-off:</strong></p>
<ul>
<li>As background points move farther away, <strong>Specificity</strong> tends to improve, but <strong>Sensitivity</strong> decreases, leading to a trade-off between detecting presences and absences.</li>
</ul>
<p>(4) <strong>Correlation Decreases With Distance:</strong></p>
<ul>
<li>The <strong>CORR</strong> metric peaks around <strong>500 - 1000m</strong> and then declines, even becoming negative beyond <strong>2000m</strong>, indicating the model struggles with very distant background points.</li>
</ul>
</section>
<section id="summary-2" class="level3">
<h3 class="anchored" data-anchor-id="summary-2">4.2.3 Summary</h3>
<p><strong>(1) Optimal Buffer Distance:</strong></p>
<ul>
<li>A <strong>moderate buffer</strong> (e.g., <strong>500 - 1000m</strong>) seems to strike the best balance for pseudo-absence sampling in this context.</li>
</ul>
<p>(2) <strong>Avoid Extremes:</strong></p>
<ul>
<li>Sampling <strong>too close</strong> or <strong>too far</strong> from presence points degrades model performance.</li>
</ul>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>5. Conclusion</h1>
<section id="comparison-across-all-models" class="level2">
<h2 class="anchored" data-anchor-id="comparison-across-all-models">5.1 Comparison across all models</h2>
<p>Let’s also compare the performance of all good models</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Combine three tables</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>combined_results_table <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results_including_true_absence_table_wt, results_table_no_wt_disk, results_table_wt_random)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Display the combined table with kable</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>combined_results_table <span class="sc">%&gt;%</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="st">"html"</span>, <span class="at">caption =</span> <span class="st">"Combined Model Evaluation Metrics"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">12</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="fu">ncol</span>(combined_results_table), <span class="at">bold =</span> <span class="cn">TRUE</span>)  <span class="co"># Highlight the Source column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Combined Model Evaluation Metrics</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AUC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AUPR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CORR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Accuracy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sensitivity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Specificity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Precision</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">F1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Best_Threshold</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Max_TSS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Best_Sensitivity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Best_Specificity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">split_90_train</td>
<td style="text-align: right;">0.679</td>
<td style="text-align: right;">0.678</td>
<td style="text-align: right;">0.281</td>
<td style="text-align: right;">0.607</td>
<td style="text-align: right;">0.779</td>
<td style="text-align: right;">0.434</td>
<td style="text-align: right;">0.579</td>
<td style="text-align: right;">0.664</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.295</td>
<td style="text-align: right; font-weight: bold;">0.557</td>
<td style="text-align: right;">0.738</td>
</tr>
<tr class="even">
<td style="text-align: left;">split_70_train</td>
<td style="text-align: right;">0.697</td>
<td style="text-align: right;">0.690</td>
<td style="text-align: right;">0.336</td>
<td style="text-align: right;">0.647</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.621</td>
<td style="text-align: right;">0.640</td>
<td style="text-align: right;">0.656</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.295</td>
<td style="text-align: right; font-weight: bold;">0.705</td>
<td style="text-align: right;">0.589</td>
</tr>
<tr class="odd">
<td style="text-align: left;">split_50_train</td>
<td style="text-align: right;">0.670</td>
<td style="text-align: right;">0.647</td>
<td style="text-align: right;">0.297</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.324</td>
<td style="text-align: right; font-weight: bold;">0.838</td>
<td style="text-align: right;">0.485</td>
</tr>
<tr class="even">
<td style="text-align: left;">disk_bg_500_env</td>
<td style="text-align: right;">0.536</td>
<td style="text-align: right;">0.541</td>
<td style="text-align: right;">0.083</td>
<td style="text-align: right;">0.529</td>
<td style="text-align: right;">0.471</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.533</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.059</td>
<td style="text-align: right; font-weight: bold;">0.471</td>
<td style="text-align: right;">0.588</td>
</tr>
<tr class="odd">
<td style="text-align: left;">disk_bg_500_1000_env</td>
<td style="text-align: right;">0.582</td>
<td style="text-align: right;">0.542</td>
<td style="text-align: right;">0.156</td>
<td style="text-align: right;">0.574</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">0.522</td>
<td style="text-align: right;">0.567</td>
<td style="text-align: right;">0.594</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.147</td>
<td style="text-align: right; font-weight: bold;">0.625</td>
<td style="text-align: right;">0.522</td>
</tr>
<tr class="even">
<td style="text-align: left;">disk_bg_1000_1500_env</td>
<td style="text-align: right;">0.560</td>
<td style="text-align: right;">0.526</td>
<td style="text-align: right;">0.096</td>
<td style="text-align: right;">0.540</td>
<td style="text-align: right;">0.471</td>
<td style="text-align: right;">0.610</td>
<td style="text-align: right;">0.547</td>
<td style="text-align: right;">0.506</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.088</td>
<td style="text-align: right; font-weight: bold;">0.801</td>
<td style="text-align: right;">0.287</td>
</tr>
<tr class="odd">
<td style="text-align: left;">disk_bg_1500_2000_env</td>
<td style="text-align: right;">0.542</td>
<td style="text-align: right;">0.495</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.507</td>
<td style="text-align: right;">0.471</td>
<td style="text-align: right;">0.544</td>
<td style="text-align: right;">0.508</td>
<td style="text-align: right;">0.489</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.184</td>
<td style="text-align: right; font-weight: bold;">0.838</td>
<td style="text-align: right;">0.346</td>
</tr>
<tr class="even">
<td style="text-align: left;">disk_bg_2000_env</td>
<td style="text-align: right;">0.538</td>
<td style="text-align: right;">0.453</td>
<td style="text-align: right;">-0.049</td>
<td style="text-align: right;">0.478</td>
<td style="text-align: right;">0.463</td>
<td style="text-align: right;">0.493</td>
<td style="text-align: right;">0.477</td>
<td style="text-align: right;">0.470</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.044</td>
<td style="text-align: right; font-weight: bold;">0.735</td>
<td style="text-align: right;">0.309</td>
</tr>
<tr class="odd">
<td style="text-align: left;">combined_random_bg_1to1_env</td>
<td style="text-align: right;">0.580</td>
<td style="text-align: right;">0.569</td>
<td style="text-align: right;">0.116</td>
<td style="text-align: right;">0.562</td>
<td style="text-align: right;">0.713</td>
<td style="text-align: right;">0.412</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right; font-weight: bold;">0.456</td>
<td style="text-align: right;">0.699</td>
</tr>
<tr class="even">
<td style="text-align: left;">combined_random_bg_5to1_env</td>
<td style="text-align: right;">0.580</td>
<td style="text-align: right;">0.569</td>
<td style="text-align: right;">0.116</td>
<td style="text-align: right;">0.562</td>
<td style="text-align: right;">0.713</td>
<td style="text-align: right;">0.412</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right; font-weight: bold;">0.456</td>
<td style="text-align: right;">0.699</td>
</tr>
<tr class="odd">
<td style="text-align: left;">combined_random_bg_10to1_env</td>
<td style="text-align: right;">0.580</td>
<td style="text-align: right;">0.569</td>
<td style="text-align: right;">0.116</td>
<td style="text-align: right;">0.562</td>
<td style="text-align: right;">0.713</td>
<td style="text-align: right;">0.412</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right; font-weight: bold;">0.456</td>
<td style="text-align: right;">0.699</td>
</tr>
<tr class="even">
<td style="text-align: left;">combined_random_bg_15to1_env</td>
<td style="text-align: right;">0.568</td>
<td style="text-align: right;">0.563</td>
<td style="text-align: right;">0.090</td>
<td style="text-align: right;">0.537</td>
<td style="text-align: right;">0.669</td>
<td style="text-align: right;">0.404</td>
<td style="text-align: right;">0.529</td>
<td style="text-align: right;">0.591</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.176</td>
<td style="text-align: right; font-weight: bold;">0.324</td>
<td style="text-align: right;">0.853</td>
</tr>
<tr class="odd">
<td style="text-align: left;">combined_random_bg_20to1_env</td>
<td style="text-align: right;">0.580</td>
<td style="text-align: right;">0.569</td>
<td style="text-align: right;">0.116</td>
<td style="text-align: right;">0.562</td>
<td style="text-align: right;">0.713</td>
<td style="text-align: right;">0.412</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right; font-weight: bold;">0.456</td>
<td style="text-align: right;">0.699</td>
</tr>
<tr class="even">
<td style="text-align: left;">combined_random_bg_30to1_env</td>
<td style="text-align: right;">0.580</td>
<td style="text-align: right;">0.569</td>
<td style="text-align: right;">0.116</td>
<td style="text-align: right;">0.562</td>
<td style="text-align: right;">0.713</td>
<td style="text-align: right;">0.412</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right; font-weight: bold;">0.456</td>
<td style="text-align: right;">0.699</td>
</tr>
<tr class="odd">
<td style="text-align: left;">combined_random_bg_50to1_env</td>
<td style="text-align: right;">0.571</td>
<td style="text-align: right;">0.559</td>
<td style="text-align: right;">0.097</td>
<td style="text-align: right;">0.533</td>
<td style="text-align: right;">0.662</td>
<td style="text-align: right;">0.404</td>
<td style="text-align: right;">0.526</td>
<td style="text-align: right;">0.586</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">0.162</td>
<td style="text-align: right; font-weight: bold;">0.331</td>
<td style="text-align: right;">0.831</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>(1) <strong>Best Overall Performance:</strong></p>
<ul>
<li><p><strong>Split Models</strong> show the highest <strong>AUC</strong> scores.</p></li>
<li><p><strong>split_70_train</strong> has the best AUC (<strong>0.697</strong>) and CORR (<strong>0.336</strong>), indicating strong predictive performance.</p></li>
<li><p><strong>split_90_train</strong> and <strong>split_50_train</strong> follow closely with AUCs of <strong>0.679</strong> and <strong>0.670</strong>, respectively.</p></li>
</ul>
<p>(2) <strong>Disk Strategy Performance:</strong></p>
<ul>
<li><p>Best AUC (<strong>0.582</strong>) achieved with <strong>500–1000m</strong> buffer.</p></li>
<li><p><strong>Closer buffers (500m)</strong> result in weaker performance (<strong>AUC = 0.536</strong>), likely due to environmental similarity between presence and background points.</p></li>
<li><p><strong>Farther buffers (&gt;2000m)</strong> degrade performance (<strong>AUC = 0.538</strong>) due to irrelevant background sampling.</p></li>
</ul>
<p>(3) <strong>Random Strategy Performance:</strong></p>
<ul>
<li><p>Stable <strong>AUC (~0.580)</strong> across most background-to-presence ratios (1:1 to 30:1).</p></li>
<li><p>Slight performance drop at <strong>50:1 ratio</strong> (<strong>AUC = 0.571</strong>) suggests diminishing returns from adding more background points.</p></li>
<li><p><strong>Sensitivity</strong> remains high (~0.713) across most ratios but at the expense of <strong>Specificity (~0.412)</strong>.</p></li>
</ul>
<p>(4) <strong>Best Trade-offs (Max_TSS):</strong></p>
<ul>
<li><p><strong>split_50_train</strong> shows the highest <strong>Max_TSS (0.324)</strong>, indicating the best balance between Sensitivity and Specificity.</p></li>
<li><p>In Random Strategy, <strong>15:1 ratio</strong> yields the highest <strong>Max_TSS (0.176)</strong>.</p></li>
</ul>
<p>(5) <strong>Key Insights:</strong></p>
<ul>
<li><p><strong>Split models</strong> outperform both Disk and Random background strategies in terms of AUC and overall predictive ability.</p></li>
<li><p><strong>Disk strategy</strong> performs best at moderate buffer distances (<strong>500–1000m</strong>), balancing environmental similarity and separation.</p></li>
<li><p><strong>Random strategy</strong> shows stable performance across most ratios, but excessive background points (50:1) can reduce effectiveness.5.2</p></li>
</ul>
</section>
<section id="summary-3" class="level2">
<h2 class="anchored" data-anchor-id="summary-3">5.2 Summary</h2>
<p>Addressing imbalanced species data is crucial for producing reliable and accurate Species Distribution Models. Through this study, we demonstrated how resampling methods, background point generation techniques, and weighting strategies can significantly impact model performance. Weighted models and carefully selected background points help to balance the influence of presence and absence data, reducing bias and improving metrics like sensitivity, specificity, and AUROC. The Gang-gang Cockatoo case study highlighted the practical implications of these approaches, showing that even simple weighting methods can enhance model outputs. Ultimately, integrating these techniques into ecological modeling workflows supports better conservation planning and decision-making, ensuring more robust and interpretable SDMs within platforms like EcoCommons.</p>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-barbet2012selecting" class="csl-entry" role="listitem">
Barbet-Massin, M., Jiguet, F., Albert, C., &amp; Thuiller, W. (2012). <em>Selecting pseudo-absences for species distribution models: How, where and how many? Methods ecol evol 3: 327–338</em>.
</div>
<div id="ref-benkendorf2023correcting" class="csl-entry" role="listitem">
Benkendorf, D. J., Schwartz, S. D., Cutler, D. R., &amp; Hawkins, C. P. (2023). Correcting for the effects of class imbalance improves the performance of machine-learning based species distribution models. <em>Ecological Modelling</em>, <em>483</em>, 110414.
</div>
<div id="ref-chawla2002smote" class="csl-entry" role="listitem">
Chawla, N. V., Bowyer, K. W., Hall, L. O., &amp; Kegelmeyer, W. P. (2002). SMOTE: Synthetic minority over-sampling technique. <em>Journal of Artificial Intelligence Research</em>, <em>16</em>, 321–357.
</div>
<div id="ref-chen2004using" class="csl-entry" role="listitem">
Chen, C., Liaw, A., Breiman, L., et al. (2004). Using random forest to learn imbalanced data. <em>University of California, Berkeley</em>, <em>110</em>(1-12), 24.
</div>
<div id="ref-elith2006novel" class="csl-entry" role="listitem">
Elith*, J., H. Graham*, C., P. Anderson, R., Dudı́k, M., Ferrier, S., Guisan, A., J. Hijmans, R., Huettmann, F., R. Leathwick, J., Lehmann, A., et al. (2006). Novel methods improve prediction of species’ distributions from occurrence data. <em>Ecography</em>, <em>29</em>(2), 129–151.
</div>
<div id="ref-gaul2022modelling" class="csl-entry" role="listitem">
Gaul, W., Sadykova, D., White, H. J., León-Sánchez, L., Caplat, P., Emmerson, M. C., &amp; Yearsley, J. M. (2022). Modelling the distribution of rare invertebrates by correcting class imbalance and spatial bias. <em>Diversity and Distributions</em>, <em>28</em>(10), 2171–2186.
</div>
<div id="ref-johnson2012species" class="csl-entry" role="listitem">
Johnson, R. A., Chawla, N. V., &amp; Hellmann, J. J. (2012). Species distribution modeling and prediction: A class imbalance problem. <em>2012 Conference on Intelligent Data Understanding</em>, 9–16.
</div>
<div id="ref-menardi2014training" class="csl-entry" role="listitem">
Menardi, G., &amp; Torelli, N. (2014). Training and assessing classification rules with imbalanced data. <em>Data Mining and Knowledge Discovery</em>, <em>28</em>, 92–122.
</div>
<div id="ref-phillips2006maximum" class="csl-entry" role="listitem">
Phillips, S. J., Anderson, R. P., &amp; Schapire, R. E. (2006). Maximum entropy modeling of species geographic distributions. <em>Ecological Modelling</em>, <em>190</em>(3-4), 231–259.
</div>
<div id="ref-vaclavik2009invasive" class="csl-entry" role="listitem">
Václavı́k, T., &amp; Meentemeyer, R. K. (2009). Invasive species distribution modeling (iSDM): Are absence data and dispersal constraints needed to predict actual distributions? <em>Ecological Modelling</em>, <em>220</em>(23), 3248–3258.
</div>
<div id="ref-valavi2022predictive" class="csl-entry" role="listitem">
Valavi, R., Guillera-Arroita, G., Lahoz-Monfort, J. J., &amp; Elith, J. (2022). Predictive performance of presence-only species distribution models: A benchmark study with reproducible code. <em>Ecological Monographs</em>, <em>92</em>(1), e01486.
</div>
<div id="ref-zhang2020does" class="csl-entry" role="listitem">
Zhang, Z., Mammola, S., &amp; Zhang, H. (2020). Does weighting presence records improve the performance of species distribution models? A test using fish larval stages in the yangtze estuary. <em>Science of The Total Environment</em>, <em>741</em>, 140393.
</div>
</div>
<p><img src="https://raw.githubusercontent.com/EcoCommons-Australia-2024-2026/ec-notebook_site/main/images/EC_section_break.png" class="img-fluid"></p>
<p>EcoCommons received investment (<a href="https://doi.org/10.3565/chbq-mr75" class="uri">https://doi.org/10.3565/chbq-mr75</a>) from the Australian Research Data Commons (ARDC). The ARDC is enabled by the National Collaborative Research Infrastructure Strategy (NCRIS).</p>
<div data-align="center">
<p><strong>Our partner</strong></p>
</div>
<p><img src="https://raw.githubusercontent.com/EcoCommons-Australia-2024-2026/ec-notebook_site/main/images/partners_logos.png" class="img-fluid"></p>


</section>

</main> <!-- /main -->



<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>footer</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="footer_files/libs/clipboard/clipboard.min.js"></script>
<script src="footer_files/libs/quarto-html/quarto.js"></script>
<script src="footer_files/libs/quarto-html/popper.min.js"></script>
<script src="footer_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="footer_files/libs/quarto-html/anchor.min.js"></script>
<link href="footer_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="footer_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="footer_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="footer_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="footer_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">






<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<div style="text-align: center;">
<p><img src="https://raw.githubusercontent.com/EcoCommons-Australia-2024-2026/ec-notebook_site_materials/main/images/EC_section_break.png" alt="Section Break" width="750"></p>
</div>
<div style="max-width: 1000px; margin: 45; text-align: center; padding: 10px;">
<p>
EcoCommons received investment (<a href="https://doi.org/10.3565/chbq-mr75">https://doi.org/10.3565/chbq-mr75</a>) from the Australian Research Data Commons (ARDC). The ARDC is enabled by the National Collaborative Research Infrastructure Strategy (NCRIS).
</p>
<div style="text-align: center;">
<h3 class="no-anchor" style="text-align: center;">
Our Partner
</h3>
</div>
<div style="text-align: center;">
<p><img src="https://raw.githubusercontent.com/EcoCommons-Australia-2024-2026/ec-notebook_site_materials/main/images/partners_logos.png" alt="Partners Logos" width="750"></p>
</div>
<h3 class="no-anchor" style="text-align: center;">
How to Cite EcoCommons
</h3>
<p style="text-align: center;">
</p><p>If you use EcoCommons in your research, please cite the platform as follows:</p>
<p></p>
<blockquote style="text-align: center;" class="blockquote">
<p>EcoCommons Australia 2024. <em>EcoCommons Australia – a collaborative commons for ecological and environmental modelling</em>, Queensland Cyber Infrastructure Foundation, Brisbane, Queensland. Available at: <a href="https://data–explorer.app.ecocommons.org.au/">https://data–explorer.app.ecocommons.org.au/</a> (Accessed: MM DD, YYYY). <a href="https://doi.org/10.3565/chbq-mr75">https://doi.org/10.3565/chbq-mr75</a></p>
</blockquote>
<p style="text-align: center;">
</p><p>You can download the citation file for EcoCommons Australia here: <a href="reference.bib">Download the BibTeX file</a></p>
<p></p>
<p style="text-align: center;">
</p><p>© 2024 EcoCommons. All rights reserved.</p>
<p></p>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->





<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>